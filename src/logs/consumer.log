2024-07-11 09:11:52,010 INFO Starting consumer...
2024-07-11 09:11:52,010 DEBUG Using selector: EpollSelector
2024-07-11 09:11:52,012 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:11:52,013 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:11:52,014 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:11:52,015 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 09:11:52,024 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:11:52,026 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:11:52,027 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f464e3a3cd0>
2024-07-11 09:11:52,029 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 09:11:52,031 DEBUG Received frame <Channel.OpenOk object at 0x7f464fc7f650> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f464e1dd7c0>
2024-07-11 09:11:52,032 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:11:52,033 DEBUG Received frame <Confirm.SelectOk object at 0x7f464e1e6390> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f464e1dd7c0>
2024-07-11 09:11:52,034 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:11:52,035 DEBUG Received frame <Basic.QosOk object at 0x7f464f80d290> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f464e1dd7c0>
2024-07-11 09:11:52,037 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:11:52,038 DEBUG Received frame <Basic.QosOk object at 0x7f464fdba5d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f464e1dd7c0>
2024-07-11 09:11:52,040 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:11:52,041 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:11:52,048 DEBUG Received frame <Queue.DeclareOk object at 0x7f464e1f4280> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f464e1dd7c0>
2024-07-11 09:11:52,049 INFO Consumer successfully started!
2024-07-11 09:11:52,050 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:11:52,051 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.ffdf685d34be438d898381d06c5c697d\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:11:52,052 DEBUG Received frame <Basic.ConsumeOk object at 0x7f464e1e6990> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f464e1dd7c0>
2024-07-11 09:11:57,029 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 09:13:09,361 INFO Starting consumer...
2024-07-11 09:13:09,362 DEBUG Using selector: EpollSelector
2024-07-11 09:13:09,363 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:13:09,363 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:13:09,364 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:13:09,365 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 09:13:09,374 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:13:09,375 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:13:09,376 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7ff7501cf1d0>
2024-07-11 09:13:09,377 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 09:13:09,378 DEBUG Received frame <Channel.OpenOk object at 0x7ff74f789f10> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff74eb11540>
2024-07-11 09:13:09,379 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:13:09,381 DEBUG Received frame <Confirm.SelectOk object at 0x7ff74eb19dd0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff74eb11540>
2024-07-11 09:13:09,382 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:13:09,383 DEBUG Received frame <Basic.QosOk object at 0x7ff74eb1a090> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff74eb11540>
2024-07-11 09:13:09,384 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:13:09,385 DEBUG Received frame <Basic.QosOk object at 0x7ff74eb1a310> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff74eb11540>
2024-07-11 09:13:09,387 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:13:09,388 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:13:09,395 DEBUG Received frame <Queue.DeclareOk object at 0x7ff74eb281e0> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff74eb11540>
2024-07-11 09:13:09,395 INFO Consumer successfully started!
2024-07-11 09:13:09,396 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:13:09,397 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.1c164e2c989b487cb648a0047e6cbb8e\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:13:09,399 DEBUG Received frame <Basic.ConsumeOk object at 0x7ff74eb1a950> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff74eb11540>
2024-07-11 09:13:14,381 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 09:13:39,269 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:13:39,394 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ff7500dfe90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff74eb11540>
2024-07-11 09:14:09,176 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:14:09,303 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ff75011f390> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff74eb11540>
2024-07-11 09:15:02,360 INFO Starting consumer...
2024-07-11 09:15:02,360 DEBUG Using selector: EpollSelector
2024-07-11 09:15:02,362 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:15:02,362 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:15:02,363 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:15:02,364 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 09:15:02,372 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:15:02,373 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:15:02,374 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f15660c9110>
2024-07-11 09:15:02,376 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 09:15:02,378 DEBUG Received frame <Channel.OpenOk object at 0x7f15676f2090> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f15660c1630>
2024-07-11 09:15:02,379 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:15:02,380 DEBUG Received frame <Confirm.SelectOk object at 0x7f1566d5a090> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f15660c1630>
2024-07-11 09:15:02,381 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:15:02,382 DEBUG Received frame <Basic.QosOk object at 0x7f15660c9f50> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f15660c1630>
2024-07-11 09:15:02,384 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:15:02,385 DEBUG Received frame <Basic.QosOk object at 0x7f15660c8f10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f15660c1630>
2024-07-11 09:15:02,386 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:15:02,387 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:15:02,392 DEBUG Received frame <Queue.DeclareOk object at 0x7f15660d8d70> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f15660c1630>
2024-07-11 09:15:02,393 INFO Consumer successfully started!
2024-07-11 09:15:02,394 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:15:02,395 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.9b4a52f03722496cb04a5658d0ef4308\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:15:02,397 DEBUG Received frame <Basic.ConsumeOk object at 0x7f15660ca990> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f15660c1630>
2024-07-11 09:15:07,379 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 09:15:32,232 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:15:32,346 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f1566287d90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f15660c1630>
2024-07-11 09:16:30,233 INFO Starting consumer...
2024-07-11 09:16:30,233 DEBUG Using selector: EpollSelector
2024-07-11 09:16:30,235 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:16:30,235 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:16:30,236 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:16:30,237 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 09:16:30,245 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:16:30,246 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:16:30,247 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f27d7d9ed90>
2024-07-11 09:16:30,250 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 09:16:30,253 DEBUG Received frame <Channel.OpenOk object at 0x7f27d6799450> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f27d6791360>
2024-07-11 09:16:30,254 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:16:30,256 DEBUG Received frame <Confirm.SelectOk object at 0x7f27d7d13c10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f27d6791360>
2024-07-11 09:16:30,257 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:16:30,258 DEBUG Received frame <Basic.QosOk object at 0x7f27d7eaf210> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f27d6791360>
2024-07-11 09:16:30,259 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:16:30,260 DEBUG Received frame <Basic.QosOk object at 0x7f27d679a810> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f27d6791360>
2024-07-11 09:16:30,261 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:16:30,262 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:16:30,270 DEBUG Received frame <Queue.DeclareOk object at 0x7f27d67a8af0> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f27d6791360>
2024-07-11 09:16:30,271 INFO Consumer successfully started!
2024-07-11 09:16:30,272 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:16:30,273 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.dcc89ca55225497a98ff21109ca885c7\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:16:30,275 DEBUG Received frame <Basic.ConsumeOk object at 0x7f27d679af50> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f27d6791360>
2024-07-11 09:16:35,252 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 09:17:00,135 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:17:00,414 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f27d82332d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f27d6791360>
2024-07-11 09:17:30,017 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:17:30,521 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f27d7d477d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f27d6791360>
2024-07-11 09:17:59,918 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:18:00,537 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f27d82332d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f27d6791360>
2024-07-11 09:19:03,977 INFO Starting consumer...
2024-07-11 09:19:03,978 DEBUG Using selector: EpollSelector
2024-07-11 09:19:03,979 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:19:03,980 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:19:03,981 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:19:03,982 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 09:19:03,992 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:19:03,993 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:19:03,994 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f687b429d90>
2024-07-11 09:19:03,995 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 09:19:03,998 DEBUG Received frame <Channel.OpenOk object at 0x7f6879e016d0> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f6879df97c0>
2024-07-11 09:19:03,999 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:19:04,001 DEBUG Received frame <Confirm.SelectOk object at 0x7f6879e025d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f6879df97c0>
2024-07-11 09:19:04,003 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:19:04,005 DEBUG Received frame <Basic.QosOk object at 0x7f6879e02610> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f6879df97c0>
2024-07-11 09:19:04,006 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:19:04,008 DEBUG Received frame <Basic.QosOk object at 0x7f6879e02550> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f6879df97c0>
2024-07-11 09:19:04,009 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:19:04,009 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:19:04,017 DEBUG Received frame <Queue.DeclareOk object at 0x7f6879e10d70> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f6879df97c0>
2024-07-11 09:19:04,018 INFO Consumer successfully started!
2024-07-11 09:19:04,019 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:19:04,020 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.708519df006d466c815dc53c8f3f72b8\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:19:04,022 DEBUG Received frame <Basic.ConsumeOk object at 0x7f6879e03190> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f6879df97c0>
2024-07-11 09:19:08,999 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 09:19:33,899 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:19:34,015 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f687b9eb3d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f6879df97c0>
2024-07-11 09:21:13,484 INFO Starting consumer...
2024-07-11 09:21:13,485 DEBUG Using selector: EpollSelector
2024-07-11 09:21:13,486 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:21:13,487 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:21:13,487 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:21:13,488 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 09:21:13,496 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:21:13,498 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:21:13,498 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f9f5b8ced90>
2024-07-11 09:21:13,500 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 09:21:13,502 DEBUG Received frame <Channel.OpenOk object at 0x7f9f5a2c9690> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:21:13,503 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:21:13,504 DEBUG Received frame <Confirm.SelectOk object at 0x7f9f5b842950> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:21:13,506 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:21:13,508 DEBUG Received frame <Basic.QosOk object at 0x7f9f5a2ca590> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:21:13,510 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:21:13,511 DEBUG Received frame <Basic.QosOk object at 0x7f9f5a2caa90> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:21:13,513 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:21:13,515 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:21:13,522 DEBUG Received frame <Queue.DeclareOk object at 0x7f9f5a2d8b40> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:21:13,523 INFO Consumer successfully started!
2024-07-11 09:21:13,524 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:21:13,525 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.d7460faa78ca4dd998465dd6941e4b0d\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:21:13,527 DEBUG Received frame <Basic.ConsumeOk object at 0x7f9f5a2cb150> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:21:18,504 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 09:21:43,391 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:21:43,517 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f9f5a483810> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:13,275 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:22:13,531 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f9f5b8777d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:17,748 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a3f6510> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:17,750 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5a483d50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:17,754 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2cb2d0> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:17,756 INFO Message received
2024-07-11 09:22:17,756 INFO {'file_name': '1-001.dcm'}
2024-07-11 09:22:17,760 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection pool created", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:17,763 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:17,767 DEBUG {"message": "Waiting for suitable server to become available", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "remainingTimeMS": 29}
2024-07-11 09:22:17,771 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:17,777 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:17,779 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:17,780 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:17,789 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0013952709996374324}
2024-07-11 09:22:17,790 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.01058028099942021}
2024-07-11 09:22:17,791 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4495c8179259410a124\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:17,798 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 7.8069999999999995, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:17,800 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:17,804 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:17,805 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:17,807 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:17,810 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.003156655999191571}
2024-07-11 09:22:17,811 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4495c8179259410a124\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:17,813 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 2.062, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4495c8179259410a124\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:17,814 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:17,819 INFO Not recognized task type
2024-07-11 09:22:17,820 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:18,343 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2af9b0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:18,344 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5a2cb5d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:18,345 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2cac10> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:18,347 INFO Message received
2024-07-11 09:22:18,348 INFO {'file_name': '1-002.dcm'}
2024-07-11 09:22:18,351 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:18,353 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,354 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,355 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00095436900119239}
2024-07-11 09:22:18,357 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44a5c8179259410a125\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,358 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 1.9269999999999998, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,360 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:18,362 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:18,363 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,368 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,370 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0019208140001865104}
2024-07-11 09:22:18,371 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44a5c8179259410a125\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,373 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 1.96, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44a5c8179259410a125\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,374 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:18,376 INFO Not recognized task type
2024-07-11 09:22:18,378 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:18,848 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2afb30> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:18,849 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5a2c9bd0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:18,850 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2cb410> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:18,858 INFO Message received
2024-07-11 09:22:18,858 INFO {'file_name': '1-003.dcm'}
2024-07-11 09:22:18,861 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:18,864 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,865 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,866 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001237919001141563}
2024-07-11 09:22:18,876 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44a5c8179259410a126\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,879 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 2.5660000000000003, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,882 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:18,885 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:18,886 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,887 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,888 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008014300001377705}
2024-07-11 09:22:18,891 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44a5c8179259410a126\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,893 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 2.577, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44a5c8179259410a126\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:18,894 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:18,898 INFO Not recognized task type
2024-07-11 09:22:18,901 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:19,303 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2afbf0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:19,304 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5b14e510> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:19,305 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2cbc10> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:19,307 INFO Message received
2024-07-11 09:22:19,307 INFO {'file_name': '1-004.dcm'}
2024-07-11 09:22:19,308 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:19,310 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,311 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,312 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001324138000200037}
2024-07-11 09:22:19,315 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44b5c8179259410a127\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,320 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 4.513999999999999, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,322 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:19,324 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:19,325 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,326 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,327 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007727769989287481}
2024-07-11 09:22:19,328 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44b5c8179259410a127\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,336 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 8.097, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44b5c8179259410a127\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,337 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:19,340 INFO Not recognized task type
2024-07-11 09:22:19,342 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:19,757 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2afa70> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:19,759 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5a483d10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:19,760 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2cbcd0> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:19,762 INFO Message received
2024-07-11 09:22:19,762 INFO {'file_name': '1-005.dcm'}
2024-07-11 09:22:19,764 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:19,767 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,768 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,769 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0009806929992919322}
2024-07-11 09:22:19,772 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44b5c8179259410a128\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,777 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 5.948, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,779 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:19,782 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:19,784 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,786 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,791 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.004951686998538207}
2024-07-11 09:22:19,793 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44b5c8179259410a128\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,797 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 3.901, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44b5c8179259410a128\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:19,801 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:19,803 INFO Not recognized task type
2024-07-11 09:22:19,804 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:20,238 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2afd70> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:20,240 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5a2c92d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:20,241 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2e2350> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:20,244 INFO Message received
2024-07-11 09:22:20,247 INFO {'file_name': '1-006.dcm'}
2024-07-11 09:22:20,249 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:20,250 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,251 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,254 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0022530360001837835}
2024-07-11 09:22:20,256 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44c5c8179259410a129\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,263 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 7.0169999999999995, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,265 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:20,271 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:20,280 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,282 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,285 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0024444620012218365}
2024-07-11 09:22:20,287 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44c5c8179259410a129\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,296 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 9.25, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44c5c8179259410a129\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,298 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:20,300 INFO Not recognized task type
2024-07-11 09:22:20,301 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:20,740 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2afe30> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:20,742 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5b9dfd10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:20,745 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2e2050> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:20,748 INFO Message received
2024-07-11 09:22:20,753 INFO {'file_name': '1-007.dcm'}
2024-07-11 09:22:20,756 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:20,757 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,759 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,762 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.003304912999738008}
2024-07-11 09:22:20,764 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44c5c8179259410a12a\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,767 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 3.139, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,772 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:20,774 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:20,777 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,780 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,782 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001897299000120256}
2024-07-11 09:22:20,788 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44c5c8179259410a12a\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,791 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 3.408, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44c5c8179259410a12a\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:20,792 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:20,794 INFO Not recognized task type
2024-07-11 09:22:20,796 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:21,219 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2afef0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:21,220 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5b8be250> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:21,223 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2e2710> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:21,224 INFO Message received
2024-07-11 09:22:21,228 INFO {'file_name': '1-008.dcm'}
2024-07-11 09:22:21,230 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:21,232 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,233 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,236 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0029900949994043913}
2024-07-11 09:22:21,238 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44d5c8179259410a12b\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,242 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 4.054, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,244 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:21,247 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:21,250 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,253 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,254 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0018034120002994314}
2024-07-11 09:22:21,266 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44d5c8179259410a12b\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,283 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 17.805999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44d5c8179259410a12b\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,284 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:21,287 INFO Not recognized task type
2024-07-11 09:22:21,288 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:21,711 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2affb0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:21,712 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5a2ca590> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:21,714 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2e2650> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:21,716 INFO Message received
2024-07-11 09:22:21,719 INFO {'file_name': '1-009.dcm'}
2024-07-11 09:22:21,721 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:21,724 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,727 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,728 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0012876439996034605}
2024-07-11 09:22:21,731 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44d5c8179259410a12c\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,735 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 4.008, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,737 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:21,739 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:21,740 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,742 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,743 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011074349986301968}
2024-07-11 09:22:21,746 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44d5c8179259410a12c\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,748 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 2.315, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44d5c8179259410a12c\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:21,751 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:21,752 INFO Not recognized task type
2024-07-11 09:22:21,754 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:22,397 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2aff50> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:22,398 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5a2e2750> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:22,400 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2e2650> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:22,402 INFO Message received
2024-07-11 09:22:22,404 INFO {'file_name': '1-010.dcm'}
2024-07-11 09:22:22,407 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:22,410 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,412 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,413 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0015760860005684663}
2024-07-11 09:22:22,416 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44e5c8179259410a12d\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,419 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 2.8800000000000003, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,420 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:22,423 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:22,427 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,429 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,431 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0014126820005913032}
2024-07-11 09:22:22,432 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44e5c8179259410a12d\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,435 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 2.376, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44e5c8179259410a12d\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,437 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:22,439 INFO Not recognized task type
2024-07-11 09:22:22,443 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:22,928 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2afad0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:22,930 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5a2e2ad0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:22,931 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2e2650> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:22,934 INFO Message received
2024-07-11 09:22:22,935 INFO {'file_name': '1-011.dcm'}
2024-07-11 09:22:22,937 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:22,938 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,941 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,945 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.003999638000095729}
2024-07-11 09:22:22,948 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44e5c8179259410a12e\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,950 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 2.005, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,951 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:22,953 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:22,954 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,956 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,957 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0015657330004614778}
2024-07-11 09:22:22,959 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44e5c8179259410a12e\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,963 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 4.085, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44e5c8179259410a12e\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:22,971 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:22,977 INFO Not recognized task type
2024-07-11 09:22:22,982 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:23,414 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2e8230> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:23,416 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5a2e2d10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:23,418 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2e2650> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:23,421 INFO Message received
2024-07-11 09:22:23,425 INFO {'file_name': '1-012.dcm'}
2024-07-11 09:22:23,429 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:23,432 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,433 DEBUG Received frame <Basic.Deliver object at 0x7f9f5a2e8050> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:23,435 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,439 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9f5a2e2690> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:23,443 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.007680339000216918}
2024-07-11 09:22:23,445 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f9f5a2e2650> in channel #1 weight=41 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:22:23,450 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44f5c8179259410a12f\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,454 INFO Message received
2024-07-11 09:22:23,462 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 12.209, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,466 INFO {'message': 'Transfer completed'}
2024-07-11 09:22:23,468 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:23,471 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:23,474 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f9f5afd1260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,474 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:23,477 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,479 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,482 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.004336470999987796}
2024-07-11 09:22:23,484 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,489 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa44f5c8179259410a130\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,490 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-11 09:22:23,497 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 8.272, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,502 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0013332840007933555}
2024-07-11 09:22:23,504 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:23,511 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.027041276000090875}
2024-07-11 09:22:23,516 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}}
2024-07-11 09:22:23,516 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44f5c8179259410a12f\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 468703135, "operationId": 468703135, "driverConnectionId": 2, "serverConnectionId": 6, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,518 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4095c8179259410a123, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0018751050010905601>]>", "clientId": {"$oid": "668fa4095c8179259410a123"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,522 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 5.3020000000000005, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44f5c8179259410a12f\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 468703135, "operationId": 468703135, "driverConnectionId": 2, "serverConnectionId": 6, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,524 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,529 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-11 09:22:23,530 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.006864472999950522}
2024-07-11 09:22:23,532 INFO Not recognized task type
2024-07-11 09:22:23,534 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa44f5c8179259410a130\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"+4NVlrL1TAqx23kwAgOzUQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1101513929, "operationId": 1101513929, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,536 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:23,541 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Command succeeded", "durationMS": 6.79, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa44f5c8179259410a130\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1101513929, "operationId": 1101513929, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:22:23,543 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:22:23,547 INFO Not recognized task type
2024-07-11 09:22:23,549 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\r\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:22:43,166 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:23:10,382 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:23:10,386 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "reason": "Connection pool was stale", "error": "stale"}
2024-07-11 09:23:10,388 DEBUG {"clientId": {"$oid": "668fa4095c8179259410a123"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "reason": "Connection pool was stale", "error": "stale"}
2024-07-11 09:23:13,083 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:23:13,559 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f9f5a44d650> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f9f5a2c13b0>
2024-07-11 09:24:01,479 INFO Starting consumer...
2024-07-11 09:24:01,479 DEBUG Using selector: EpollSelector
2024-07-11 09:24:01,481 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:24:01,481 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:24:01,482 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:24:01,483 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 09:24:01,492 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:24:01,493 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:24:01,494 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f5c5961f690>
2024-07-11 09:24:01,495 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 09:24:01,498 DEBUG Received frame <Channel.OpenOk object at 0x7f5c59454a10> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:01,499 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:24:01,501 DEBUG Received frame <Confirm.SelectOk object at 0x7f5c594551d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:01,503 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:24:01,504 DEBUG Received frame <Basic.QosOk object at 0x7f5c5a9f3390> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:01,506 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:24:01,508 DEBUG Received frame <Basic.QosOk object at 0x7f5c596693d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:01,509 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:24:01,510 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:24:01,517 DEBUG Received frame <Queue.DeclareOk object at 0x7f5c59464050> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:01,518 INFO Consumer successfully started!
2024-07-11 09:24:01,518 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:24:01,519 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.57294cc6d3214902a04b3e701ae4e63e\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:24:01,520 DEBUG Received frame <Basic.ConsumeOk object at 0x7f5c594564d0> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:06,498 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 09:24:21,093 DEBUG Received frame <Basic.Deliver object at 0x7f5c5957e510> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:21,095 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c59456450> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:21,097 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c59456750> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:21,100 INFO Message received
2024-07-11 09:24:21,100 INFO {'file_name': '1-001.dcm'}
2024-07-11 09:24:21,107 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection pool created", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:21,117 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:21,119 DEBUG {"message": "Waiting for suitable server to become available", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "remainingTimeMS": 29}
2024-07-11 09:24:21,123 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:21,125 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:21,130 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:21,133 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:21,145 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0028219390005688183}
2024-07-11 09:24:21,147 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.016585454000960453}
2024-07-11 09:24:21,148 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4c56a1aaee3a7501ffd\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:21,155 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 6.394, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:21,157 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:21,160 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:21,165 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:21,167 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:21,168 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0013896000000386266}
2024-07-11 09:24:21,170 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4c56a1aaee3a7501ffd\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:21,175 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 5.348000000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4c56a1aaee3a7501ffd\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:21,177 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:21,178 INFO Not recognized task type
2024-07-11 09:24:21,179 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:22,088 DEBUG Received frame <Basic.Deliver object at 0x7f5c5943b950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:22,090 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c5aa84690> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:22,092 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c59456850> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:22,094 INFO Message received
2024-07-11 09:24:22,095 INFO {'file_name': '1-002.dcm'}
2024-07-11 09:24:22,099 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:22,101 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,103 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,104 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011777239997172728}
2024-07-11 09:24:22,105 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4c66a1aaee3a7501ffe\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,109 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 3.771, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,112 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:22,114 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:22,115 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,118 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,119 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0014894349988026079}
2024-07-11 09:24:22,120 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4c66a1aaee3a7501ffe\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,122 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.322, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4c66a1aaee3a7501ffe\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,123 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:22,125 INFO Not recognized task type
2024-07-11 09:24:22,128 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:22,942 DEBUG Received frame <Basic.Deliver object at 0x7f5c5943bb30> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:22,943 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c5961ead0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:22,945 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c59456610> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:22,946 INFO Message received
2024-07-11 09:24:22,947 INFO {'file_name': '1-003.dcm'}
2024-07-11 09:24:22,949 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:22,951 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,953 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,954 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0010093330001836875}
2024-07-11 09:24:22,955 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4c66a1aaee3a7501fff\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,958 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 3.1519999999999997, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,959 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:22,962 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:22,963 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,964 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,966 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0014123959990683943}
2024-07-11 09:24:22,967 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4c66a1aaee3a7501fff\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,970 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.412, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4c66a1aaee3a7501fff\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:22,971 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:22,972 INFO Not recognized task type
2024-07-11 09:24:22,974 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:23,657 DEBUG Received frame <Basic.Deliver object at 0x7f5c5943bbf0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:23,659 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c594564d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:23,660 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c5961ead0> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:23,662 INFO Message received
2024-07-11 09:24:23,663 INFO {'file_name': '1-004.dcm'}
2024-07-11 09:24:23,664 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:23,665 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:23,668 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:23,669 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0014601980001316406}
2024-07-11 09:24:23,671 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4c76a1aaee3a7502000\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:23,673 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.261, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:23,674 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:23,677 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:23,678 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:23,679 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:23,680 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007713680006418144}
2024-07-11 09:24:23,681 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4c76a1aaee3a7502000\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:23,683 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.463, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4c76a1aaee3a7502000\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:23,685 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:23,687 INFO Not recognized task type
2024-07-11 09:24:23,688 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:24,283 DEBUG Received frame <Basic.Deliver object at 0x7f5c5943ba70> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:24,284 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c5aa1bf50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:24,286 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c594564d0> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:24,287 INFO Message received
2024-07-11 09:24:24,288 INFO {'file_name': '1-005.dcm'}
2024-07-11 09:24:24,290 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:24,291 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,294 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,295 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0010320599994884105}
2024-07-11 09:24:24,296 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4c86a1aaee3a7502001\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,298 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.232, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,300 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:24,301 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:24,302 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,303 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,304 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008587299998907838}
2024-07-11 09:24:24,306 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4c86a1aaee3a7502001\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,308 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.069, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4c86a1aaee3a7502001\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,309 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:24,311 INFO Not recognized task type
2024-07-11 09:24:24,313 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:24,849 DEBUG Received frame <Basic.Deliver object at 0x7f5c5943bd70> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:24,850 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c59456a10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:24,851 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c59471690> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:24,853 INFO Message received
2024-07-11 09:24:24,854 INFO {'file_name': '1-006.dcm'}
2024-07-11 09:24:24,855 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:24,856 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,857 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,858 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0010351069995522266}
2024-07-11 09:24:24,860 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4c86a1aaee3a7502002\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,862 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 1.98, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,862 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:24,865 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:24,867 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,871 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,873 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0018754579996311804}
2024-07-11 09:24:24,875 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4c86a1aaee3a7502002\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,878 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 3.284, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4c86a1aaee3a7502002\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:24,879 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:24,884 INFO Not recognized task type
2024-07-11 09:24:24,886 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:25,477 DEBUG Received frame <Basic.Deliver object at 0x7f5c5943be30> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:25,481 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c59471510> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:25,482 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c59471590> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:25,485 INFO Message received
2024-07-11 09:24:25,487 INFO {'file_name': '1-007.dcm'}
2024-07-11 09:24:25,490 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:25,492 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,494 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,496 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0019904109994968167}
2024-07-11 09:24:25,499 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4c96a1aaee3a7502003\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,501 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 1.965, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,501 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:25,503 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:25,505 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,507 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,509 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0015204060000542086}
2024-07-11 09:24:25,510 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4c96a1aaee3a7502003\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,514 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 4.2059999999999995, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4c96a1aaee3a7502003\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,516 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:25,517 INFO Not recognized task type
2024-07-11 09:24:25,519 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:25,922 DEBUG Received frame <Basic.Deliver object at 0x7f5c5943bef0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:25,924 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c59471950> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:25,925 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c59471510> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:25,928 INFO Message received
2024-07-11 09:24:25,929 INFO {'file_name': '1-008.dcm'}
2024-07-11 09:24:25,931 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:25,932 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,933 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,934 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007278439989022445}
2024-07-11 09:24:25,935 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4c96a1aaee3a7502004\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,937 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 1.675, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,937 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:25,940 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:25,943 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,946 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,949 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.003797215000304277}
2024-07-11 09:24:25,951 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4c96a1aaee3a7502004\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,953 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.2079999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4c96a1aaee3a7502004\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:25,954 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:25,956 INFO Not recognized task type
2024-07-11 09:24:25,957 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:26,555 DEBUG Received frame <Basic.Deliver object at 0x7f5c5943bfb0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:26,558 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c5aa59b50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:26,559 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c59471b90> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:26,561 INFO Message received
2024-07-11 09:24:26,562 INFO {'file_name': '1-009.dcm'}
2024-07-11 09:24:26,563 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:26,564 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:26,565 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:26,568 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0022867269999551354}
2024-07-11 09:24:26,569 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4ca6a1aaee3a7502005\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:26,571 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.31, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:26,574 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:26,577 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:26,578 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:26,580 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:26,581 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011787439998443006}
2024-07-11 09:24:26,583 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4ca6a1aaee3a7502005\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:26,585 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.496, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4ca6a1aaee3a7502005\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:26,589 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:26,593 INFO Not recognized task type
2024-07-11 09:24:26,599 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:27,073 DEBUG Received frame <Basic.Deliver object at 0x7f5c5943bf50> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,073 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c59471ad0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,074 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c59470090> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,076 INFO Message received
2024-07-11 09:24:27,078 INFO {'file_name': '1-010.dcm'}
2024-07-11 09:24:27,080 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:27,082 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,083 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,083 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007208909992186818}
2024-07-11 09:24:27,084 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4cb6a1aaee3a7502006\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,088 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 3.4099999999999997, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,091 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:27,092 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:27,094 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,095 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,096 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0009950049989129184}
2024-07-11 09:24:27,097 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4cb6a1aaee3a7502006\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,099 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 1.573, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4cb6a1aaee3a7502006\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,100 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:27,101 INFO Not recognized task type
2024-07-11 09:24:27,102 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:27,526 DEBUG Received frame <Basic.Deliver object at 0x7f5c5943bad0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,527 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c59455f50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,528 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c59471e50> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,530 INFO Message received
2024-07-11 09:24:27,531 INFO {'file_name': '1-011.dcm'}
2024-07-11 09:24:27,532 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:27,534 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,535 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,539 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.003784488000746933}
2024-07-11 09:24:27,541 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4cb6a1aaee3a7502007\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,548 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 7.225, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,549 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:27,554 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:27,557 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,559 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,561 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0015713310003775405}
2024-07-11 09:24:27,564 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4cb6a1aaee3a7502007\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,568 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 4.285, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4cb6a1aaee3a7502007\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,569 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:27,570 INFO Not recognized task type
2024-07-11 09:24:27,572 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:27,984 DEBUG Received frame <Basic.Deliver object at 0x7f5c59474230> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,985 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c59471f10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,986 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c59471890> in channel #1 weight=34 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,988 INFO Message received
2024-07-11 09:24:27,989 INFO {'file_name': '1-012.dcm'}
2024-07-11 09:24:27,990 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:27,991 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,992 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,993 DEBUG Received frame <Basic.Deliver object at 0x7f5c59474050> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,993 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011289129997749114}
2024-07-11 09:24:27,994 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f5c59472290> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:27,996 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4cb6a1aaee3a7502008\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:27,996 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f5c5aa84610> in channel #1 weight=41 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:24:28,000 INFO Message received
2024-07-11 09:24:28,000 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 4.634, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,001 INFO {'message': 'Transfer completed'}
2024-07-11 09:24:28,002 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:28,004 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:28,009 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f5c5a159260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,009 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:28,010 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,015 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,016 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.005839408999236184}
2024-07-11 09:24:28,018 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,019 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa4cc6a1aaee3a7502009\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,020 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-11 09:24:28,021 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.332, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,022 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:28,023 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0012092769993614638}
2024-07-11 09:24:28,026 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}}
2024-07-11 09:24:28,027 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.008872545000485843}
2024-07-11 09:24:28,028 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa4b16a1aaee3a7501ffc, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.005090114000267931>]>", "clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,031 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4cb6a1aaee3a7502008\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"Wo1kXT2bQ2OEJFPo4cVBNg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 468703135, "operationId": 468703135, "driverConnectionId": 2, "serverConnectionId": 6, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,032 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,034 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 3.376, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4cb6a1aaee3a7502008\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 468703135, "operationId": 468703135, "driverConnectionId": 2, "serverConnectionId": 6, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,035 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00278901800083986}
2024-07-11 09:24:28,036 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-11 09:24:28,037 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa4cc6a1aaee3a7502009\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"jSnfT3IGRXGYn9P2G4neww==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1101513929, "operationId": 1101513929, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,038 INFO Not recognized task type
2024-07-11 09:24:28,040 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Command succeeded", "durationMS": 2.955, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa4cc6a1aaee3a7502009\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1101513929, "operationId": 1101513929, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:24:28,041 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:28,043 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:24:28,046 INFO Not recognized task type
2024-07-11 09:24:28,048 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\r\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:24:31,355 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:24:31,567 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c5aa49710> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:25:01,237 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:25:01,588 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c596c4310> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:25:31,146 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:25:31,534 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c5954c4d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:26:01,009 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:26:01,490 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c59470e50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:26:30,911 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:26:31,529 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c59470250> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:27:00,808 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:27:01,525 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c59472ad0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:27:30,668 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:27:31,489 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c594720d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:28:00,534 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:28:01,510 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c594710d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:28:30,429 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:28:31,591 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c59472ad0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:29:00,321 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:29:01,526 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c59471c50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:29:30,204 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:29:31,518 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c59472d90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:30:00,090 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:30:01,521 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c59470510> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:30:29,980 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:30:31,600 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c594735d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:30:59,860 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:31:01,524 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c594720d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:31:27,860 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:31:27,862 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "reason": "Connection pool was stale", "error": "stale"}
2024-07-11 09:31:27,863 DEBUG {"clientId": {"$oid": "668fa4b16a1aaee3a7501ffc"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "reason": "Connection pool was stale", "error": "stale"}
2024-07-11 09:31:29,744 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:31:31,599 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f5c59457e10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f5c5944d4f0>
2024-07-11 09:32:11,275 INFO Starting consumer...
2024-07-11 09:32:11,275 DEBUG Using selector: EpollSelector
2024-07-11 09:32:11,276 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:32:11,277 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:32:11,278 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:32:11,279 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 09:32:11,287 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:32:11,288 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:32:11,289 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7fe82fa40110>
2024-07-11 09:32:11,290 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 09:32:11,292 DEBUG Received frame <Channel.OpenOk object at 0x7fe8310d09d0> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:11,293 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:32:11,295 DEBUG Received frame <Confirm.SelectOk object at 0x7fe82fa420d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:11,296 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:32:11,298 DEBUG Received frame <Basic.QosOk object at 0x7fe82fa42110> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:11,299 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:32:11,301 DEBUG Received frame <Basic.QosOk object at 0x7fe82fa42410> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:11,303 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:32:11,305 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:32:11,311 DEBUG Received frame <Queue.DeclareOk object at 0x7fe82fa50d70> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:11,313 INFO Consumer successfully started!
2024-07-11 09:32:11,313 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:32:11,314 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.2b9ce3f187264e5992235806e12835da\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:32:11,317 DEBUG Received frame <Basic.ConsumeOk object at 0x7fe82fa42c90> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:16,295 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 09:32:25,072 DEBUG Received frame <Basic.Deliver object at 0x7fe82fb6a4b0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:25,075 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe82fa426d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:25,076 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe82fa42c10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:25,078 INFO Message received
2024-07-11 09:32:25,079 INFO {'type': 'file_dowloaded', 'file_name': '1-001.dcm'}
2024-07-11 09:32:25,081 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection pool created", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,083 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:25,085 DEBUG {"message": "Waiting for suitable server to become available", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "remainingTimeMS": 29}
2024-07-11 09:32:25,088 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,089 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,092 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,094 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:25,098 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0013223310015746392}
2024-07-11 09:32:25,099 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.006708703998810961}
2024-07-11 09:32:25,100 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6a9d5c94ac31f8d5b66\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,106 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 6.204000000000001, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,107 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:25,113 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:25,114 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,116 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,117 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011254090004513273}
2024-07-11 09:32:25,118 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6a9d5c94ac31f8d5b66\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,120 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.431, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6a9d5c94ac31f8d5b66\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,122 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:25,124 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:25,512 DEBUG Received frame <Basic.Deliver object at 0x7fe82fb6a270> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:25,513 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe830fe3a50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:25,514 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe831460210> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:25,515 INFO Message received
2024-07-11 09:32:25,516 INFO {'type': 'file_dowloaded', 'file_name': '1-002.dcm'}
2024-07-11 09:32:25,517 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:25,518 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,519 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,520 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008122429990180535}
2024-07-11 09:32:25,521 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6a9d5c94ac31f8d5b67\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,523 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.005, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,524 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:25,526 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:25,527 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,528 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,529 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008186739996745018}
2024-07-11 09:32:25,530 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6a9d5c94ac31f8d5b67\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,533 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.642, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6a9d5c94ac31f8d5b67\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,535 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:25,538 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:25,888 DEBUG Received frame <Basic.Deliver object at 0x7fe82fb6a4b0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:25,890 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe82fa42b10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:25,891 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe831460210> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:25,894 INFO Message received
2024-07-11 09:32:25,895 INFO {'type': 'file_dowloaded', 'file_name': '1-003.dcm'}
2024-07-11 09:32:25,897 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:25,901 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,903 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,905 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0013468859997374238}
2024-07-11 09:32:25,906 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6a9d5c94ac31f8d5b68\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,908 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.1229999999999998, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,911 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:25,913 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:25,914 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,917 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,918 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0013034280000283616}
2024-07-11 09:32:25,919 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6a9d5c94ac31f8d5b68\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,922 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 3.392, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6a9d5c94ac31f8d5b68\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:25,925 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:25,926 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:26,275 DEBUG Received frame <Basic.Deliver object at 0x7fe82fa27c50> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:26,276 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe82fa43150> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:26,278 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe831460210> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:26,280 INFO Message received
2024-07-11 09:32:26,280 INFO {'type': 'file_dowloaded', 'file_name': '1-004.dcm'}
2024-07-11 09:32:26,281 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:26,283 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,284 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,285 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0012500060001912061}
2024-07-11 09:32:26,287 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6aad5c94ac31f8d5b69\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,292 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 4.909, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,293 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:26,295 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:26,296 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,297 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,298 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0006405809999705525}
2024-07-11 09:32:26,299 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6aad5c94ac31f8d5b69\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,300 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 1.77, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6aad5c94ac31f8d5b69\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,302 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:26,303 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:26,649 DEBUG Received frame <Basic.Deliver object at 0x7fe82fa27a10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:26,651 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe82fa434d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:26,652 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe82fa43610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:26,653 INFO Message received
2024-07-11 09:32:26,654 INFO {'type': 'file_dowloaded', 'file_name': '1-005.dcm'}
2024-07-11 09:32:26,655 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:26,657 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,659 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,661 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0012020949998259312}
2024-07-11 09:32:26,662 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6aad5c94ac31f8d5b6a\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,665 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.693, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,667 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:26,669 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:26,670 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,672 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,672 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007403229992632987}
2024-07-11 09:32:26,673 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6aad5c94ac31f8d5b6a\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,675 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.047, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6aad5c94ac31f8d5b6a\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:26,676 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:26,678 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:27,028 DEBUG Received frame <Basic.Deliver object at 0x7fe82fa27bf0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:27,030 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe82fa434d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:27,031 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe82fa43610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:27,032 INFO Message received
2024-07-11 09:32:27,033 INFO {'type': 'file_dowloaded', 'file_name': '1-006.dcm'}
2024-07-11 09:32:27,034 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:27,035 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,037 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,038 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001060217999111046}
2024-07-11 09:32:27,039 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6abd5c94ac31f8d5b6b\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,041 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.021, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,042 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:27,044 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:27,045 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,046 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,047 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008474650003336137}
2024-07-11 09:32:27,048 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6abd5c94ac31f8d5b6b\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,051 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.502, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6abd5c94ac31f8d5b6b\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,052 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:27,056 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:27,402 DEBUG Received frame <Basic.Deliver object at 0x7fe82fa27d70> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:27,404 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe831032c10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:27,405 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe82fa43610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:27,406 INFO Message received
2024-07-11 09:32:27,407 INFO {'type': 'file_dowloaded', 'file_name': '1-007.dcm'}
2024-07-11 09:32:27,408 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:27,410 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,411 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,412 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008462839996354887}
2024-07-11 09:32:27,413 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6abd5c94ac31f8d5b6c\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,415 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 1.943, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,416 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:27,419 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:27,421 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,425 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,428 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.002217213001131313}
2024-07-11 09:32:27,433 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6abd5c94ac31f8d5b6c\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,441 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 7.848000000000001, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6abd5c94ac31f8d5b6c\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,442 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:27,443 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:27,801 DEBUG Received frame <Basic.Deliver object at 0x7fe82fa27dd0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:27,802 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe82fa42c10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:27,802 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe82fa43610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:27,805 INFO Message received
2024-07-11 09:32:27,806 INFO {'type': 'file_dowloaded', 'file_name': '1-008.dcm'}
2024-07-11 09:32:27,808 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:27,811 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,818 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,820 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.002177931000915123}
2024-07-11 09:32:27,821 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6abd5c94ac31f8d5b6d\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,825 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 3.364, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,826 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:27,829 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:27,831 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,832 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,834 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0020214929991198005}
2024-07-11 09:32:27,837 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6abd5c94ac31f8d5b6d\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,839 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 1.709, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6abd5c94ac31f8d5b6d\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:27,840 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:27,841 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:28,245 DEBUG Received frame <Basic.Deliver object at 0x7fe82fa27e90> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:28,246 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe8310334d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:28,247 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe82fa43610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:28,249 INFO Message received
2024-07-11 09:32:28,249 INFO {'type': 'file_dowloaded', 'file_name': '1-009.dcm'}
2024-07-11 09:32:28,250 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:28,251 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,252 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,253 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008131599988701055}
2024-07-11 09:32:28,254 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6acd5c94ac31f8d5b6e\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,256 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 1.7329999999999999, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,257 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:28,259 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:28,260 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,268 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,269 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0010319480006728554}
2024-07-11 09:32:28,270 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6acd5c94ac31f8d5b6e\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,273 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.284, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6acd5c94ac31f8d5b6e\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,277 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:28,283 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:28,642 DEBUG Received frame <Basic.Deliver object at 0x7fe82fa27dd0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:28,643 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe82fa434d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:28,644 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe82fa43610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:28,645 INFO Message received
2024-07-11 09:32:28,646 INFO {'type': 'file_dowloaded', 'file_name': '1-010.dcm'}
2024-07-11 09:32:28,647 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:28,649 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,650 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,652 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0013366490002226783}
2024-07-11 09:32:28,653 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6acd5c94ac31f8d5b6f\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,655 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.1470000000000002, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,656 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:28,660 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:28,661 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,662 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,663 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.000822650999907637}
2024-07-11 09:32:28,664 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6acd5c94ac31f8d5b6f\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,666 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.008, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6acd5c94ac31f8d5b6f\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:28,667 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:28,671 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:29,055 DEBUG Received frame <Basic.Deliver object at 0x7fe82fa27e90> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:29,056 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe8310334d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:29,057 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe82fa43610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:29,059 INFO Message received
2024-07-11 09:32:29,062 INFO {'type': 'file_dowloaded', 'file_name': '1-011.dcm'}
2024-07-11 09:32:29,063 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:29,067 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,069 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,070 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0010255060005874839}
2024-07-11 09:32:29,071 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6add5c94ac31f8d5b70\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,073 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 1.7229999999999999, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,075 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:29,077 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:29,079 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,084 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,086 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00232824900012929}
2024-07-11 09:32:29,087 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6add5c94ac31f8d5b70\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,090 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.367, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6add5c94ac31f8d5b70\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,093 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:29,094 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:29,436 DEBUG Received frame <Basic.Deliver object at 0x7fe82fa27dd0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:29,438 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe82fa42b10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:29,441 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe82fa43610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:32:29,442 INFO Message received
2024-07-11 09:32:29,443 INFO {'type': 'file_dowloaded', 'file_name': '1-012.dcm'}
2024-07-11 09:32:29,447 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:29,448 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fe83073d260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,450 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,450 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008981980008684332}
2024-07-11 09:32:29,451 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0, \"_id\": {\"$oid\": \"668fa6add5c94ac31f8d5b71\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,453 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 1.746, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,454 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:29,457 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}}
2024-07-11 09:32:29,458 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa69bd5c94ac31f8d5b65, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001088187000277685>]>", "clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,459 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,460 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011064740010624519}
2024-07-11 09:32:29,462 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa6add5c94ac31f8d5b71\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"9RbbNyCzTYampEsXD+VxmA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,464 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Command succeeded", "durationMS": 2.347, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa6add5c94ac31f8d5b71\"}, \"name\": \"Dfdfdf\", \"description\": \"Dfdfdfd\", \"price\": 1.0}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:32:29,465 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:32:29,467 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:32:41,167 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:32:41,298 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe82fa43e10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:33:10,622 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:33:10,866 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe82fa5eb90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:33:40,074 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:33:40,580 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe82fa5f050> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:34:09,577 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:34:10,348 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe82fa5cb50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:34:39,071 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:34:40,108 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe82fa5ee90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:35:08,954 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:35:10,058 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:35:10,060 DEBUG {"clientId": {"$oid": "668fa69bd5c94ac31f8d5b65"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "reason": "Connection pool was stale", "error": "stale"}
2024-07-11 09:35:10,275 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe82fa42190> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe83141a260>
2024-07-11 09:35:52,317 INFO Starting consumer...
2024-07-11 09:35:52,318 DEBUG Using selector: EpollSelector
2024-07-11 09:35:52,319 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:35:52,320 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:35:52,320 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:35:52,322 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 09:35:52,334 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:35:52,336 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 09:35:52,337 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f88037139d0>
2024-07-11 09:35:52,338 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 09:35:52,341 DEBUG Received frame <Channel.OpenOk object at 0x7f8803559110> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:35:52,342 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:35:52,344 DEBUG Received frame <Confirm.SelectOk object at 0x7f880355a090> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:35:52,346 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:35:52,349 DEBUG Received frame <Basic.QosOk object at 0x7f88051433d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:35:52,350 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:35:52,352 DEBUG Received frame <Basic.QosOk object at 0x7f880355a0d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:35:52,353 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:35:52,354 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:35:52,362 DEBUG Received frame <Queue.DeclareOk object at 0x7f8803568a50> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:35:52,364 INFO Consumer successfully started!
2024-07-11 09:35:52,364 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 09:35:52,366 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.75f1937ad8244191b1c326f72e54e112\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:35:52,369 DEBUG Received frame <Basic.ConsumeOk object at 0x7f880355ab90> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:35:57,342 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 09:36:21,713 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:36:21,932 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88043ccc50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:29,207 DEBUG Received frame <Basic.Deliver object at 0x7f880367a510> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:29,208 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f880355a090> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:29,209 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:29,211 INFO Message received
2024-07-11 09:36:29,212 INFO {'type': 'file_dowloaded', 'file_name': '1-001.dcm'}
2024-07-11 09:36:29,215 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection pool created", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,216 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:29,218 DEBUG {"message": "Waiting for suitable server to become available", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "remainingTimeMS": 29}
2024-07-11 09:36:29,219 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,220 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,222 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,225 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:29,229 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0013442460003716405}
2024-07-11 09:36:29,230 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.007955105000291951}
2024-07-11 09:36:29,231 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-001.dcm\", \"_id\": {\"$oid\": \"668fa79de4e4ee412f4652be\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,247 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 15.854, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,248 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:29,250 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:29,252 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,253 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,254 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0014517700001306366}
2024-07-11 09:36:29,256 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa79de4e4ee412f4652be\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,259 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 3.376, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa79de4e4ee412f4652be\"}, \"file_name\": \"1-001.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,264 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:29,266 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:29,666 DEBUG Received frame <Basic.Deliver object at 0x7f880367a2d0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:29,667 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f880526fa90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:29,670 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:29,671 INFO Message received
2024-07-11 09:36:29,672 INFO {'type': 'file_dowloaded', 'file_name': '1-002.dcm'}
2024-07-11 09:36:29,673 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:29,675 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,676 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,677 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011698260004777694}
2024-07-11 09:36:29,678 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-002.dcm\", \"_id\": {\"$oid\": \"668fa79de4e4ee412f4652bf\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,681 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.065, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,681 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:29,684 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:29,685 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,688 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,692 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.004416403000504943}
2024-07-11 09:36:29,693 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa79de4e4ee412f4652bf\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,696 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.379, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa79de4e4ee412f4652bf\"}, \"file_name\": \"1-002.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:29,697 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:29,698 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:30,083 DEBUG Received frame <Basic.Deliver object at 0x7f880367a510> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:30,084 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f8805a9d8d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:30,085 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:30,087 INFO Message received
2024-07-11 09:36:30,088 INFO {'type': 'file_dowloaded', 'file_name': '1-003.dcm'}
2024-07-11 09:36:30,090 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:30,092 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,094 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,096 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0014896480006427737}
2024-07-11 09:36:30,098 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-003.dcm\", \"_id\": {\"$oid\": \"668fa79ee4e4ee412f4652c0\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,100 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.226, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,101 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:30,105 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:30,107 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,113 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,114 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0009234190001734532}
2024-07-11 09:36:30,116 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa79ee4e4ee412f4652c0\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,118 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.29, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa79ee4e4ee412f4652c0\"}, \"file_name\": \"1-003.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,119 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:30,121 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:30,476 DEBUG Received frame <Basic.Deliver object at 0x7f880353fcb0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:30,477 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f8803558210> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:30,479 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:30,481 INFO Message received
2024-07-11 09:36:30,481 INFO {'type': 'file_dowloaded', 'file_name': '1-004.dcm'}
2024-07-11 09:36:30,482 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:30,484 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,485 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,486 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.000694116999511607}
2024-07-11 09:36:30,487 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-004.dcm\", \"_id\": {\"$oid\": \"668fa79ee4e4ee412f4652c1\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,489 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 1.9200000000000002, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,490 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:30,492 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:30,493 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,494 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,495 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0018301390009582974}
2024-07-11 09:36:30,498 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa79ee4e4ee412f4652c1\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,500 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.083, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa79ee4e4ee412f4652c1\"}, \"file_name\": \"1-004.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,502 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:30,503 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:30,856 DEBUG Received frame <Basic.Deliver object at 0x7f880353f950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:30,858 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f880355a890> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:30,860 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:30,861 INFO Message received
2024-07-11 09:36:30,862 INFO {'type': 'file_dowloaded', 'file_name': '1-005.dcm'}
2024-07-11 09:36:30,863 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:30,865 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,866 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,868 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0014910739992046729}
2024-07-11 09:36:30,870 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-005.dcm\", \"_id\": {\"$oid\": \"668fa79ee4e4ee412f4652c2\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,872 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.8600000000000003, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,875 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:30,877 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:30,878 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,879 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,880 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007779150000715163}
2024-07-11 09:36:30,881 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa79ee4e4ee412f4652c2\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,883 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.144, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa79ee4e4ee412f4652c2\"}, \"file_name\": \"1-005.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:30,884 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:30,886 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:31,292 DEBUG Received frame <Basic.Deliver object at 0x7f880353fc50> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:31,293 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f880355ac10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:31,294 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:31,296 INFO Message received
2024-07-11 09:36:31,296 INFO {'type': 'file_dowloaded', 'file_name': '1-006.dcm'}
2024-07-11 09:36:31,298 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:31,299 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,300 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,301 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008349359995918348}
2024-07-11 09:36:31,302 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-006.dcm\", \"_id\": {\"$oid\": \"668fa79fe4e4ee412f4652c3\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,304 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.077, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,306 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:31,307 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:31,308 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,309 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,310 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.000993472000118345}
2024-07-11 09:36:31,312 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa79fe4e4ee412f4652c3\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,315 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.544, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa79fe4e4ee412f4652c3\"}, \"file_name\": \"1-006.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,317 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:31,319 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:31,675 DEBUG Received frame <Basic.Deliver object at 0x7f880353fdd0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:31,676 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f880355af10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:31,677 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:31,679 INFO Message received
2024-07-11 09:36:31,680 INFO {'type': 'file_dowloaded', 'file_name': '1-007.dcm'}
2024-07-11 09:36:31,682 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:31,683 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,685 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,687 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0018337019992031856}
2024-07-11 09:36:31,689 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-007.dcm\", \"_id\": {\"$oid\": \"668fa79fe4e4ee412f4652c4\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,694 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 5.162, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,695 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:31,697 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:31,698 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,699 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,700 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001108020998799475}
2024-07-11 09:36:31,702 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa79fe4e4ee412f4652c4\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,704 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.379, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa79fe4e4ee412f4652c4\"}, \"file_name\": \"1-007.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:31,706 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:31,707 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:32,085 DEBUG Received frame <Basic.Deliver object at 0x7f880353fe30> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:32,086 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f8803558210> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:32,088 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:32,089 INFO Message received
2024-07-11 09:36:32,091 INFO {'type': 'file_dowloaded', 'file_name': '1-008.dcm'}
2024-07-11 09:36:32,093 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:32,095 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,097 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,097 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0009446990006836131}
2024-07-11 09:36:32,099 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-008.dcm\", \"_id\": {\"$oid\": \"668fa7a0e4e4ee412f4652c5\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,101 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.298, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,102 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:32,103 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:32,104 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,107 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,113 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.006297859999904176}
2024-07-11 09:36:32,114 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa7a0e4e4ee412f4652c5\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,117 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.902, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa7a0e4e4ee412f4652c5\"}, \"file_name\": \"1-008.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,118 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:32,120 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:32,479 DEBUG Received frame <Basic.Deliver object at 0x7f880353f9b0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:32,481 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f8803571e50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:32,487 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:32,489 INFO Message received
2024-07-11 09:36:32,489 INFO {'type': 'file_dowloaded', 'file_name': '1-009.dcm'}
2024-07-11 09:36:32,491 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:32,492 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,498 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,498 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008037520001380472}
2024-07-11 09:36:32,500 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-009.dcm\", \"_id\": {\"$oid\": \"668fa7a0e4e4ee412f4652c6\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,504 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 4.271999999999999, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,519 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:32,524 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:32,525 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,526 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,527 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0009628329989936901}
2024-07-11 09:36:32,529 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa7a0e4e4ee412f4652c6\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,533 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 3.68, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa7a0e4e4ee412f4652c6\"}, \"file_name\": \"1-009.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,534 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:32,536 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:32,937 DEBUG Received frame <Basic.Deliver object at 0x7f880353fe30> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:32,938 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f8804af8c90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:32,939 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:32,941 INFO Message received
2024-07-11 09:36:32,941 INFO {'type': 'file_dowloaded', 'file_name': '1-010.dcm'}
2024-07-11 09:36:32,943 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:32,945 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,947 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,950 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0027489730000525014}
2024-07-11 09:36:32,952 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-010.dcm\", \"_id\": {\"$oid\": \"668fa7a0e4e4ee412f4652c7\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,964 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 11.775, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,969 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:32,972 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:32,973 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,976 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,980 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.004132930000196211}
2024-07-11 09:36:32,982 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa7a0e4e4ee412f4652c7\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,984 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.392, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa7a0e4e4ee412f4652c7\"}, \"file_name\": \"1-010.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:32,986 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:32,988 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:33,430 DEBUG Received frame <Basic.Deliver object at 0x7f880353f9b0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:33,431 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f8804af8c90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:33,432 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:33,434 INFO Message received
2024-07-11 09:36:33,435 INFO {'type': 'file_dowloaded', 'file_name': '1-011.dcm'}
2024-07-11 09:36:33,441 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:33,442 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,443 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,443 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0005919169998378493}
2024-07-11 09:36:33,444 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-011.dcm\", \"_id\": {\"$oid\": \"668fa7a1e4e4ee412f4652c8\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,446 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 1.788, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,447 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:33,450 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:33,451 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,457 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,458 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0015223629998217802}
2024-07-11 09:36:33,462 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa7a1e4e4ee412f4652c8\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,465 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 3.47, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa7a1e4e4ee412f4652c8\"}, \"file_name\": \"1-011.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,466 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:33,468 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:33,847 DEBUG Received frame <Basic.Deliver object at 0x7f880353fe30> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:33,848 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f8803559610> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:33,849 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f88043ccc50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:36:33,854 INFO Message received
2024-07-11 09:36:33,855 INFO {'type': 'file_dowloaded', 'file_name': '1-012.dcm'}
2024-07-11 09:36:33,856 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:33,857 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f8804251260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,859 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,861 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0019030559997190721}
2024-07-11 09:36:33,862 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-012.dcm\", \"_id\": {\"$oid\": \"668fa7a1e4e4ee412f4652c9\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,865 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.3640000000000003, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,866 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:33,868 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}}
2024-07-11 09:36:33,869 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fa778e4e4ee412f4652bd, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.000932787001147517>]>", "clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,870 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,872 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.002118864000294707}
2024-07-11 09:36:33,888 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fa7a1e4e4ee412f4652c9\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"m8O9fmjCTLqupg7BRz9KAA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,890 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Command succeeded", "durationMS": 2.453, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fa7a1e4e4ee412f4652c9\"}, \"file_name\": \"1-012.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 09:36:33,891 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 09:36:33,893 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 09:36:51,191 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:37:20,654 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:37:21,413 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571110> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:37:50,085 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:37:51,117 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:38:19,563 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:38:20,858 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572750> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:38:48,916 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:38:50,476 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571250> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:39:18,318 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:39:20,142 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88035725d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:39:47,771 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:39:49,862 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572310> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:40:17,185 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:40:19,557 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:40:46,623 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:40:49,262 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571790> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:41:16,048 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:41:18,956 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572710> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:41:45,450 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:41:48,640 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571c10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:42:14,875 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:42:18,331 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572410> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:42:44,310 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:42:48,029 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88035726d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:43:13,729 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:43:17,714 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571710> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:43:43,155 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:43:47,406 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571910> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:44:12,582 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:44:17,098 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572910> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:44:41,972 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:44:46,756 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:45:11,350 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:45:16,401 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571110> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:45:40,772 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:45:46,091 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88035729d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:46:10,165 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:46:15,753 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:46:39,568 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:46:45,427 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571b50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:47:08,929 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:47:15,076 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:47:38,218 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:47:44,632 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571490> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:48:07,638 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:48:14,316 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:48:36,997 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:48:43,941 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572550> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:49:06,373 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:49:13,588 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:49:35,743 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:49:43,233 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572410> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:50:04,999 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:50:12,762 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:50:34,373 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:50:42,429 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572d50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:51:04,164 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:51:12,492 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:51:33,114 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:51:41,715 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572b10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:52:02,457 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:52:11,323 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:52:31,749 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:52:40,886 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572d10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:53:01,071 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:53:10,500 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:53:30,408 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:53:40,114 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572ad0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:53:59,726 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:54:09,705 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:54:29,053 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:54:39,320 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572c10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:54:58,387 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:55:08,930 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:55:27,714 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:55:38,531 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803570450> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:55:57,022 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:56:08,124 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:56:26,292 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:56:37,680 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572cd0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:56:55,602 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:57:07,265 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:57:24,927 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:57:36,864 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572710> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:57:54,176 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:58:06,390 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:58:23,504 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:58:35,995 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571210> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:58:52,812 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:59:05,578 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:59:22,045 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 09:59:35,101 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572a90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 09:59:51,352 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:00:04,683 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:00:20,646 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:00:34,255 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803570610> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:00:49,892 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:01:03,775 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:01:19,189 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:01:33,348 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571910> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:01:48,413 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:02:02,849 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:02:17,694 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:02:32,416 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571210> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:02:46,965 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:03:01,965 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:03:16,160 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:03:31,436 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572650> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:03:45,448 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:04:01,001 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:04:14,719 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:04:30,548 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803570610> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:04:43,962 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:05:00,068 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:05:13,220 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:05:29,606 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572c50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:05:42,429 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:05:59,093 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:06:11,688 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:06:28,632 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572c10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:06:40,942 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:06:58,165 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:07:10,189 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:07:27,692 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572d10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:07:39,438 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:07:57,221 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:08:08,594 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:08:26,657 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572b10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:08:37,797 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:08:56,142 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:09:07,075 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:09:25,705 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572910> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:09:36,296 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:09:55,208 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:10:05,532 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:10:24,722 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572a90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:10:34,768 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:10:54,240 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:11:03,984 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:11:23,747 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572950> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:11:33,216 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:11:53,264 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:12:02,352 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:12:22,683 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572cd0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:12:31,583 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:12:52,197 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:13:00,804 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:13:21,703 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88035726d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:13:29,998 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:13:51,180 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571110> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:13:59,687 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:14:20,277 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:14:28,404 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:14:50,163 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572550> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:14:57,516 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:15:19,559 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:15:26,754 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:15:49,082 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572d90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:15:55,926 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:16:18,537 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:16:25,129 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:48:17,530 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572a90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:48:24,192 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:48:46,934 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:48:53,895 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:49:16,338 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571210> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:49:23,539 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:49:45,688 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:49:53,251 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:50:15,102 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88035729d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:50:23,019 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:50:44,568 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:50:52,796 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:51:14,045 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803572950> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:51:22,509 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:51:43,459 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f88037b7350> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:51:52,301 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:52:12,959 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f8803571e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f8803551450>
2024-07-11 10:52:22,107 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:52:26,143 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:52:26,144 DEBUG {"clientId": {"$oid": "668fa778e4e4ee412f4652bd"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "reason": "Connection pool was stale", "error": "stale"}
2024-07-11 10:53:10,946 INFO Starting consumer...
2024-07-11 10:53:10,947 DEBUG Using selector: EpollSelector
2024-07-11 10:53:10,948 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:53:10,949 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:53:10,950 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:53:10,951 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 10:53:10,961 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:53:10,962 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:53:10,963 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7fed8b9bc1d0>
2024-07-11 10:53:10,965 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 10:53:10,967 DEBUG Received frame <Channel.OpenOk object at 0x7fed8dae7950> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:10,969 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:53:10,973 DEBUG Received frame <Confirm.SelectOk object at 0x7fed8b9bd6d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:10,975 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:53:10,977 DEBUG Received frame <Basic.QosOk object at 0x7fed8b9bf150> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:10,979 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:53:10,980 DEBUG Received frame <Basic.QosOk object at 0x7fed8b9bf350> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:10,981 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 10:53:10,982 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:53:10,990 DEBUG Received frame <Queue.DeclareOk object at 0x7fed8b9cb480> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:10,990 INFO Consumer successfully started!
2024-07-11 10:53:10,991 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 10:53:10,992 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.cdc3fd8296b8438e93218fa11fc2e78f\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:53:10,993 DEBUG Received frame <Basic.ConsumeOk object at 0x7fed8db6e6d0> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:15,968 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 10:53:40,829 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:53:41,082 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fed8dae4f10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:57,822 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a73b0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:57,823 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9bde50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:57,825 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:57,828 INFO Message received
2024-07-11 10:53:57,829 INFO {'type': 'file_dowloaded', 'file_name': '1-001.dcm'}
2024-07-11 10:53:57,831 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection pool created", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:57,833 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:57,835 DEBUG {"message": "Waiting for suitable server to become available", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "remainingTimeMS": 29}
2024-07-11 10:53:57,837 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:57,838 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:57,840 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:57,841 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:57,848 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.002323132001038175}
2024-07-11 10:53:57,849 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00907940300021437}
2024-07-11 10:53:57,850 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-001.dcm\", \"_id\": {\"$oid\": \"668fb9c56df5f4d5e71fca20\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:57,857 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 7.393000000000001, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:57,862 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:57,865 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:57,867 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:57,869 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:57,869 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.000795216999904369}
2024-07-11 10:53:57,871 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9c56df5f4d5e71fca20\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:57,873 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.7279999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9c56df5f4d5e71fca20\"}, \"file_name\": \"1-001.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:57,874 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:57,877 INFO Created new item on mongodb 
2024-07-11 10:53:57,879 INFO {'_id': ObjectId('668fb9c56df5f4d5e71fca20'), 'file_name': '1-001.dcm', 'id': '668fb9c56df5f4d5e71fca20'}
2024-07-11 10:53:57,881 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:53:58,315 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a74d0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:58,315 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9bff50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:58,317 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:58,319 INFO Message received
2024-07-11 10:53:58,319 INFO {'type': 'file_dowloaded', 'file_name': '1-002.dcm'}
2024-07-11 10:53:58,321 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:58,322 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,323 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,324 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008087229998636758}
2024-07-11 10:53:58,325 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-002.dcm\", \"_id\": {\"$oid\": \"668fb9c66df5f4d5e71fca21\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,331 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 6.2509999999999994, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,332 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:58,335 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:58,337 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,338 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,339 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0010392120002507}
2024-07-11 10:53:58,340 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9c66df5f4d5e71fca21\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,342 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.2300000000000004, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9c66df5f4d5e71fca21\"}, \"file_name\": \"1-002.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,343 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:58,345 INFO Created new item on mongodb 
2024-07-11 10:53:58,346 INFO {'_id': ObjectId('668fb9c66df5f4d5e71fca21'), 'file_name': '1-002.dcm', 'id': '668fb9c66df5f4d5e71fca21'}
2024-07-11 10:53:58,348 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:53:58,758 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a7410> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:58,759 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9ad3d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:58,760 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:58,762 INFO Message received
2024-07-11 10:53:58,763 INFO {'type': 'file_dowloaded', 'file_name': '1-003.dcm'}
2024-07-11 10:53:58,765 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:58,767 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,768 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,769 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0010812199998326832}
2024-07-11 10:53:58,770 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-003.dcm\", \"_id\": {\"$oid\": \"668fb9c66df5f4d5e71fca22\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,773 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.523, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,774 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:58,776 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:58,777 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,780 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,781 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0013258119997772155}
2024-07-11 10:53:58,783 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9c66df5f4d5e71fca22\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,785 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.783, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9c66df5f4d5e71fca22\"}, \"file_name\": \"1-003.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:58,786 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:58,788 INFO Created new item on mongodb 
2024-07-11 10:53:58,790 INFO {'_id': ObjectId('668fb9c66df5f4d5e71fca22'), 'file_name': '1-003.dcm', 'id': '668fb9c66df5f4d5e71fca22'}
2024-07-11 10:53:58,791 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:53:59,154 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a7230> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:59,155 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9d2990> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:59,156 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:59,158 INFO Message received
2024-07-11 10:53:59,158 INFO {'type': 'file_dowloaded', 'file_name': '1-004.dcm'}
2024-07-11 10:53:59,160 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:59,161 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,163 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,163 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00089515699983167}
2024-07-11 10:53:59,165 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-004.dcm\", \"_id\": {\"$oid\": \"668fb9c76df5f4d5e71fca23\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,167 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.839, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,169 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:59,171 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:59,172 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,173 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,174 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007068720005918294}
2024-07-11 10:53:59,175 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9c76df5f4d5e71fca23\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,177 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.312, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9c76df5f4d5e71fca23\"}, \"file_name\": \"1-004.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,178 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:59,179 INFO Created new item on mongodb 
2024-07-11 10:53:59,180 INFO {'_id': ObjectId('668fb9c76df5f4d5e71fca23'), 'file_name': '1-004.dcm', 'id': '668fb9c76df5f4d5e71fca23'}
2024-07-11 10:53:59,182 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:53:59,549 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a78f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:59,550 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9d3290> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:59,552 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:59,556 INFO Message received
2024-07-11 10:53:59,557 INFO {'type': 'file_dowloaded', 'file_name': '1-005.dcm'}
2024-07-11 10:53:59,559 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:59,560 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,561 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,562 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008292370002891403}
2024-07-11 10:53:59,563 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-005.dcm\", \"_id\": {\"$oid\": \"668fb9c76df5f4d5e71fca24\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,565 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 1.934, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,566 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:59,568 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:59,569 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,571 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,573 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0021505530003196327}
2024-07-11 10:53:59,574 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9c76df5f4d5e71fca24\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,577 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.9099999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9c76df5f4d5e71fca24\"}, \"file_name\": \"1-005.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,578 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:59,580 INFO Created new item on mongodb 
2024-07-11 10:53:59,582 INFO {'_id': ObjectId('668fb9c76df5f4d5e71fca24'), 'file_name': '1-005.dcm', 'id': '668fb9c76df5f4d5e71fca24'}
2024-07-11 10:53:59,583 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:53:59,927 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a7710> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:59,928 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9d3590> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:59,929 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:53:59,931 INFO Message received
2024-07-11 10:53:59,931 INFO {'type': 'file_dowloaded', 'file_name': '1-006.dcm'}
2024-07-11 10:53:59,933 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:59,934 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,935 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,936 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.000932652001210954}
2024-07-11 10:53:59,937 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-006.dcm\", \"_id\": {\"$oid\": \"668fb9c76df5f4d5e71fca25\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,942 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 5.713, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,944 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:59,946 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:53:59,947 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,948 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,949 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011188199987373082}
2024-07-11 10:53:59,950 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9c76df5f4d5e71fca25\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,953 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.601, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9c76df5f4d5e71fca25\"}, \"file_name\": \"1-006.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:53:59,953 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:53:59,954 INFO Created new item on mongodb 
2024-07-11 10:53:59,955 INFO {'_id': ObjectId('668fb9c76df5f4d5e71fca25'), 'file_name': '1-006.dcm', 'id': '668fb9c76df5f4d5e71fca25'}
2024-07-11 10:53:59,956 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:54:00,341 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a7770> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:00,342 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9d38d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:00,347 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:00,350 INFO Message received
2024-07-11 10:54:00,351 INFO {'type': 'file_dowloaded', 'file_name': '1-007.dcm'}
2024-07-11 10:54:00,353 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:00,355 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,356 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,357 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007546169999841368}
2024-07-11 10:54:00,358 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-007.dcm\", \"_id\": {\"$oid\": \"668fb9c86df5f4d5e71fca26\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,364 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 7.029999999999999, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,366 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:00,370 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:00,372 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,373 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,374 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008317640003951965}
2024-07-11 10:54:00,375 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9c86df5f4d5e71fca26\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,383 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 8.272, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9c86df5f4d5e71fca26\"}, \"file_name\": \"1-007.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,385 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:00,386 INFO Created new item on mongodb 
2024-07-11 10:54:00,387 INFO {'_id': ObjectId('668fb9c86df5f4d5e71fca26'), 'file_name': '1-007.dcm', 'id': '668fb9c86df5f4d5e71fca26'}
2024-07-11 10:54:00,387 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:54:00,737 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a7a70> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:00,738 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9d38d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:00,739 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:00,740 INFO Message received
2024-07-11 10:54:00,741 INFO {'type': 'file_dowloaded', 'file_name': '1-008.dcm'}
2024-07-11 10:54:00,742 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:00,743 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,744 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,745 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0006840510013716994}
2024-07-11 10:54:00,746 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-008.dcm\", \"_id\": {\"$oid\": \"668fb9c86df5f4d5e71fca27\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,749 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 3.316, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,752 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:00,755 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:00,756 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,757 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,758 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0010945419999188744}
2024-07-11 10:54:00,759 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9c86df5f4d5e71fca27\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,761 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 1.727, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9c86df5f4d5e71fca27\"}, \"file_name\": \"1-008.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:00,762 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:00,766 INFO Created new item on mongodb 
2024-07-11 10:54:00,767 INFO {'_id': ObjectId('668fb9c86df5f4d5e71fca27'), 'file_name': '1-008.dcm', 'id': '668fb9c86df5f4d5e71fca27'}
2024-07-11 10:54:00,767 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:54:01,117 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a7b30> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:01,118 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9d3dd0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:01,119 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:01,121 INFO Message received
2024-07-11 10:54:01,122 INFO {'type': 'file_dowloaded', 'file_name': '1-009.dcm'}
2024-07-11 10:54:01,123 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:01,124 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,125 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,126 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.000802976999693783}
2024-07-11 10:54:01,127 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-009.dcm\", \"_id\": {\"$oid\": \"668fb9c96df5f4d5e71fca28\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,129 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.005, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,129 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:01,131 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:01,132 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,133 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,135 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0016949259988905396}
2024-07-11 10:54:01,136 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9c96df5f4d5e71fca28\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,138 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.1029999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9c96df5f4d5e71fca28\"}, \"file_name\": \"1-009.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,139 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:01,141 INFO Created new item on mongodb 
2024-07-11 10:54:01,141 INFO {'_id': ObjectId('668fb9c96df5f4d5e71fca28'), 'file_name': '1-009.dcm', 'id': '668fb9c96df5f4d5e71fca28'}
2024-07-11 10:54:01,142 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:54:01,592 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a7bf0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:01,594 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9d3dd0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:01,596 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:01,598 INFO Message received
2024-07-11 10:54:01,599 INFO {'type': 'file_dowloaded', 'file_name': '1-010.dcm'}
2024-07-11 10:54:01,600 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:01,602 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,603 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,604 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007242929987114621}
2024-07-11 10:54:01,606 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-010.dcm\", \"_id\": {\"$oid\": \"668fb9c96df5f4d5e71fca29\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,608 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.463, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,610 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:01,611 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:01,613 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,614 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,615 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007584899994981242}
2024-07-11 10:54:01,617 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9c96df5f4d5e71fca29\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,622 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 5.736, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9c96df5f4d5e71fca29\"}, \"file_name\": \"1-010.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:01,625 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:01,626 INFO Created new item on mongodb 
2024-07-11 10:54:01,627 INFO {'_id': ObjectId('668fb9c96df5f4d5e71fca29'), 'file_name': '1-010.dcm', 'id': '668fb9c96df5f4d5e71fca29'}
2024-07-11 10:54:01,628 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:54:02,077 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a7cb0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:02,078 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9d3b10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:02,080 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:02,084 INFO Message received
2024-07-11 10:54:02,085 INFO {'type': 'file_dowloaded', 'file_name': '1-011.dcm'}
2024-07-11 10:54:02,086 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:02,089 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,090 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,093 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.002226880000307574}
2024-07-11 10:54:02,096 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-011.dcm\", \"_id\": {\"$oid\": \"668fb9ca6df5f4d5e71fca2a\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,101 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 3.2, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,104 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:02,106 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:02,108 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,112 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,113 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0013775839997833828}
2024-07-11 10:54:02,115 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9ca6df5f4d5e71fca2a\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,117 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.506, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9ca6df5f4d5e71fca2a\"}, \"file_name\": \"1-011.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,119 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:02,123 INFO Created new item on mongodb 
2024-07-11 10:54:02,128 INFO {'_id': ObjectId('668fb9ca6df5f4d5e71fca2a'), 'file_name': '1-011.dcm', 'id': '668fb9ca6df5f4d5e71fca2a'}
2024-07-11 10:54:02,130 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:54:02,488 DEBUG Received frame <Basic.Deliver object at 0x7fed8b9a7ef0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:02,489 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fed8b9d3b10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:02,490 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fed8dae4f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:54:02,491 INFO Message received
2024-07-11 10:54:02,492 INFO {'type': 'file_dowloaded', 'file_name': '1-012.dcm'}
2024-07-11 10:54:02,493 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:02,494 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fed8d241260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,497 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,499 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001946943000803003}
2024-07-11 10:54:02,501 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-012.dcm\", \"_id\": {\"$oid\": \"668fb9ca6df5f4d5e71fca2b\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,506 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 4.667, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,507 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:02,508 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}}
2024-07-11 10:54:02,509 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fb9966df5f4d5e71fca1f, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014884519987390377>]>", "clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,510 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,511 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011359939999238122}
2024-07-11 10:54:02,514 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fb9ca6df5f4d5e71fca2b\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"aSQtxjbTQqSr6RHYN9DVlg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,517 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Command succeeded", "durationMS": 2.591, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fb9ca6df5f4d5e71fca2b\"}, \"file_name\": \"1-012.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:54:02,518 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:54:02,519 INFO Created new item on mongodb 
2024-07-11 10:54:02,520 INFO {'_id': ObjectId('668fb9ca6df5f4d5e71fca2b'), 'file_name': '1-012.dcm', 'id': '668fb9ca6df5f4d5e71fca2b'}
2024-07-11 10:54:02,521 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:54:10,692 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:54:40,542 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:54:41,084 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fed8b9d39d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:55:10,431 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:55:11,086 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fed8b9afb90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fed8c631ea0>
2024-07-11 10:55:20,708 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:55:20,711 DEBUG {"clientId": {"$oid": "668fb9966df5f4d5e71fca1f"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "reason": "Connection pool was stale", "error": "stale"}
2024-07-11 10:56:05,626 INFO Starting consumer...
2024-07-11 10:56:05,627 DEBUG Using selector: EpollSelector
2024-07-11 10:56:05,628 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:56:05,629 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:56:05,630 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:56:05,631 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 10:56:05,639 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:56:05,647 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:56:05,648 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f68a3203c90>
2024-07-11 10:56:05,650 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 10:56:05,653 DEBUG Received frame <Channel.OpenOk object at 0x7f68a3202cd0> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:05,654 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:56:05,655 DEBUG Received frame <Confirm.SelectOk object at 0x7f68a3202d10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:05,658 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:56:05,659 DEBUG Received frame <Basic.QosOk object at 0x7f68a3212610> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:05,661 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:56:05,662 DEBUG Received frame <Basic.QosOk object at 0x7f68a3212dd0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:05,664 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 10:56:05,665 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:56:05,671 DEBUG Received frame <Queue.DeclareOk object at 0x7f68a321b430> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:05,673 INFO Consumer successfully started!
2024-07-11 10:56:05,674 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 10:56:05,676 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.f56247e41cf349739f9739fbdfb8b4c5\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:56:05,678 DEBUG Received frame <Basic.ConsumeOk object at 0x7f68a32136d0> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:10,652 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 10:56:14,381 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fb350> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:14,382 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a3213990> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:14,384 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a3212a90> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:14,385 INFO Message received
2024-07-11 10:56:14,387 INFO {'type': 'file_dowloaded', 'file_name': '1-001.dcm'}
2024-07-11 10:56:14,389 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection pool created", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,392 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:14,395 DEBUG {"message": "Waiting for suitable server to become available", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "remainingTimeMS": 29}
2024-07-11 10:56:14,397 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,398 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,401 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,402 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:14,413 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.008690874001331395}
2024-07-11 10:56:14,415 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.01428880799903709}
2024-07-11 10:56:14,417 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-001.dcm\", \"_id\": {\"$oid\": \"668fba4ed1e48f823be74282\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,423 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 6.622, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,424 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:14,427 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:14,429 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,434 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,436 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0013959789994260063}
2024-07-11 10:56:14,437 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba4ed1e48f823be74282\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,442 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 5.3870000000000005, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba4ed1e48f823be74282\"}, \"file_name\": \"1-001.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,448 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:14,450 INFO Created new item on mongodb 
2024-07-11 10:56:14,451 INFO {'_id': ObjectId('668fba4ed1e48f823be74282'), 'file_name': '1-001.dcm', 'id': '668fba4ed1e48f823be74282'}
2024-07-11 10:56:14,478 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:14,830 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fb470> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:14,832 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a3213ad0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:14,833 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a3213b10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:14,835 INFO Message received
2024-07-11 10:56:14,835 INFO {'type': 'file_dowloaded', 'file_name': '1-002.dcm'}
2024-07-11 10:56:14,837 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:14,839 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,840 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,841 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0010753269998531323}
2024-07-11 10:56:14,842 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-002.dcm\", \"_id\": {\"$oid\": \"668fba4ed1e48f823be74283\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,845 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.225, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,846 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:14,848 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:14,849 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,852 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,855 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001998044001084054}
2024-07-11 10:56:14,856 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba4ed1e48f823be74283\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,858 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.549, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba4ed1e48f823be74283\"}, \"file_name\": \"1-002.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:14,859 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:14,860 INFO Created new item on mongodb 
2024-07-11 10:56:14,861 INFO {'_id': ObjectId('668fba4ed1e48f823be74283'), 'file_name': '1-002.dcm', 'id': '668fba4ed1e48f823be74283'}
2024-07-11 10:56:14,890 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:15,223 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fb830> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:15,225 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a3213ad0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:15,226 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a3213810> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:15,227 INFO Message received
2024-07-11 10:56:15,228 INFO {'type': 'file_dowloaded', 'file_name': '1-003.dcm'}
2024-07-11 10:56:15,230 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:15,231 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,232 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,234 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0016502690014021937}
2024-07-11 10:56:15,235 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-003.dcm\", \"_id\": {\"$oid\": \"668fba4fd1e48f823be74284\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,238 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.699, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,242 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:15,244 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:15,247 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,251 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,252 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0012992349984415341}
2024-07-11 10:56:15,253 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba4fd1e48f823be74284\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,255 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 1.96, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba4fd1e48f823be74284\"}, \"file_name\": \"1-003.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,256 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:15,258 INFO Created new item on mongodb 
2024-07-11 10:56:15,260 INFO {'_id': ObjectId('668fba4fd1e48f823be74284'), 'file_name': '1-003.dcm', 'id': '668fba4fd1e48f823be74284'}
2024-07-11 10:56:15,289 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:15,661 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fba70> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:15,662 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a3213990> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:15,665 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a3213810> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:15,667 INFO Message received
2024-07-11 10:56:15,670 INFO {'type': 'file_dowloaded', 'file_name': '1-004.dcm'}
2024-07-11 10:56:15,673 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:15,675 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,676 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,677 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011879719986609416}
2024-07-11 10:56:15,681 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-004.dcm\", \"_id\": {\"$oid\": \"668fba4fd1e48f823be74285\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,685 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 3.8019999999999996, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,686 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:15,689 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:15,691 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,693 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,693 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008279590001620818}
2024-07-11 10:56:15,695 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba4fd1e48f823be74285\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,697 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.341, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba4fd1e48f823be74285\"}, \"file_name\": \"1-004.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:15,700 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:15,702 INFO Created new item on mongodb 
2024-07-11 10:56:15,703 INFO {'_id': ObjectId('668fba4fd1e48f823be74285'), 'file_name': '1-004.dcm', 'id': '668fba4fd1e48f823be74285'}
2024-07-11 10:56:15,739 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:16,066 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fb710> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:16,068 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a3227e90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:16,069 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a3213810> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:16,070 INFO Message received
2024-07-11 10:56:16,071 INFO {'type': 'file_dowloaded', 'file_name': '1-005.dcm'}
2024-07-11 10:56:16,072 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:16,073 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,074 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,076 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001260270000784658}
2024-07-11 10:56:16,077 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-005.dcm\", \"_id\": {\"$oid\": \"668fba50d1e48f823be74286\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,079 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.6029999999999998, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,080 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:16,082 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:16,083 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,084 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,085 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008154989991453476}
2024-07-11 10:56:16,086 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba50d1e48f823be74286\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,091 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 5.358, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba50d1e48f823be74286\"}, \"file_name\": \"1-005.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,093 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:16,095 INFO Created new item on mongodb 
2024-07-11 10:56:16,096 INFO {'_id': ObjectId('668fba50d1e48f823be74286'), 'file_name': '1-005.dcm', 'id': '668fba50d1e48f823be74286'}
2024-07-11 10:56:16,122 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:16,455 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fb470> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:16,456 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a32264d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:16,457 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a32270d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:16,459 INFO Message received
2024-07-11 10:56:16,460 INFO {'type': 'file_dowloaded', 'file_name': '1-006.dcm'}
2024-07-11 10:56:16,463 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:16,465 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,466 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,466 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007871520010667155}
2024-07-11 10:56:16,467 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-006.dcm\", \"_id\": {\"$oid\": \"668fba50d1e48f823be74287\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,469 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.0149999999999997, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,472 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:16,475 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:16,477 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,478 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,479 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001060431000951212}
2024-07-11 10:56:16,481 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba50d1e48f823be74287\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,483 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.301, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba50d1e48f823be74287\"}, \"file_name\": \"1-006.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,484 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:16,485 INFO Created new item on mongodb 
2024-07-11 10:56:16,486 INFO {'_id': ObjectId('668fba50d1e48f823be74287'), 'file_name': '1-006.dcm', 'id': '668fba50d1e48f823be74287'}
2024-07-11 10:56:16,520 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:16,842 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fb830> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:16,843 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a32270d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:16,844 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a52b7d10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:16,845 INFO Message received
2024-07-11 10:56:16,846 INFO {'type': 'file_dowloaded', 'file_name': '1-007.dcm'}
2024-07-11 10:56:16,850 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:16,851 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,852 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,853 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011750369994842913}
2024-07-11 10:56:16,854 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-007.dcm\", \"_id\": {\"$oid\": \"668fba50d1e48f823be74288\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,856 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.0660000000000003, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,858 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:16,862 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:16,864 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,865 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,868 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.002720142001635395}
2024-07-11 10:56:16,869 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba50d1e48f823be74288\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,871 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.5509999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba50d1e48f823be74288\"}, \"file_name\": \"1-007.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:16,874 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:16,876 INFO Created new item on mongodb 
2024-07-11 10:56:16,877 INFO {'_id': ObjectId('668fba50d1e48f823be74288'), 'file_name': '1-007.dcm', 'id': '668fba50d1e48f823be74288'}
2024-07-11 10:56:16,902 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:17,088 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fba70> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:17,089 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a3227950> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:17,090 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a52b7d10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:17,091 INFO Message received
2024-07-11 10:56:17,092 INFO {'type': 'file_dowloaded', 'file_name': '1-008.dcm'}
2024-07-11 10:56:17,093 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:17,094 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,096 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,097 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0014437170011660783}
2024-07-11 10:56:17,098 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-008.dcm\", \"_id\": {\"$oid\": \"668fba51d1e48f823be74289\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,101 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 3.128, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,103 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:17,105 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:17,106 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,107 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,108 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007720640005572932}
2024-07-11 10:56:17,109 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba51d1e48f823be74289\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,111 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.246, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba51d1e48f823be74289\"}, \"file_name\": \"1-008.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,113 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:17,116 INFO Created new item on mongodb 
2024-07-11 10:56:17,118 INFO {'_id': ObjectId('668fba51d1e48f823be74289'), 'file_name': '1-008.dcm', 'id': '668fba51d1e48f823be74289'}
2024-07-11 10:56:17,146 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:17,524 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fb710> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:17,526 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a3210e90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:17,529 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a52b7d10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:17,532 INFO Message received
2024-07-11 10:56:17,533 INFO {'type': 'file_dowloaded', 'file_name': '1-009.dcm'}
2024-07-11 10:56:17,534 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:17,535 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,537 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,539 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00284120599826565}
2024-07-11 10:56:17,542 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-009.dcm\", \"_id\": {\"$oid\": \"668fba51d1e48f823be7428a\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,544 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.505, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,547 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:17,550 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:17,551 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,552 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,553 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007858610006223898}
2024-07-11 10:56:17,555 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba51d1e48f823be7428a\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,558 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 3.265, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba51d1e48f823be7428a\"}, \"file_name\": \"1-009.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,561 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:17,563 INFO Created new item on mongodb 
2024-07-11 10:56:17,567 INFO {'_id': ObjectId('668fba51d1e48f823be7428a'), 'file_name': '1-009.dcm', 'id': '668fba51d1e48f823be7428a'}
2024-07-11 10:56:17,593 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:17,916 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fbf50> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:17,918 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a3227050> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:17,919 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a52b7d10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:17,921 INFO Message received
2024-07-11 10:56:17,922 INFO {'type': 'file_dowloaded', 'file_name': '1-010.dcm'}
2024-07-11 10:56:17,924 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:17,926 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,928 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,929 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0012324220006121323}
2024-07-11 10:56:17,930 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-010.dcm\", \"_id\": {\"$oid\": \"668fba51d1e48f823be7428b\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,936 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 5.523, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,937 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:17,939 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:17,945 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,947 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,948 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011025019994121976}
2024-07-11 10:56:17,949 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba51d1e48f823be7428b\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,952 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 3.076, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba51d1e48f823be7428b\"}, \"file_name\": \"1-010.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:17,954 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:17,956 INFO Created new item on mongodb 
2024-07-11 10:56:17,957 INFO {'_id': ObjectId('668fba51d1e48f823be7428b'), 'file_name': '1-010.dcm', 'id': '668fba51d1e48f823be7428b'}
2024-07-11 10:56:17,986 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:18,403 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fb830> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:18,405 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a3227a10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:18,406 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a52b7d10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:18,408 INFO Message received
2024-07-11 10:56:18,409 INFO {'type': 'file_dowloaded', 'file_name': '1-011.dcm'}
2024-07-11 10:56:18,410 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:18,412 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,416 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,417 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0015515739996772027}
2024-07-11 10:56:18,419 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-011.dcm\", \"_id\": {\"$oid\": \"668fba52d1e48f823be7428c\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,422 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.741, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,424 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:18,428 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:18,432 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,434 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,435 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011909519998880569}
2024-07-11 10:56:18,436 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba52d1e48f823be7428c\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,440 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 3.4160000000000004, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba52d1e48f823be7428c\"}, \"file_name\": \"1-011.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,444 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:18,446 INFO Created new item on mongodb 
2024-07-11 10:56:18,448 INFO {'_id': ObjectId('668fba52d1e48f823be7428c'), 'file_name': '1-011.dcm', 'id': '668fba52d1e48f823be7428c'}
2024-07-11 10:56:18,481 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:18,804 DEBUG Received frame <Basic.Deliver object at 0x7f68a31fbe90> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:18,805 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f68a32271d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:18,807 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f68a52b7d10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:56:18,809 INFO Message received
2024-07-11 10:56:18,811 INFO {'type': 'file_dowloaded', 'file_name': '1-012.dcm'}
2024-07-11 10:56:18,813 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:18,815 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f68a4a11260>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,817 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,818 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001741042000503512}
2024-07-11 10:56:18,821 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"file_name\": \"1-012.dcm\", \"_id\": {\"$oid\": \"668fba52d1e48f823be7428d\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,823 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 2.675, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,825 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:18,829 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}}
2024-07-11 10:56:18,830 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 668fba45d1e48f823be74281, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.001468702999773086>]>", "clientId": {"$oid": "668fba45d1e48f823be74281"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,831 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,834 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0028213229998073075}
2024-07-11 10:56:18,837 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"668fba52d1e48f823be7428d\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"njvE2cx5SUuxuj45ETk8rA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,843 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Command succeeded", "durationMS": 7.3740000000000006, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"668fba52d1e48f823be7428d\"}, \"file_name\": \"1-012.dcm\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 1, "serverConnectionId": 5, "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:56:18,845 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-11 10:56:18,851 INFO Created new item on mongodb 
2024-07-11 10:56:18,852 INFO {'_id': ObjectId('668fba52d1e48f823be7428d'), 'file_name': '1-012.dcm', 'id': '668fba52d1e48f823be7428d'}
2024-07-11 10:56:18,869 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-11 10:56:35,529 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:56:35,645 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f68a3227c90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:57:05,425 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:57:05,666 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f68a57a6cd0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:57:30,381 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-11 10:57:30,384 DEBUG {"clientId": {"$oid": "668fba45d1e48f823be74281"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "reason": "Connection pool was stale", "error": "stale"}
2024-07-11 10:57:35,323 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:57:35,675 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f68a53d0890> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f68a52727b0>
2024-07-11 10:58:14,303 INFO Starting consumer...
2024-07-11 10:58:14,303 DEBUG Using selector: EpollSelector
2024-07-11 10:58:14,305 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:58:14,305 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:58:14,306 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:58:14,307 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 10:58:14,315 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:58:14,316 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 10:58:14,317 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f497b799110>
2024-07-11 10:58:14,319 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 10:58:14,321 DEBUG Received frame <Channel.OpenOk object at 0x7f4979649690> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 10:58:14,322 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:58:14,324 DEBUG Received frame <Confirm.SelectOk object at 0x7f497964a8d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 10:58:14,326 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:58:14,327 DEBUG Received frame <Basic.QosOk object at 0x7f497964a810> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 10:58:14,329 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:58:14,331 DEBUG Received frame <Basic.QosOk object at 0x7f497964b190> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 10:58:14,333 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 10:58:14,334 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:58:14,341 DEBUG Received frame <Queue.DeclareOk object at 0x7f49796573e0> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 10:58:14,342 INFO Consumer successfully started!
2024-07-11 10:58:14,343 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 10:58:14,344 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.c5fa24f80ea14b92b393b13c6e764057\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:58:14,347 DEBUG Received frame <Basic.ConsumeOk object at 0x7f497963ac90> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 10:58:19,193 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 10:58:44,211 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:58:44,316 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f497b7b8fd0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 10:59:14,130 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:59:14,317 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f497bdab010> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 10:59:44,037 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 10:59:44,318 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f497963b4d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 11:00:13,945 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:00:14,319 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f497963ba10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 11:00:43,855 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:00:44,320 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f497b7b8fd0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 11:01:13,777 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:01:14,322 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f497963ba10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 11:01:43,677 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:01:44,323 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f497963b4d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 11:02:13,588 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:02:14,323 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f497bdab010> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 11:02:43,502 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:02:44,324 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f497963b4d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 11:03:13,417 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:03:14,325 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f497963ba10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f4979645e00>
2024-07-11 11:07:35,347 INFO Starting consumer...
2024-07-11 11:07:35,347 DEBUG Using selector: EpollSelector
2024-07-11 11:07:35,349 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 11:07:35,350 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 11:07:35,350 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 11:07:35,351 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-11 11:07:35,360 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 11:07:35,361 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-11 11:07:35,362 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f48b1c15110>
2024-07-11 11:07:35,364 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-11 11:07:35,367 DEBUG Received frame <Channel.OpenOk object at 0x7f48b1ba4190> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:07:35,369 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:07:35,371 DEBUG Received frame <Confirm.SelectOk object at 0x7f48afab5f10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:07:35,373 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:07:35,374 DEBUG Received frame <Basic.QosOk object at 0x7f48afac5750> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:07:35,376 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:07:35,377 DEBUG Received frame <Basic.QosOk object at 0x7f48afac5790> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:07:35,378 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 11:07:35,379 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:07:35,386 DEBUG Received frame <Queue.DeclareOk object at 0x7f48afad3020> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:07:35,387 INFO Consumer successfully started!
2024-07-11 11:07:35,388 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-11 11:07:35,389 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.4137560cd5cc4e398839ed49cf166043\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:07:35,391 DEBUG Received frame <Basic.ConsumeOk object at 0x7f48afac68d0> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:07:40,368 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-11 11:08:05,290 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:08:05,393 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:08:35,208 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:08:35,394 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:09:05,140 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:09:05,396 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:09:35,054 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:09:35,397 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:10:04,975 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:10:05,398 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:10:34,903 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:10:35,400 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:11:04,845 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:11:05,401 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:11:34,760 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:11:35,401 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:12:04,684 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:12:05,402 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:12:34,624 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:12:35,404 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:13:04,554 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:13:05,404 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:13:34,494 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:13:35,382 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:14:04,417 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:14:05,407 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:14:34,362 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:14:35,410 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:15:04,283 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:15:05,412 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:15:34,225 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:15:35,413 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:16:04,163 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:16:05,414 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:16:34,112 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:16:35,416 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:17:04,057 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:17:05,417 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:17:34,004 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:17:35,418 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:18:03,952 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:18:05,419 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:18:33,896 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:18:35,422 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:19:03,845 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:19:05,422 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:19:33,799 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:19:35,424 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:20:03,748 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:20:05,426 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:20:33,687 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:20:35,428 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:21:03,632 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:21:05,430 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:21:33,578 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:21:35,432 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:22:03,531 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:22:05,433 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:22:33,483 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:22:35,434 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:23:03,434 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:23:05,436 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:23:33,396 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:23:35,437 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:24:03,350 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:24:05,439 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:24:33,305 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:24:35,439 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:25:03,263 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:25:05,441 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:25:33,221 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:25:35,442 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:26:03,174 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:26:05,443 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:26:33,119 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:26:35,444 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:27:03,056 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:27:05,446 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:27:33,010 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:27:35,448 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:28:02,972 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:28:05,449 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:28:32,915 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:28:35,451 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:29:02,874 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:29:05,453 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:29:32,826 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:29:35,455 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:30:02,781 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:30:05,456 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:30:32,726 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:30:35,458 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:31:02,686 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:31:05,459 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:31:32,621 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:31:35,460 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:32:02,546 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:32:05,460 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:32:32,507 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:32:35,463 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:33:02,463 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:33:05,464 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:33:32,409 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:33:35,465 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:34:02,354 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:34:05,466 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:34:32,315 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:34:35,466 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:35:02,260 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:35:05,467 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:35:32,208 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:35:35,469 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:36:02,134 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:36:05,471 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:36:32,091 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:36:35,471 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:37:02,039 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:37:05,473 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:37:31,983 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:37:35,473 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:38:01,792 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:38:05,389 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:38:31,758 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:38:35,476 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:39:01,719 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:39:05,476 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:39:31,675 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:39:35,477 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:40:01,632 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:40:05,478 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:40:31,578 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:40:35,479 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:41:01,532 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:41:05,480 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:41:31,477 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:41:35,481 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:42:01,440 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:42:05,483 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:42:31,379 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:42:35,485 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:43:01,290 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:43:05,485 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:43:31,223 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:43:35,487 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:44:01,166 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:44:05,488 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:44:31,105 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:44:35,490 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:45:01,024 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:45:05,491 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:45:30,968 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:45:35,493 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:46:00,913 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:46:05,495 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:46:30,844 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:46:35,497 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:47:00,769 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:47:05,499 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:47:30,696 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:47:35,499 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:48:00,646 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:48:05,501 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:48:30,590 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:48:35,501 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:49:00,533 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:49:05,502 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:49:30,454 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:49:35,503 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:50:00,344 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:50:05,505 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:50:30,262 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:50:35,505 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:51:00,202 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:51:05,506 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:51:30,143 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:51:35,507 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:52:00,057 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:52:05,509 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:52:29,992 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:52:35,510 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:52:59,922 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:53:05,512 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:53:29,867 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:53:35,514 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:53:59,806 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:54:05,515 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:54:29,735 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:54:35,516 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:54:59,679 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:55:05,518 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:55:29,586 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:55:35,519 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:55:59,524 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:56:05,519 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:56:29,452 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:56:35,521 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:56:59,377 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:57:05,523 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:57:29,312 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:57:35,524 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:57:59,247 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:58:05,526 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:58:29,178 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:58:35,528 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:58:59,097 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:59:05,530 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:59:29,009 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 11:59:35,531 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 11:59:58,943 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:00:05,533 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:00:28,866 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:00:35,442 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:00:58,777 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:01:05,408 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:01:28,679 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:01:35,445 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:01:58,617 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:02:05,448 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:02:28,556 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:02:35,437 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:02:58,461 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:03:05,443 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:03:28,391 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:03:35,447 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:03:58,319 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:04:05,451 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:04:28,254 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:04:35,446 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:04:58,187 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:05:05,426 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:05:28,097 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:05:35,459 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:05:58,032 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:06:05,446 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:06:27,959 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:06:35,434 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:06:57,873 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:07:05,452 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:07:27,804 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:07:35,454 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:07:57,735 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:08:05,446 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:08:27,657 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:08:35,451 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:08:57,564 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:09:05,457 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:09:27,489 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:09:35,432 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:09:57,396 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:10:05,436 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:10:27,305 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:10:35,463 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:10:57,238 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:11:05,453 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:11:27,162 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:11:35,433 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:11:57,063 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:12:05,427 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:12:26,957 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:12:35,453 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:12:56,870 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:13:05,453 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:13:26,783 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:13:35,445 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:13:56,692 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:14:05,454 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:14:26,600 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:14:35,451 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:14:56,504 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:15:05,447 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:15:26,415 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:15:35,439 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:15:56,296 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:16:05,470 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:16:26,212 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:16:35,458 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:16:56,130 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:17:05,453 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:17:26,040 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:17:35,447 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:17:55,923 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:18:05,462 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:18:25,839 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:18:35,493 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:18:55,755 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:19:05,456 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:19:25,664 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:19:35,466 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:19:55,581 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:20:05,465 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:20:25,497 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:20:35,451 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:20:55,372 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:21:05,490 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:21:25,284 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:21:35,463 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:21:55,194 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:22:05,467 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:22:25,109 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:22:35,444 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:22:55,000 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:23:05,469 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:23:24,916 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:23:35,494 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:23:54,831 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:24:05,442 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:24:24,199 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:24:35,246 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:24:54,338 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:25:05,435 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:25:24,252 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:25:35,481 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:25:54,171 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:26:05,520 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:26:24,077 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:26:35,468 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:26:53,981 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:27:05,473 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:27:23,887 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:27:35,475 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:27:53,778 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:28:05,480 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:28:23,674 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:28:35,519 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:28:53,044 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:29:05,238 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:29:23,187 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:29:35,433 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:29:53,108 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:30:05,489 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:30:23,023 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:30:35,512 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:30:52,932 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:31:05,535 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:31:22,832 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:31:35,459 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:31:52,714 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:32:05,493 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:32:22,629 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:32:35,483 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:32:52,529 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:33:05,480 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:33:22,419 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:33:35,520 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:33:52,333 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:34:05,509 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:34:21,631 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:34:35,356 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:34:51,769 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:35:05,502 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:35:21,642 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:35:35,530 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:35:51,547 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:36:05,543 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:36:21,426 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:36:35,526 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48b1d57e90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:36:51,283 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-11 12:37:05,548 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f48afab66d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f48afac1a90>
2024-07-11 12:37:21,181 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:32:44,210 INFO Starting consumer...
2024-07-12 14:32:44,212 DEBUG Using selector: EpollSelector
2024-07-12 14:32:44,213 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:44,214 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:44,215 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:44,216 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 14:32:44,236 INFO Connection to amqp://user:******@rabbit:5672/ closed. Reconnecting after 5 seconds.
2024-07-12 14:32:47,959 INFO Starting consumer...
2024-07-12 14:32:47,960 DEBUG Using selector: EpollSelector
2024-07-12 14:32:47,961 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:47,962 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:47,963 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:47,964 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 14:32:47,968 INFO Connection to amqp://user:******@rabbit:5672/ closed. Reconnecting after 5 seconds.
2024-07-12 14:32:51,120 INFO Starting consumer...
2024-07-12 14:32:51,120 DEBUG Using selector: EpollSelector
2024-07-12 14:32:51,122 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:51,123 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:51,123 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:51,124 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 14:32:51,128 INFO Connection to amqp://user:******@rabbit:5672/ closed. Reconnecting after 5 seconds.
2024-07-12 14:32:54,204 INFO Starting consumer...
2024-07-12 14:32:54,204 DEBUG Using selector: EpollSelector
2024-07-12 14:32:54,205 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:54,206 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:54,206 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:54,207 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 14:32:54,210 INFO Connection to amqp://user:******@rabbit:5672/ closed. Reconnecting after 5 seconds.
2024-07-12 14:32:58,726 INFO Starting consumer...
2024-07-12 14:32:58,726 DEBUG Using selector: EpollSelector
2024-07-12 14:32:58,728 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:58,729 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:58,730 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:32:58,731 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 14:32:58,735 INFO Connection to amqp://user:******@rabbit:5672/ closed. Reconnecting after 5 seconds.
2024-07-12 14:33:03,775 INFO Starting consumer...
2024-07-12 14:33:03,776 DEBUG Using selector: EpollSelector
2024-07-12 14:33:03,777 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:33:03,778 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:33:03,779 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:33:03,780 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 14:33:03,789 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:33:03,790 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:33:03,791 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7ffa6a42b450>
2024-07-12 14:33:03,793 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 14:33:03,796 DEBUG Received frame <Channel.OpenOk object at 0x7ffa6d30b050> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:33:03,797 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:33:03,798 DEBUG Received frame <Confirm.SelectOk object at 0x7ffa6d25de50> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:33:03,799 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:33:03,800 DEBUG Received frame <Basic.QosOk object at 0x7ffa6a438c90> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:33:03,801 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:33:03,802 DEBUG Received frame <Basic.QosOk object at 0x7ffa6a429d10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:33:03,803 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 14:33:03,804 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:33:03,812 DEBUG Received frame <Queue.DeclareOk object at 0x7ffa6a447110> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:33:03,813 INFO Consumer successfully started!
2024-07-12 14:33:03,813 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 14:33:03,814 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.6661f6bab39347f7a1bec8f9fe56ae70\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:33:03,816 DEBUG Received frame <Basic.ConsumeOk object at 0x7ffa6a8b3010> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:33:08,796 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 14:33:33,766 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a5d3850> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:33:33,769 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:34:03,808 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6d25de50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:34:03,809 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:34:34,322 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:34:34,323 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a8b3150> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:35:07,058 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a5d3850> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:35:07,059 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:35:39,779 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6d25de50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:35:39,780 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:36:12,514 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a8b3150> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:36:12,515 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:36:45,245 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a5d3850> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:36:45,248 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:37:16,292 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6d25de50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:37:16,294 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:37:47,161 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a8b3150> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:37:47,162 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:38:19,888 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a5d3850> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:38:19,889 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:37:41,227 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6d25de50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:37:41,229 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:39:22,659 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:39:22,902 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a8b3150> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:39:54,940 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a5d3850> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:39:54,962 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:40:25,597 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6d25de50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:40:25,619 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:40:56,068 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a8b3150> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:40:56,088 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:41:28,776 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a5d3850> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:41:28,794 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:42:01,535 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6d25de50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:42:01,550 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:42:34,266 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a8b3150> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:42:34,279 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:43:06,989 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a5d3850> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:43:07,000 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:43:37,997 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6d25de50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:43:38,006 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:44:08,805 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a8b3150> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:44:08,813 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:44:41,544 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6a5d3850> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:44:41,550 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:45:14,239 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ffa6d25de50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ffa6a435bd0>
2024-07-12 14:45:14,269 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:49:17,094 INFO Starting consumer...
2024-07-12 14:49:17,095 DEBUG Using selector: EpollSelector
2024-07-12 14:49:17,096 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:49:17,097 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:49:17,097 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:49:17,099 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 14:49:17,106 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:49:17,107 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:49:17,108 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f84b08a4790>
2024-07-12 14:49:17,109 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 14:49:17,111 DEBUG Received frame <Channel.OpenOk object at 0x7f84b0232390> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f84b023db30>
2024-07-12 14:49:17,112 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:49:17,113 DEBUG Received frame <Confirm.SelectOk object at 0x7f84b05b4a90> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f84b023db30>
2024-07-12 14:49:17,114 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:49:17,115 DEBUG Received frame <Basic.QosOk object at 0x7f84b0241910> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f84b023db30>
2024-07-12 14:49:17,116 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:49:17,117 DEBUG Received frame <Basic.QosOk object at 0x7f84b0242110> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f84b023db30>
2024-07-12 14:49:17,118 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 14:49:17,119 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:49:17,124 DEBUG Received frame <Queue.DeclareOk object at 0x7f84b024f160> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f84b023db30>
2024-07-12 14:49:17,125 INFO Consumer successfully started!
2024-07-12 14:49:17,125 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 14:49:17,126 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.ea1ba8a4cc9b44fb8c43f73d32e6f16d\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:49:17,128 DEBUG Received frame <Basic.ConsumeOk object at 0x7f84b25b8310> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f84b023db30>
2024-07-12 14:49:22,112 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 14:50:11,821 INFO Starting consumer...
2024-07-12 14:50:11,822 DEBUG Using selector: EpollSelector
2024-07-12 14:50:11,823 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:50:11,824 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:50:11,825 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:50:11,826 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 14:50:11,833 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:50:11,834 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:50:11,835 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7fc195c97d90>
2024-07-12 14:50:11,836 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 14:50:11,838 DEBUG Received frame <Channel.OpenOk object at 0x7fc194ef3890> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:11,839 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:50:11,841 DEBUG Received frame <Confirm.SelectOk object at 0x7fc194f00a50> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:11,842 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:50:11,843 DEBUG Received frame <Basic.QosOk object at 0x7fc194f01d90> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:11,844 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:50:11,845 DEBUG Received frame <Basic.QosOk object at 0x7fc194f025d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:11,847 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 14:50:11,848 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:50:11,855 DEBUG Received frame <Queue.DeclareOk object at 0x7fc194f0f160> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:11,856 INFO Consumer successfully started!
2024-07-12 14:50:11,857 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 14:50:11,857 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.af76d854cba546e38c7ef2818cade199\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:50:11,859 DEBUG Received frame <Basic.ConsumeOk object at 0x7fc194f02e90> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:16,839 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 14:50:42,268 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc1970376d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:42,559 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:50:54,705 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7890> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:54,707 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc194f02fd0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:54,708 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:54,710 INFO Message received
2024-07-12 14:50:54,711 INFO {'type': 'file_dowloaded', 'file_name': '1-001.dcm'}
2024-07-12 14:50:54,712 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:50:54,714 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:54,723 ERROR Task exception was never retrieved
future: <Task finished name='Task-15' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:55,321 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7a10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:55,322 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc194f02e90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:55,323 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:55,324 INFO Message received
2024-07-12 14:50:55,326 INFO {'type': 'file_dowloaded', 'file_name': '1-002.dcm'}
2024-07-12 14:50:55,327 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:50:55,328 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:55,334 ERROR Task exception was never retrieved
future: <Task finished name='Task-17' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:55,887 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:55,888 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc194f03690> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:55,889 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:55,891 INFO Message received
2024-07-12 14:50:55,892 INFO {'type': 'file_dowloaded', 'file_name': '1-003.dcm'}
2024-07-12 14:50:55,894 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:50:55,896 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:55,903 ERROR Task exception was never retrieved
future: <Task finished name='Task-19' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:56,453 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7770> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:56,454 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc194f03510> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:56,457 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:56,459 INFO Message received
2024-07-12 14:50:56,459 INFO {'type': 'file_dowloaded', 'file_name': '1-004.dcm'}
2024-07-12 14:50:56,460 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:50:56,462 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:56,466 ERROR Task exception was never retrieved
future: <Task finished name='Task-21' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:56,948 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7890> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:56,949 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc194f25650> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:56,950 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:56,951 INFO Message received
2024-07-12 14:50:56,954 INFO {'type': 'file_dowloaded', 'file_name': '1-005.dcm'}
2024-07-12 14:50:56,955 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:50:56,956 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:56,961 ERROR Task exception was never retrieved
future: <Task finished name='Task-23' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:57,486 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7a10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:57,487 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc194f254d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:57,488 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:57,492 INFO Message received
2024-07-12 14:50:57,493 INFO {'type': 'file_dowloaded', 'file_name': '1-006.dcm'}
2024-07-12 14:50:57,496 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:50:57,498 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:57,503 ERROR Task exception was never retrieved
future: <Task finished name='Task-25' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:58,125 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:58,126 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc197543690> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:58,128 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:58,130 INFO Message received
2024-07-12 14:50:58,131 INFO {'type': 'file_dowloaded', 'file_name': '1-007.dcm'}
2024-07-12 14:50:58,133 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:50:58,136 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:58,143 ERROR Task exception was never retrieved
future: <Task finished name='Task-27' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:58,705 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7770> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:58,711 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc194f25d10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:58,714 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:58,716 INFO Message received
2024-07-12 14:50:58,717 INFO {'type': 'file_dowloaded', 'file_name': '1-008.dcm'}
2024-07-12 14:50:58,718 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:50:58,720 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:58,727 ERROR Task exception was never retrieved
future: <Task finished name='Task-29' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:59,355 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7890> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:59,356 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc194ef3510> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:59,357 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:59,363 INFO Message received
2024-07-12 14:50:59,364 INFO {'type': 'file_dowloaded', 'file_name': '1-009.dcm'}
2024-07-12 14:50:59,367 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:50:59,369 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:59,377 ERROR Task exception was never retrieved
future: <Task finished name='Task-31' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:50:59,996 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7a10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:50:59,999 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc1955ab8d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:51:00,001 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:51:00,004 INFO Message received
2024-07-12 14:51:00,005 INFO {'type': 'file_dowloaded', 'file_name': '1-010.dcm'}
2024-07-12 14:51:00,005 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:51:00,007 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:51:00,018 ERROR Task exception was never retrieved
future: <Task finished name='Task-33' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:51:00,605 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:51:00,606 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc194f267d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:51:00,607 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:51:00,609 INFO Message received
2024-07-12 14:51:00,609 INFO {'type': 'file_dowloaded', 'file_name': '1-011.dcm'}
2024-07-12 14:51:00,610 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:51:00,612 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:51:00,617 ERROR Task exception was never retrieved
future: <Task finished name='Task-35' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:51:01,173 DEBUG Received frame <Basic.Deliver object at 0x7fc194ee7770> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:51:01,175 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc194f26550> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:51:01,176 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc1970376d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:51:01,177 INFO Message received
2024-07-12 14:51:01,178 INFO {'type': 'file_dowloaded', 'file_name': '1-012.dcm'}
2024-07-12 14:51:01,179 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:51:01,181 ERROR Exception in callback _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ibute 'get'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:51:01,186 ERROR Task exception was never retrieved
future: <Task finished name='Task-37' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'IncomingMessage' object has no attribute 'get'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 30, in message_router
    file_name = message.get("file_name")
                ^^^^^^^^^^^
AttributeError: 'IncomingMessage' object has no attribute 'get'
2024-07-12 14:51:13,178 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:51:43,419 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc19690a6d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:51:44,295 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:52:15,838 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc194ef2b50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:52:17,008 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:52:46,334 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc194f02310> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:52:47,797 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:53:18,772 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc1970376d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc194efdbd0>
2024-07-12 14:53:20,528 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:54:04,916 INFO Starting consumer...
2024-07-12 14:54:04,916 DEBUG Using selector: EpollSelector
2024-07-12 14:54:04,917 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:54:04,918 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:54:04,918 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:54:04,919 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 14:54:04,926 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:54:04,927 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:54:04,928 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7fac7cb1b7d0>
2024-07-12 14:54:04,930 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 14:54:04,933 DEBUG Received frame <Channel.OpenOk object at 0x7fac7a97dd90> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:04,934 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:54:04,935 DEBUG Received frame <Confirm.SelectOk object at 0x7fac7a98d6d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:04,937 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:54:04,938 DEBUG Received frame <Basic.QosOk object at 0x7fac7a98de10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:04,940 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:54:04,942 DEBUG Received frame <Basic.QosOk object at 0x7fac7a98dfd0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:04,943 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 14:54:04,945 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:54:04,951 DEBUG Received frame <Queue.DeclareOk object at 0x7fac7a99b0c0> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:04,952 INFO Consumer successfully started!
2024-07-12 14:54:04,952 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 14:54:04,954 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.67ef654a1fd74655a705b8a9e64c7510\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:54:04,955 DEBUG Received frame <Basic.ConsumeOk object at 0x7fac7cace110> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:09,931 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 14:54:33,591 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:33,592 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a98e8d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:33,594 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7a98eb50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:33,595 INFO Message received
2024-07-12 14:54:33,597 INFO {'type': 'file_dowloaded', 'file_name': '1-001.dcm'}
2024-07-12 14:54:33,629 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:33,631 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:33,637 ERROR Task exception was never retrieved
future: <Task finished name='Task-14' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:34,472 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973a70> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:34,474 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a9a0950> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:34,475 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7a9a3f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:34,476 INFO Message received
2024-07-12 14:54:34,477 INFO {'type': 'file_dowloaded', 'file_name': '1-002.dcm'}
2024-07-12 14:54:34,500 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:34,501 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:34,507 ERROR Task exception was never retrieved
future: <Task finished name='Task-16' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:35,274 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:35,276 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a98ebd0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:35,277 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7c186c50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:35,279 INFO Message received
2024-07-12 14:54:35,280 INFO {'type': 'file_dowloaded', 'file_name': '1-003.dcm'}
2024-07-12 14:54:35,306 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:35,307 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:35,312 ERROR Task exception was never retrieved
future: <Task finished name='Task-18' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:35,575 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fac7caa9ed0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:35,865 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:54:35,976 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973d10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:35,977 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a9af350> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:35,978 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7caa9ed0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:35,980 INFO Message received
2024-07-12 14:54:35,981 INFO {'type': 'file_dowloaded', 'file_name': '1-004.dcm'}
2024-07-12 14:54:36,005 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:36,007 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:36,012 ERROR Task exception was never retrieved
future: <Task finished name='Task-21' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:36,736 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:36,737 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a98f010> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:36,738 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7caa9ed0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:36,740 INFO Message received
2024-07-12 14:54:36,740 INFO {'type': 'file_dowloaded', 'file_name': '1-005.dcm'}
2024-07-12 14:54:36,774 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:36,777 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:36,853 ERROR Task exception was never retrieved
future: <Task finished name='Task-23' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:37,798 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973d10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:37,799 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a9aec90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:37,800 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7caa9ed0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:37,801 INFO Message received
2024-07-12 14:54:37,802 INFO {'type': 'file_dowloaded', 'file_name': '1-006.dcm'}
2024-07-12 14:54:37,837 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:37,839 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:37,844 ERROR Task exception was never retrieved
future: <Task finished name='Task-25' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:38,387 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:38,388 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a98ebd0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:38,388 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7caa9ed0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:38,390 INFO Message received
2024-07-12 14:54:38,390 INFO {'type': 'file_dowloaded', 'file_name': '1-007.dcm'}
2024-07-12 14:54:38,415 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:38,416 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:38,421 ERROR Task exception was never retrieved
future: <Task finished name='Task-27' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:38,987 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973d10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:38,988 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a9acd10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:38,989 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7caa9ed0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:38,990 INFO Message received
2024-07-12 14:54:38,991 INFO {'type': 'file_dowloaded', 'file_name': '1-008.dcm'}
2024-07-12 14:54:39,014 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:39,015 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:39,019 ERROR Task exception was never retrieved
future: <Task finished name='Task-29' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:39,874 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:39,875 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a9a1910> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:39,876 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7caa9ed0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:39,877 INFO Message received
2024-07-12 14:54:39,878 INFO {'type': 'file_dowloaded', 'file_name': '1-009.dcm'}
2024-07-12 14:54:39,935 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:39,956 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:39,971 ERROR Task exception was never retrieved
future: <Task finished name='Task-31' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:40,530 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973d10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:40,531 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a98f010> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:40,532 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7caa9ed0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:40,533 INFO Message received
2024-07-12 14:54:40,533 INFO {'type': 'file_dowloaded', 'file_name': '1-010.dcm'}
2024-07-12 14:54:40,560 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:40,561 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:40,570 ERROR Task exception was never retrieved
future: <Task finished name='Task-33' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:41,314 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:41,315 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a9a12d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:41,316 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7caa9ed0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:41,317 INFO Message received
2024-07-12 14:54:41,318 INFO {'type': 'file_dowloaded', 'file_name': '1-011.dcm'}
2024-07-12 14:54:41,351 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:41,353 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:41,356 ERROR Task exception was never retrieved
future: <Task finished name='Task-35' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:41,850 DEBUG Received frame <Basic.Deliver object at 0x7fac7a973d10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:41,851 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fac7a9ad890> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:41,852 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fac7caa9ed0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:54:41,853 INFO Message received
2024-07-12 14:54:41,854 INFO {'type': 'file_dowloaded', 'file_name': '1-012.dcm'}
2024-07-12 14:54:41,870 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:54:41,871 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:54:41,875 ERROR Task exception was never retrieved
future: <Task finished name='Task-37' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:55:08,600 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:55:40,446 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fac7a9a2f50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fac7a989b30>
2024-07-12 14:56:44,386 INFO Starting consumer...
2024-07-12 14:56:44,387 DEBUG Using selector: EpollSelector
2024-07-12 14:56:44,388 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:56:44,389 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:56:44,389 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:56:44,390 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 14:56:44,397 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:56:44,397 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 14:56:44,398 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7fe9b92cb610>
2024-07-12 14:56:44,399 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 14:56:44,402 DEBUG Received frame <Channel.OpenOk object at 0x7fe9bb3dbe50> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:56:44,403 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:56:44,404 DEBUG Received frame <Confirm.SelectOk object at 0x7fe9b92d9d90> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:56:44,405 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:56:44,406 DEBUG Received frame <Basic.QosOk object at 0x7fe9b92d9dd0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:56:44,407 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:56:44,408 DEBUG Received frame <Basic.QosOk object at 0x7fe9b92da610> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:56:44,409 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 14:56:44,411 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:56:44,417 DEBUG Received frame <Queue.DeclareOk object at 0x7fe9b92e5db0> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:56:44,417 INFO Consumer successfully started!
2024-07-12 14:56:44,418 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 14:56:44,419 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.592e87763c68401da23c6664a0aac646\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:56:44,421 DEBUG Received frame <Basic.ConsumeOk object at 0x7fe9b92daed0> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:56:49,400 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 14:57:10,325 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bf8f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:10,327 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b92db090> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:10,328 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9b92db210> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:10,330 INFO Message received
2024-07-12 14:57:10,331 INFO {'type': 'file_dowloaded', 'file_name': '1-001.dcm'}
2024-07-12 14:57:10,365 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:10,367 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:10,374 ERROR Task exception was never retrieved
future: <Task finished name='Task-14' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:10,870 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bfa10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:10,871 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b92effd0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:10,872 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9b92efe50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:10,874 INFO Message received
2024-07-12 14:57:10,874 INFO {'type': 'file_dowloaded', 'file_name': '1-002.dcm'}
2024-07-12 14:57:10,900 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:10,902 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:10,906 ERROR Task exception was never retrieved
future: <Task finished name='Task-16' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:11,411 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bf8f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:11,412 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9bba80910> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:11,414 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9bb402cd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:11,416 INFO Message received
2024-07-12 14:57:11,417 INFO {'type': 'file_dowloaded', 'file_name': '1-003.dcm'}
2024-07-12 14:57:11,442 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:11,445 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:11,451 ERROR Task exception was never retrieved
future: <Task finished name='Task-18' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:12,081 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bfa10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:12,081 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b92fb790> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:12,082 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9bb402cd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:12,084 INFO Message received
2024-07-12 14:57:12,084 INFO {'type': 'file_dowloaded', 'file_name': '1-004.dcm'}
2024-07-12 14:57:12,109 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:12,110 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:12,115 ERROR Task exception was never retrieved
future: <Task finished name='Task-20' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:12,641 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bf8f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:12,642 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b92d9f50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:12,643 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9bb402cd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:12,644 INFO Message received
2024-07-12 14:57:12,645 INFO {'type': 'file_dowloaded', 'file_name': '1-005.dcm'}
2024-07-12 14:57:12,670 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:12,671 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:12,675 ERROR Task exception was never retrieved
future: <Task finished name='Task-22' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:13,198 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bfa10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:13,199 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b92fb010> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:13,200 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9bb402cd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:13,202 INFO Message received
2024-07-12 14:57:13,204 INFO {'type': 'file_dowloaded', 'file_name': '1-006.dcm'}
2024-07-12 14:57:13,233 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:13,235 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:13,241 ERROR Task exception was never retrieved
future: <Task finished name='Task-24' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:13,733 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bf8f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:13,734 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b92db7d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:13,735 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9bb402cd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:13,737 INFO Message received
2024-07-12 14:57:13,738 INFO {'type': 'file_dowloaded', 'file_name': '1-007.dcm'}
2024-07-12 14:57:13,774 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:13,776 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:13,779 ERROR Task exception was never retrieved
future: <Task finished name='Task-26' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:14,264 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bfa10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:14,265 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b92fa750> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:14,266 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9bb402cd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:14,267 INFO Message received
2024-07-12 14:57:14,268 INFO {'type': 'file_dowloaded', 'file_name': '1-008.dcm'}
2024-07-12 14:57:14,294 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:14,296 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:14,305 ERROR Task exception was never retrieved
future: <Task finished name='Task-28' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:14,794 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bf8f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:14,795 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b92da890> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:14,797 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9bb402cd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:14,799 INFO Message received
2024-07-12 14:57:14,799 INFO {'type': 'file_dowloaded', 'file_name': '1-009.dcm'}
2024-07-12 14:57:14,833 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:14,835 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:14,840 ERROR Task exception was never retrieved
future: <Task finished name='Task-30' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:15,343 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bfa10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:15,344 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b92f9d50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:15,345 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9bb402cd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:15,347 INFO Message received
2024-07-12 14:57:15,347 INFO {'type': 'file_dowloaded', 'file_name': '1-010.dcm'}
2024-07-12 14:57:15,374 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:15,377 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:15,382 ERROR Task exception was never retrieved
future: <Task finished name='Task-32' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:15,994 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bf8f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:15,995 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b9347fd0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:15,996 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9bb402cd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:15,997 INFO Message received
2024-07-12 14:57:15,997 INFO {'type': 'file_dowloaded', 'file_name': '1-011.dcm'}
2024-07-12 14:57:16,028 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:16,029 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:16,036 ERROR Task exception was never retrieved
future: <Task finished name='Task-34' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:16,608 DEBUG Received frame <Basic.Deliver object at 0x7fe9b92bfa10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:16,609 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fe9b92f9510> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:16,610 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fe9bb402cd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:16,612 INFO Message received
2024-07-12 14:57:16,612 INFO {'type': 'file_dowloaded', 'file_name': '1-012.dcm'}
2024-07-12 14:57:16,632 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 14:57:16,634 ERROR Exception in callback _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ySeriesUID'")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:16,638 ERROR Task exception was never retrieved
future: <Task finished name='Task-36' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=AttributeError("'FileDataset' object has no attribute 'StudySeriesUID'")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 51, in message_router
    "StudySeriesUID":dicom.StudySeriesUID,
                     ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydicom/dataset.py", line 908, in __getattr__
    return object.__getattribute__(self, name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'FileDataset' object has no attribute 'StudySeriesUID'
2024-07-12 14:57:16,836 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe9b9ef0c90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:17,128 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:57:47,094 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe9bb402cd0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:57:47,677 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:58:17,885 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe9b9ef0c90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:58:18,759 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:58:50,332 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe9bb402cd0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:58:51,499 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 14:59:22,760 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fe9b9ef0c90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fe9b92d5900>
2024-07-12 14:59:24,217 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:02:23,771 INFO Starting consumer...
2024-07-12 15:02:23,771 DEBUG Using selector: EpollSelector
2024-07-12 15:02:23,772 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:02:23,773 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:02:23,774 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:02:23,775 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 15:02:23,781 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:02:23,782 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:02:23,782 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7fc9323e7f50>
2024-07-12 15:02:23,784 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 15:02:23,786 DEBUG Received frame <Channel.OpenOk object at 0x7fc9315aa050> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:02:23,787 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:02:23,788 DEBUG Received frame <Confirm.SelectOk object at 0x7fc9315b8690> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:02:23,789 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:02:23,791 DEBUG Received frame <Basic.QosOk object at 0x7fc9336e4f50> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:02:23,792 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:02:23,794 DEBUG Received frame <Basic.QosOk object at 0x7fc9315ba210> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:02:23,795 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:02:23,796 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:02:23,803 DEBUG Received frame <Queue.DeclareOk object at 0x7fc9315c2f30> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:02:23,804 INFO Consumer successfully started!
2024-07-12 15:02:23,804 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:02:23,805 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.5511dc29369549149b44be02dffa66c9\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:02:23,807 DEBUG Received frame <Basic.ConsumeOk object at 0x7fc9315bab50> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:02:28,786 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 15:02:56,233 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc931bb2490> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:02:56,519 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:03:28,666 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc931bc8110> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:03:29,246 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:03:58,872 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc931bb2490> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:03:59,744 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:04:29,622 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc931bc8110> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:04:30,785 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:05:02,071 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc931bb2490> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:05:03,525 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:05:34,502 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc931bc8110> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:05:36,249 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:06:06,937 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc931bb2490> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:08,977 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:06:16,450 DEBUG Received frame <Basic.Deliver object at 0x7fc93159f950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:16,451 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9315ba1d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:16,452 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc931bb2490> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:16,453 INFO Message received
2024-07-12 15:06:16,454 INFO {'type': 'file_dowloaded', 'file_name': '1-001.dcm'}
2024-07-12 15:06:16,496 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection pool created", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:16,501 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:16,503 DEBUG {"message": "Waiting for suitable server to become available", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "remainingTimeMS": 29}
2024-07-12 15:06:16,505 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:16,506 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:16,507 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:16,509 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:06:16,511 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0009707490000891994}
2024-07-12 15:06:16,514 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0061089400001037575}
2024-07-12 15:06:16,515 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:06:16,517 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:16,518 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:16,520 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:16,539 ERROR Task exception was never retrieved
future: <Task finished name='Task-21' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:17,011 DEBUG Received frame <Basic.Deliver object at 0x7fc93159ffb0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:17,012 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc933726650> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:17,013 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc931bb2490> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:17,014 INFO Message received
2024-07-12 15:06:17,015 INFO {'type': 'file_dowloaded', 'file_name': '1-002.dcm'}
2024-07-12 15:06:17,039 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:17,040 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:17,041 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:17,042 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 15:06:17,046 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.001451541000051293}
2024-07-12 15:06:17,047 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.006361663999996381}
2024-07-12 15:06:17,049 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 15:06:17,050 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:17,054 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:17,055 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:17,064 ERROR Task exception was never retrieved
future: <Task finished name='Task-23' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:17,564 DEBUG Received frame <Basic.Deliver object at 0x7fc9315f4530> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:17,565 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9315ce150> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:17,566 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc9315cd890> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:17,567 INFO Message received
2024-07-12 15:06:17,568 INFO {'type': 'file_dowloaded', 'file_name': '1-003.dcm'}
2024-07-12 15:06:17,596 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:17,597 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:17,598 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:17,599 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 15:06:17,602 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.0014557580000200687}
2024-07-12 15:06:17,603 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.00460413900009371}
2024-07-12 15:06:17,604 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 15:06:17,604 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:17,606 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:17,607 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:17,615 ERROR Task exception was never retrieved
future: <Task finished name='Task-25' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:18,100 DEBUG Received frame <Basic.Deliver object at 0x7fc9304cce90> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:18,101 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9315cf750> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:18,102 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc9315cd890> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:18,104 INFO Message received
2024-07-12 15:06:18,104 INFO {'type': 'file_dowloaded', 'file_name': '1-004.dcm'}
2024-07-12 15:06:18,132 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:18,133 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:18,134 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:18,135 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 15:06:18,138 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.001032441999996081}
2024-07-12 15:06:18,139 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.004745855999999549}
2024-07-12 15:06:18,141 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 15:06:18,143 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:18,145 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:18,146 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:18,151 ERROR Task exception was never retrieved
future: <Task finished name='Task-27' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:18,708 DEBUG Received frame <Basic.Deliver object at 0x7fc93159ff50> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:18,708 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9304d8210> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:18,710 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc9304d9990> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:18,712 INFO Message received
2024-07-12 15:06:18,712 INFO {'type': 'file_dowloaded', 'file_name': '1-005.dcm'}
2024-07-12 15:06:18,740 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:18,741 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:18,742 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:18,742 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 15:06:18,747 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0010221739998996782}
2024-07-12 15:06:18,747 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.005638414000031844}
2024-07-12 15:06:18,749 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 15:06:18,750 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:18,751 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:18,752 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:18,761 ERROR Task exception was never retrieved
future: <Task finished name='Task-29' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:19,269 DEBUG Received frame <Basic.Deliver object at 0x7fc9315f45f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:19,271 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9315ba110> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:19,272 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc9315bacd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:19,275 INFO Message received
2024-07-12 15:06:19,277 INFO {'type': 'file_dowloaded', 'file_name': '1-006.dcm'}
2024-07-12 15:06:19,344 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:19,344 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:19,345 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:19,347 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 6}
2024-07-12 15:06:19,351 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 6, "durationMS": 0.0011153079999530746}
2024-07-12 15:06:19,353 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 6, "durationMS": 0.007099764000031428}
2024-07-12 15:06:19,354 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 6}
2024-07-12 15:06:19,355 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 6, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:19,357 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:19,358 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:19,364 ERROR Task exception was never retrieved
future: <Task finished name='Task-31' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:19,833 DEBUG Received frame <Basic.Deliver object at 0x7fc9304cd1f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:19,834 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9315da450> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:19,835 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc9315dac90> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:19,837 INFO Message received
2024-07-12 15:06:19,838 INFO {'type': 'file_dowloaded', 'file_name': '1-007.dcm'}
2024-07-12 15:06:19,864 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:19,865 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:19,866 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:19,867 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 7}
2024-07-12 15:06:19,870 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 7, "durationMS": 0.001092575000029683}
2024-07-12 15:06:19,870 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 7, "durationMS": 0.004400640000085332}
2024-07-12 15:06:19,874 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 7}
2024-07-12 15:06:19,875 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 7, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:19,877 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:19,878 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:19,884 ERROR Task exception was never retrieved
future: <Task finished name='Task-33' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:20,436 DEBUG Received frame <Basic.Deliver object at 0x7fc9315f4710> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:20,437 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9315bae10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:20,438 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc9315bb610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:20,439 INFO Message received
2024-07-12 15:06:20,440 INFO {'type': 'file_dowloaded', 'file_name': '1-008.dcm'}
2024-07-12 15:06:20,464 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:20,465 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:20,467 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:20,468 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 8}
2024-07-12 15:06:20,473 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 8, "durationMS": 0.0010704829999212961}
2024-07-12 15:06:20,473 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 8, "durationMS": 0.00689800500003912}
2024-07-12 15:06:20,475 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 8}
2024-07-12 15:06:20,475 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 8, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:20,477 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:20,478 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:20,485 ERROR Task exception was never retrieved
future: <Task finished name='Task-35' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:21,018 DEBUG Received frame <Basic.Deliver object at 0x7fc93159f830> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:21,019 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9304b2b10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:21,019 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc9315bb610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:21,021 INFO Message received
2024-07-12 15:06:21,021 INFO {'type': 'file_dowloaded', 'file_name': '1-009.dcm'}
2024-07-12 15:06:21,042 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:21,043 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:21,045 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:21,046 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 9}
2024-07-12 15:06:21,048 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 9, "durationMS": 0.0009609409999029594}
2024-07-12 15:06:21,049 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 9, "durationMS": 0.004485614000032001}
2024-07-12 15:06:21,050 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 9}
2024-07-12 15:06:21,051 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 9, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:21,052 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:21,053 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:21,059 ERROR Task exception was never retrieved
future: <Task finished name='Task-37' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:21,618 DEBUG Received frame <Basic.Deliver object at 0x7fc9304cc950> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:21,619 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9304da750> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:21,620 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc9315e9e10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:21,621 INFO Message received
2024-07-12 15:06:21,621 INFO {'type': 'file_dowloaded', 'file_name': '1-010.dcm'}
2024-07-12 15:06:21,647 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:21,649 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:21,650 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:21,650 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 10}
2024-07-12 15:06:21,659 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 10, "durationMS": 0.003271764999908555}
2024-07-12 15:06:21,660 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 10, "durationMS": 0.009805487999983598}
2024-07-12 15:06:21,669 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 10}
2024-07-12 15:06:21,672 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 10, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:21,675 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:21,676 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:21,684 ERROR Task exception was never retrieved
future: <Task finished name='Task-39' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:22,218 DEBUG Received frame <Basic.Deliver object at 0x7fc93159ffb0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:22,219 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9315aab10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:22,220 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc9304e2610> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:22,222 INFO Message received
2024-07-12 15:06:22,222 INFO {'type': 'file_dowloaded', 'file_name': '1-011.dcm'}
2024-07-12 15:06:22,281 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:22,282 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:22,283 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:22,285 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 11}
2024-07-12 15:06:22,292 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 11, "durationMS": 0.0011024739999356825}
2024-07-12 15:06:22,295 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 11, "durationMS": 0.01192307799988157}
2024-07-12 15:06:22,299 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 11}
2024-07-12 15:06:22,301 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 11, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:22,304 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:22,307 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:22,314 ERROR Task exception was never retrieved
future: <Task finished name='Task-41' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:22,824 DEBUG Received frame <Basic.Deliver object at 0x7fc93159ff50> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:22,825 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7fc9315e9990> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:22,826 DEBUG Received frame <pamqp.body.ContentBody object at 0x7fc9315e9810> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:06:22,828 INFO Message received
2024-07-12 15:06:22,829 INFO {'type': 'file_dowloaded', 'file_name': '1-012.dcm'}
2024-07-12 15:06:22,847 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}}
2024-07-12 15:06:22,848 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7fc932e31120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691457f7c0b6615ecea480e, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0015865660000144999>]>", "clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:22,849 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:06:22,850 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 12}
2024-07-12 15:06:22,853 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 12, "durationMS": 0.0009633239999402576}
2024-07-12 15:06:22,854 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 12, "durationMS": 0.004394864999994752}
2024-07-12 15:06:22,855 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 12}
2024-07-12 15:06:22,856 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 12, "reason": "An error occurred while using the connection", "error": "error"}
2024-07-12 15:06:22,857 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00Z\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:06:22,858 ERROR Exception in callback _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40
handle: <Handle _task_done(<Task finishe...ersonName'>")>) at /usr/local/lib/python3.11/site-packages/aio_pika/tools.py:40>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/asyncio/events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "/usr/local/lib/python3.11/site-packages/aio_pika/tools.py", line 44, in _task_done
    raise exc
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:22,863 ERROR Task exception was never retrieved
future: <Task finished name='Task-43' coro=<consumer() done, defined at /usr/local/lib/python3.11/site-packages/aio_pika/queue.py:24> exception=InvalidDocument("cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>")>
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/aio_pika/queue.py", line 30, in consumer
    return await create_task(callback, message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/pika/router.py", line 56, in message_router
    new_item = await db_manager.create_item(item)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/db.py", line 11, in create_item
    result = await self.db.items.insert_one(item)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 658, in insert_one
    self._insert_one(
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 598, in _insert_one
    self.__database.client._retryable_write(
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1575, in _retryable_write
    return self._retry_with_session(retryable, func, s, bulk, operation, operation_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1461, in _retry_with_session
    return self._retry_internal(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 1507, in _retry_internal
    ).run()
      ^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2353, in run
    return self._read() if self._is_read else self._write()
                                              ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/mongo_client.py", line 2470, in _write
    return self._func(self._session, conn, self._retryable)  # type: ignore
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/collection.py", line 586, in _insert_command
    result = conn.command(
             ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/helpers.py", line 342, in inner
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 1017, in command
    self._raise_connection_failure(error)
  File "/usr/local/lib/python3.11/site-packages/pymongo/pool.py", line 989, in command
    return command(
           ^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/network.py", line 152, in command
    request_id, msg, size, max_doc_size = message._op_msg(
                                          ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pymongo/message.py", line 758, in _op_msg
    return _op_msg_uncompressed(flags, command, identifier, docs, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
bson.errors.InvalidDocument: cannot encode object: 'TCGA-CS-5396', of type: <class 'pydicom.valuerep.PersonName'>
2024-07-12 15:06:41,714 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:07:11,816 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc9315e98d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:07:14,447 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:07:42,189 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc9315da050> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:07:45,113 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:08:12,372 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fc9315daf50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fc9315b59a0>
2024-07-12 15:08:15,589 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:08:28,902 DEBUG {"clientId": {"$oid": "6691457f7c0b6615ecea480e"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:22,399 INFO Starting consumer...
2024-07-12 15:09:22,400 DEBUG Using selector: EpollSelector
2024-07-12 15:09:22,402 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:09:22,402 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:09:22,403 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:09:22,404 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 15:09:22,412 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:09:22,413 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:09:22,414 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f80b7575850>
2024-07-12 15:09:22,416 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 15:09:22,418 DEBUG Received frame <Channel.OpenOk object at 0x7f80b6dce010> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:22,419 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:09:22,421 DEBUG Received frame <Confirm.SelectOk object at 0x7f80b4ccc9d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:22,422 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:09:22,423 DEBUG Received frame <Basic.QosOk object at 0x7f80b4ccde10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:22,430 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:09:22,432 DEBUG Received frame <Basic.QosOk object at 0x7f80b4cce650> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:22,436 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:09:22,437 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:09:22,445 DEBUG Received frame <Queue.DeclareOk object at 0x7f80b4cd7160> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:22,447 INFO Consumer successfully started!
2024-07-12 15:09:22,448 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:09:22,449 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.1056ae61de1c4d6eadc28709b50e9a83\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:09:22,451 DEBUG Received frame <Basic.ConsumeOk object at 0x7f80b4cce610> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:27,415 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 15:09:33,168 DEBUG Received frame <Basic.Deliver object at 0x7f80b4cb38f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:33,169 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80b4ccef10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:33,170 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80b4ccf210> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:33,171 INFO Message received
2024-07-12 15:09:33,172 INFO {'type': 'file_dowloaded', 'file_name': '1-001.dcm'}
2024-07-12 15:09:33,201 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection pool created", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:33,203 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:33,205 DEBUG {"message": "Waiting for suitable server to become available", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "remainingTimeMS": 29}
2024-07-12 15:09:33,206 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:33,207 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0011469329997453315>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:33,209 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:33,210 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:09:33,214 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.002225023999926634}
2024-07-12 15:09:33,216 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.007336814000154845}
2024-07-12 15:09:33,218 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-001.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"6691472d6067cb51e93c9593\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:33,229 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 11.154, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:33,230 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:09:33,231 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0011469329997453315>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:33,232 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0011469329997453315>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:33,233 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:33,233 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0006566080000993679}
2024-07-12 15:09:33,234 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"6691472d6067cb51e93c9593\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:33,236 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 1.601, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"6691472d6067cb51e93c9593\"}, \"FileName\": \"1-001.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:33,237 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:09:33,237 INFO Created new item on mongodb 
2024-07-12 15:09:33,239 INFO {'_id': ObjectId('6691472d6067cb51e93c9593'), 'FileName': '1-001.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '6691472d6067cb51e93c9593'}
2024-07-12 15:09:33,260 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:09:33,263 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:09:33,265 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:09:33,268 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:09:33,268 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:09:33,270 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:09:33,272 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:09:33,277 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:09:33,278 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:09:33,279 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:09:33,280 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:09:33,605 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:09:33,610 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:09:33,634 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:09:33,635 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:09:33,664 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:09:33,695 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:09:33,702 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:09:33,707 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:09:33,707 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80b4cc7e20>
2024-07-12 15:09:33,769 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:09:33,770 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:09:33,770 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:09:33,771 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:09:33,771 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:09:33,772 DEBUG No configured endpoint found.
2024-07-12 15:09:33,775 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:09:33,779 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:09:33,780 DEBUG Registering retry handlers for service: s3
2024-07-12 15:09:33,781 DEBUG Registering S3 region redirector handler
2024-07-12 15:09:33,782 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:09:33,783 DEBUG Loading s3:s3
2024-07-12 15:09:33,785 DEBUG Loading s3:Bucket
2024-07-12 15:09:33,786 DEBUG Renaming Bucket attribute name
2024-07-12 15:09:33,788 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80b4cf5120>
2024-07-12 15:09:33,789 DEBUG Loading s3:Bucket
2024-07-12 15:09:33,789 DEBUG Renaming Bucket attribute name
2024-07-12 15:09:33,791 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80b4cf5120>
2024-07-12 15:09:33,791 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:09:33,792 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:09:33,793 DEBUG Acquiring 0
2024-07-12 15:09:33,795 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80ad84e550>}) about to wait for the following futures []
2024-07-12 15:09:33,796 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80ad84e550>}) done waiting for dependent futures
2024-07-12 15:09:33,797 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80ad84e550>}) with kwargs {'client': <botocore.client.S3 object at 0x7f80adcf7950>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f80ad84d890>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f80b4cce4d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f80ad84dcd0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80ad84e550>}
2024-07-12 15:09:33,801 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f80ad84dcd0> for transfer request: 0.
2024-07-12 15:09:33,801 DEBUG Acquiring 0
2024-07-12 15:09:33,802 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:09:33,802 DEBUG Releasing acquire 0/None
2024-07-12 15:09:33,803 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:09:33,804 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f80adcf7950>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f80b533af90>, 'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}
2024-07-12 15:09:33,805 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:09:33,806 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:09:33,806 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:09:33,807 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:09:33,807 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:09:33,808 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80b4cbeb90>>
2024-07-12 15:09:33,809 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f80b4cce490>>
2024-07-12 15:09:33,809 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:09:33,810 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:09:33,811 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80b4cbeb90>>
2024-07-12 15:09:33,812 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-001.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:09:33,814 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:09:33,814 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:09:33,815 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:09:33,816 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:09:33,824 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:09:33,825 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:09:33,825 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80ad828150>>
2024-07-12 15:09:33,826 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:09:33,827 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:09:33,827 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-001.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'L6aOLMZfOzKG9Fk3Lc1wMg==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f80b533af90>, 'auth_path': '/dicommetadata/1-001.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-001.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f80adcc0a10>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-001.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f80b533af90>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-001.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:09:33,829 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:09:33,830 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f80adc9f690>>
2024-07-12 15:09:33,832 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f80b4cce490>>
2024-07-12 15:09:33,832 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:09:33,835 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:09:33,836 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80ad828150>>
2024-07-12 15:09:33,837 DEBUG Calculating signature using v4 auth.
2024-07-12 15:09:33,838 DEBUG CanonicalRequest:
PUT
/1-001.dcm

content-md5:L6aOLMZfOzKG9Fk3Lc1wMg==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T150933Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:09:33,839 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T150933Z
20240712/us-east-1/s3/aws4_request
97b6d4189d98461275ec97eb850b0182127641a3ca0fc52b3d7ab39f21584205
2024-07-12 15:09:33,839 DEBUG Signature:
eab77bd2ef1cd3f5450dadae7c7b7cabd13200203fa5c68b79e0421400ed3eb1
2024-07-12 15:09:33,840 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:09:33,841 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:09:33,842 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-001.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'L6aOLMZfOzKG9Fk3Lc1wMg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T150933Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=eab77bd2ef1cd3f5450dadae7c7b7cabd13200203fa5c68b79e0421400ed3eb1', 'amz-sdk-invocation-id': b'554878ed-b3a3-485f-b14b-633e8486296b', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527938'}>
2024-07-12 15:09:33,844 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:09:33,845 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:09:34,127 DEBUG Waiting for 100 Continue response.
2024-07-12 15:09:34,239 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:09:34,240 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:09:34,251 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-001.dcm HTTP/11" 400 None
2024-07-12 15:09:34,252 DEBUG Response headers: {'x-amz-request-id': '93T7JVM52Q693FMM', 'x-amz-id-2': 'w4/dUYD0Wmwb10eWgYHujybmlE8hQfqZ36kZMuQarWbJU/hPV5qLUkeR56MkLHY07c9oQN0AjH4=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:09:35 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:09:34,252 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>93T7JVM52Q693FMM</RequestId><HostId>w4/dUYD0Wmwb10eWgYHujybmlE8hQfqZ36kZMuQarWbJU/hPV5qLUkeR56MkLHY07c9oQN0AjH4=</HostId></Error>'
2024-07-12 15:09:34,256 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f80adcae4d0>
2024-07-12 15:09:34,257 DEBUG No retry needed.
2024-07-12 15:09:34,257 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80b4cbeb90>>
2024-07-12 15:09:34,257 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:09:34,258 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:09:34,258 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80b4cbeb90>>
2024-07-12 15:09:34,259 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-001.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:09:34,261 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:09:34,261 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-001.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-001.dcm
2024-07-12 15:09:34,262 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:09:34,262 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:09:34,263 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:09:34,274 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f80b533af90>
2024-07-12 15:09:34,275 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:09:34,275 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f80adc9f690>>
2024-07-12 15:09:34,276 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f80b4cce490>>
2024-07-12 15:09:34,276 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:09:34,277 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:09:34,278 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80ad828150>>
2024-07-12 15:09:34,279 DEBUG Calculating signature using v4 auth.
2024-07-12 15:09:34,280 DEBUG CanonicalRequest:
PUT
/1-001.dcm

content-md5:L6aOLMZfOzKG9Fk3Lc1wMg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T150934Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:09:34,280 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T150934Z
20240712/eu-north-1/s3/aws4_request
6f38ee9c4cf601d2de173dbd008b0ae08d26e49cc7870b6553a4fe2f9637a5ef
2024-07-12 15:09:34,281 DEBUG Signature:
860e159904eda1ea8781514362459b2e439dd5cdeee5a8b476830bf5beb56364
2024-07-12 15:09:34,283 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:09:34,284 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:09:34,285 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-001.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'L6aOLMZfOzKG9Fk3Lc1wMg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T150934Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=860e159904eda1ea8781514362459b2e439dd5cdeee5a8b476830bf5beb56364', 'amz-sdk-invocation-id': b'554878ed-b3a3-485f-b14b-633e8486296b', 'amz-sdk-request': b'ttl=20240712T151035Z; attempt=2; max=5', 'Content-Length': '527938'}>
2024-07-12 15:09:34,286 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:09:34,287 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:09:34,652 DEBUG Waiting for 100 Continue response.
2024-07-12 15:09:35,654 DEBUG No response seen from server, continuing to send the response body.
2024-07-12 15:09:55,749 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-001.dcm HTTP/11" 200 0
2024-07-12 15:09:55,750 DEBUG Response headers: {'x-amz-id-2': 'zVIygZukzq1n8whlsONFfn2CdJLNbbOllq243d4+/0gFhb/hzfzSBsinTCDj4g3rvGivd8KNUF4=', 'x-amz-request-id': 'QYW4AQSXYJWDYQEJ', 'Date': 'Fri, 12 Jul 2024 15:09:38 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"2fa68e2cc65f3b3286f459372dcd7032"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:09:55,750 DEBUG Response body:
b''
2024-07-12 15:09:55,751 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f80adcae4d0>
2024-07-12 15:09:55,751 DEBUG No retry needed.
2024-07-12 15:09:55,752 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80b4cbeb90>>
2024-07-12 15:09:55,753 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:09:55,754 DEBUG Releasing acquire 0/None
2024-07-12 15:09:55,755 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:09:55,760 DEBUG Received frame <Basic.Deliver object at 0x7f80b4d08ef0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,761 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80adb7a250> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,761 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80b4d2f1d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,763 DEBUG Received frame <Basic.Deliver object at 0x7f80b4d08e90> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,764 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80b4e63410> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,764 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80ad9c9590> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,765 DEBUG Received frame <Basic.Deliver object at 0x7f80b4d08290> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,766 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80addbba50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,767 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80ad818050> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,768 DEBUG Received frame <Basic.Deliver object at 0x7f80b4d08650> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,769 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80ad818290> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,771 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80ad8184d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,772 DEBUG Received frame <Basic.Deliver object at 0x7f80b4d087d0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,773 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80ad818a90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,774 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80ad818e10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,775 DEBUG Received frame <Basic.Deliver object at 0x7f80b4d089b0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,776 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80ad819190> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,777 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80ad819590> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,777 DEBUG Received frame <Basic.Deliver object at 0x7f80b4d08a10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,778 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80ad819b50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,779 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80ad819350> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,783 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:09:55,784 INFO Message received
2024-07-12 15:09:55,784 INFO {'type': 'file_dowloaded', 'file_name': '1-002.dcm'}
2024-07-12 15:09:55,803 INFO Message received
2024-07-12 15:09:55,803 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0012662095998166479>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:55,804 INFO {'type': 'file_dowloaded', 'file_name': '1-003.dcm'}
2024-07-12 15:09:55,804 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0012662095998166479>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,808 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,809 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0010074169999825244}
2024-07-12 15:09:55,810 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-002.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147436067cb51e93c9594\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,814 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 4.601, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,818 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:09:55,830 INFO Message received
2024-07-12 15:09:55,830 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0012662095998166479>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:55,832 INFO {'type': 'file_dowloaded', 'file_name': '1-004.dcm'}
2024-07-12 15:09:55,835 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0012662095998166479>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,839 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,839 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008385660003114026}
2024-07-12 15:09:55,843 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-003.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147436067cb51e93c9595\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,845 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 2.695, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,847 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:09:55,861 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f80ad81c090> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,861 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0012662095998166479>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:55,862 DEBUG Received frame <Basic.Deliver object at 0x7f80b4d08350> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,865 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0012662095998166479>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,867 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80b4cfdb90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,869 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,870 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80ad81c090> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:55,871 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001946265999777097}
2024-07-12 15:09:55,873 INFO Message received
2024-07-12 15:09:55,873 INFO {'type': 'file_dowloaded', 'file_name': '1-005.dcm'}
2024-07-12 15:09:55,873 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-004.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147436067cb51e93c9596\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,877 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 3.913, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1189641421, "operationId": 1189641421, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,878 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:09:55,895 INFO Message received
2024-07-12 15:09:55,896 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0012662095998166479>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:55,897 INFO {'type': 'file_dowloaded', 'file_name': '1-006.dcm'}
2024-07-12 15:09:55,898 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0012662095998166479>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,902 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,906 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0035399820003476634}
2024-07-12 15:09:55,911 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-005.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147436067cb51e93c9597\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,913 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 2.487, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1025202362, "operationId": 1025202362, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,916 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:09:55,937 INFO Message received
2024-07-12 15:09:55,938 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0012662095998166479>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:55,938 INFO {'type': 'file_dowloaded', 'file_name': '1-007.dcm'}
2024-07-12 15:09:55,940 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0012662095998166479>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,942 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,943 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007917240000097081}
2024-07-12 15:09:55,944 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-006.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147436067cb51e93c9598\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,946 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 1.923, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,948 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:09:55,969 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:55,972 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,973 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:55,976 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,976 INFO Message received
2024-07-12 15:09:55,977 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,977 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:55,978 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0019060250001530221}
2024-07-12 15:09:55,979 INFO {'type': 'file_dowloaded', 'file_name': '1-008.dcm'}
2024-07-12 15:09:55,980 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,981 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,981 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-007.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147436067cb51e93c9599\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,983 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 15:09:55,984 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,985 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 4.314, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,987 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 15:09:55,989 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0023335569999289874}
2024-07-12 15:09:55,989 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:09:55,993 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.013467568999658397}
2024-07-12 15:09:55,994 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.0014467740002146456}
2024-07-12 15:09:55,997 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147436067cb51e93c9594\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 2, "serverConnectionId": 7, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:55,998 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.014451152000219736}
2024-07-12 15:09:56,001 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 4.460999999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147436067cb51e93c9594\"}, \"FileName\": \"1-002.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 2, "serverConnectionId": 7, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,002 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147436067cb51e93c9595\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"5zUUhldKTxuh2zdDd/BMkg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 3, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,029 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 27.917, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147436067cb51e93c9595\"}, \"FileName\": \"1-003.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 3, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,007 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 15:09:56,037 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 15:09:56,103 INFO Message received
2024-07-12 15:09:56,104 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:56,105 INFO {'type': 'file_dowloaded', 'file_name': '1-009.dcm'}
2024-07-12 15:09:56,106 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,109 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,111 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.0021703900001739385}
2024-07-12 15:09:56,113 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"5zUUhldKTxuh2zdDd/BMkg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-008.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147446067cb51e93c959a\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 3, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,128 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 15.344999999999999, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 3, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,129 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 15:09:56,155 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:56,158 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,160 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,161 DEBUG Received frame <Basic.Deliver object at 0x7f80ad9c3230> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:56,161 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:56,161 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.0010659909999048978}
2024-07-12 15:09:56,165 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80ad82f6d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:56,167 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,168 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:56,172 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,174 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,175 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0007441500001732493}
2024-07-12 15:09:56,173 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:56,170 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80ad81c090> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:09:56,172 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,169 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"5zUUhldKTxuh2zdDd/BMkg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-009.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147446067cb51e93c959b\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 3, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,175 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147436067cb51e93c9597\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 2, "serverConnectionId": 7, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,177 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,183 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:09:56,183 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.01135538699963945}
2024-07-12 15:09:56,183 INFO Created new item on mongodb 
2024-07-12 15:09:56,186 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,187 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,187 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 18.325, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 3, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,187 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 12.017, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147436067cb51e93c9597\"}, \"FileName\": \"1-005.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 2, "serverConnectionId": 7, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,188 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147436067cb51e93c9596\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YZAXfAoORy2vjuRHJSWN+Q==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,188 INFO {'_id': ObjectId('669147436067cb51e93c9594'), 'FileName': '1-002.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147436067cb51e93c9594'}
2024-07-12 15:09:56,190 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 15:09:56,190 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,191 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 15:09:56,193 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 15:09:56,199 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.0014734490000591904}
2024-07-12 15:09:56,196 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 15:09:56,195 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 7.527, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147436067cb51e93c9596\"}, \"FileName\": \"1-004.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 1, "serverConnectionId": 3, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,202 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.015566459999718063}
2024-07-12 15:09:56,206 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 15:09:56,209 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147436067cb51e93c9598\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,214 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.004040755999994872}
2024-07-12 15:09:56,216 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 7.313, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147436067cb51e93c9598\"}, \"FileName\": \"1-006.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,219 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.02844021300006716}
2024-07-12 15:09:56,220 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 15:09:56,221 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147436067cb51e93c9599\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YZAXfAoORy2vjuRHJSWN+Q==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 5, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,224 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 2.794, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147436067cb51e93c9599\"}, \"FileName\": \"1-007.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 861021530, "operationId": 861021530, "driverConnectionId": 5, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:09:56,226 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 15:09:56,232 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:09:56,237 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:09:56,239 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:09:56,243 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:09:56,244 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:09:56,246 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:09:56,248 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:09:56,255 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:09:56,256 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:09:56,257 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:09:56,258 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:09:56,279 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:09:56,282 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:09:56,310 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:09:56,312 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:09:56,343 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:09:56,385 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:09:56,472 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:09:56,476 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:09:56,477 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80ad848720>
2024-07-12 15:09:56,478 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:09:56,478 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:09:56,479 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:09:56,480 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:09:56,480 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:09:56,481 DEBUG No configured endpoint found.
2024-07-12 15:09:56,484 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:09:56,487 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:09:56,490 DEBUG Registering retry handlers for service: s3
2024-07-12 15:09:56,492 DEBUG Registering S3 region redirector handler
2024-07-12 15:09:56,496 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:09:56,497 DEBUG Loading s3:s3
2024-07-12 15:09:56,499 DEBUG Loading s3:Bucket
2024-07-12 15:09:56,500 DEBUG Renaming Bucket attribute name
2024-07-12 15:09:56,502 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80adb0dbc0>
2024-07-12 15:09:56,503 DEBUG Loading s3:Bucket
2024-07-12 15:09:56,504 DEBUG Renaming Bucket attribute name
2024-07-12 15:09:56,506 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80adb0dbc0>
2024-07-12 15:09:56,506 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:09:56,507 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:09:56,508 DEBUG Acquiring 0
2024-07-12 15:09:56,509 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80adf96c50>}) about to wait for the following futures []
2024-07-12 15:09:56,510 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80adf96c50>}) done waiting for dependent futures
2024-07-12 15:09:56,510 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80adf96c50>}) with kwargs {'client': <botocore.client.S3 object at 0x7f80ade57350>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f80ad84fd90>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f80b4cbe4d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f80adf97650>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80adf96c50>}
2024-07-12 15:09:56,514 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f80adf97650> for transfer request: 0.
2024-07-12 15:09:56,514 DEBUG Acquiring 0
2024-07-12 15:09:56,515 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:09:56,515 DEBUG Releasing acquire 0/None
2024-07-12 15:09:56,515 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:09:56,517 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f80ade57350>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f80adf96090>, 'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}
2024-07-12 15:09:56,519 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:09:56,520 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:09:56,521 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:09:56,522 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:09:56,523 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:09:56,524 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80ade00750>>
2024-07-12 15:09:56,525 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f80ad84fe10>>
2024-07-12 15:09:56,526 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:09:56,526 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:09:56,527 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80ade00750>>
2024-07-12 15:09:56,528 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-002.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:09:56,531 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:09:56,531 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:09:56,533 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:09:56,534 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:09:56,545 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:09:56,546 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:09:56,549 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80adfdc0d0>>
2024-07-12 15:09:56,549 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:09:56,550 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:09:56,551 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-002.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'PVRgAGLUk/0TOWomyd9neA==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f80adf96090>, 'auth_path': '/dicommetadata/1-002.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-002.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f80ad828a10>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-002.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f80adf96090>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-002.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:09:56,552 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:09:56,553 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f80ade1ba90>>
2024-07-12 15:09:56,555 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f80ad84fe10>>
2024-07-12 15:09:56,556 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:09:56,557 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:09:56,558 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80adfdc0d0>>
2024-07-12 15:09:56,559 DEBUG Calculating signature using v4 auth.
2024-07-12 15:09:56,560 DEBUG CanonicalRequest:
PUT
/1-002.dcm

content-md5:PVRgAGLUk/0TOWomyd9neA==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T150956Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:09:56,561 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T150956Z
20240712/us-east-1/s3/aws4_request
b11a1bc5cd0f09899500a70881c67f61b0f4b3e180e373b7adaff4822b9b0ecf
2024-07-12 15:09:56,562 DEBUG Signature:
c6df9526f0b648133bd161eae1382f652a9f5b6249cb1ccceb4093ffbd8f4826
2024-07-12 15:09:56,562 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:09:56,563 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:09:56,566 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-002.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'PVRgAGLUk/0TOWomyd9neA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T150956Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=c6df9526f0b648133bd161eae1382f652a9f5b6249cb1ccceb4093ffbd8f4826', 'amz-sdk-invocation-id': b'd0efd420-17ba-4966-bf44-1d137120437f', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:09:56,571 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:09:56,572 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:09:57,114 DEBUG Waiting for 100 Continue response.
2024-07-12 15:09:57,237 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:09:57,237 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:09:57,246 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-002.dcm HTTP/11" 400 None
2024-07-12 15:09:57,247 DEBUG Response headers: {'x-amz-request-id': 'KDBD10Q1AV0RV2R7', 'x-amz-id-2': 'dhfRf7PTkNB4DJuTxz+7K4jrYRnlT8MuxXOlEw+dWdSr0BpWTu+4IKgMSYwHrpRevdQz31LHho8=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:09:57 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:09:57,248 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>KDBD10Q1AV0RV2R7</RequestId><HostId>dhfRf7PTkNB4DJuTxz+7K4jrYRnlT8MuxXOlEw+dWdSr0BpWTu+4IKgMSYwHrpRevdQz31LHho8=</HostId></Error>'
2024-07-12 15:09:57,252 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f80ad84f3d0>
2024-07-12 15:09:57,252 DEBUG No retry needed.
2024-07-12 15:09:57,252 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80ade00750>>
2024-07-12 15:09:57,253 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:09:57,253 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:09:57,254 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80ade00750>>
2024-07-12 15:09:57,256 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-002.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:09:57,258 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:09:57,259 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-002.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-002.dcm
2024-07-12 15:09:57,260 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:09:57,260 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:09:57,261 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:09:57,262 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f80adf96090>
2024-07-12 15:09:57,262 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:09:57,263 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f80ade1ba90>>
2024-07-12 15:09:57,263 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f80ad84fe10>>
2024-07-12 15:09:57,264 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:09:57,264 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:09:57,265 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80adfdc0d0>>
2024-07-12 15:09:57,266 DEBUG Calculating signature using v4 auth.
2024-07-12 15:09:57,266 DEBUG CanonicalRequest:
PUT
/1-002.dcm

content-md5:PVRgAGLUk/0TOWomyd9neA==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T150957Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:09:57,267 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T150957Z
20240712/eu-north-1/s3/aws4_request
1942e23e9edc0556847d74b58b91d73c57adde8e53e05e3bf121d31275695df9
2024-07-12 15:09:57,267 DEBUG Signature:
aa23f5bfd038a5e1e50928095d010756a3e1e30b80059857c7da76fe894339db
2024-07-12 15:09:57,268 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:09:57,268 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:09:57,269 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-002.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'PVRgAGLUk/0TOWomyd9neA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T150957Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=aa23f5bfd038a5e1e50928095d010756a3e1e30b80059857c7da76fe894339db', 'amz-sdk-invocation-id': b'd0efd420-17ba-4966-bf44-1d137120437f', 'amz-sdk-request': b'ttl=20240712T151057Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:09:57,270 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:09:57,271 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:09:57,617 DEBUG Waiting for 100 Continue response.
2024-07-12 15:09:57,753 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:09:58,381 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-002.dcm HTTP/11" 200 0
2024-07-12 15:09:58,383 DEBUG Response headers: {'x-amz-id-2': '2q1sSNPtCtM07lImExttDYB7PrAr15+jTdKxy2owvTaOo84ZevVABfgJEJCxbqNtOKnABY2Qt1NpoivdYthGJTp/yJad3vmh', 'x-amz-request-id': 'KDB3ZSK4MT2WRV1A', 'Date': 'Fri, 12 Jul 2024 15:09:59 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"3d54600062d493fd13396a26c9df6778"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:09:58,384 DEBUG Response body:
b''
2024-07-12 15:09:58,388 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f80ad84f3d0>
2024-07-12 15:09:58,390 DEBUG No retry needed.
2024-07-12 15:09:58,393 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80ade00750>>
2024-07-12 15:09:58,396 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:09:58,400 DEBUG Releasing acquire 0/None
2024-07-12 15:09:58,402 INFO Created new item on mongodb 
2024-07-12 15:09:58,402 INFO {'_id': ObjectId('669147436067cb51e93c9595'), 'FileName': '1-003.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147436067cb51e93c9595'}
2024-07-12 15:09:58,430 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:09:58,436 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:09:58,437 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:09:58,440 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:09:58,441 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:09:58,442 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:09:58,444 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:09:58,447 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:09:58,448 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:09:58,449 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:09:58,449 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:09:58,464 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:09:58,466 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:09:58,489 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:09:58,489 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:09:58,509 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:09:58,535 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:09:58,540 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:09:58,545 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:09:58,546 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80adb0d940>
2024-07-12 15:09:58,547 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:09:58,548 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:09:58,548 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:09:58,549 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:09:58,550 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:09:58,550 DEBUG No configured endpoint found.
2024-07-12 15:09:58,552 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:09:58,556 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:09:58,557 DEBUG Registering retry handlers for service: s3
2024-07-12 15:09:58,557 DEBUG Registering S3 region redirector handler
2024-07-12 15:09:58,559 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:09:58,560 DEBUG Loading s3:s3
2024-07-12 15:09:58,562 DEBUG Loading s3:Bucket
2024-07-12 15:09:58,563 DEBUG Renaming Bucket attribute name
2024-07-12 15:09:58,565 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80ad848040>
2024-07-12 15:09:58,565 DEBUG Loading s3:Bucket
2024-07-12 15:09:58,567 DEBUG Renaming Bucket attribute name
2024-07-12 15:09:58,570 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80ad848040>
2024-07-12 15:09:58,570 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:09:58,571 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:09:58,572 DEBUG Acquiring 0
2024-07-12 15:09:58,573 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808df91290>}) about to wait for the following futures []
2024-07-12 15:09:58,573 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808df91290>}) done waiting for dependent futures
2024-07-12 15:09:58,574 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808df91290>}) with kwargs {'client': <botocore.client.S3 object at 0x7f808df22690>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f808df7d410>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f808df90590>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f808df90810>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808df91290>}
2024-07-12 15:09:58,577 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f808df90810> for transfer request: 0.
2024-07-12 15:09:58,578 DEBUG Acquiring 0
2024-07-12 15:09:58,578 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:09:58,579 DEBUG Releasing acquire 0/None
2024-07-12 15:09:58,579 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:09:58,580 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f808df22690>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f808df91ad0>, 'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}
2024-07-12 15:09:58,581 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:09:58,582 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:09:58,583 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:09:58,583 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:09:58,584 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:09:58,584 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808df4fd10>>
2024-07-12 15:09:58,585 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f808f0e98d0>>
2024-07-12 15:09:58,586 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:09:58,586 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:09:58,587 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808df4fd10>>
2024-07-12 15:09:58,588 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-003.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:09:58,589 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:09:58,590 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:09:58,590 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:09:58,591 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:09:58,600 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:09:58,600 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:09:58,601 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808df57e10>>
2024-07-12 15:09:58,601 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:09:58,602 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:09:58,603 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-003.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'qV+1yLW6Gc1LVyynkumYTA==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f808df91ad0>, 'auth_path': '/dicommetadata/1-003.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-003.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f808df40d10>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-003.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f808df91ad0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-003.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:09:58,605 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:09:58,606 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f808df40cd0>>
2024-07-12 15:09:58,607 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808f0e98d0>>
2024-07-12 15:09:58,607 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:09:58,608 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:09:58,609 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808df57e10>>
2024-07-12 15:09:58,610 DEBUG Calculating signature using v4 auth.
2024-07-12 15:09:58,611 DEBUG CanonicalRequest:
PUT
/1-003.dcm

content-md5:qV+1yLW6Gc1LVyynkumYTA==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T150958Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:09:58,612 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T150958Z
20240712/us-east-1/s3/aws4_request
cd69e06f03b81d8bd55c602c25f2b9d75ef7df391def0013d239f53e060ab9ea
2024-07-12 15:09:58,613 DEBUG Signature:
6cc708afd80e32fd04c8a4089703d940c185d58219d9d7d40f1322d164877cce
2024-07-12 15:09:58,613 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:09:58,614 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:09:58,615 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-003.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'qV+1yLW6Gc1LVyynkumYTA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T150958Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=6cc708afd80e32fd04c8a4089703d940c185d58219d9d7d40f1322d164877cce', 'amz-sdk-invocation-id': b'245a44f4-44ac-4bd7-bbac-61f158274e3e', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:09:58,617 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:09:58,618 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:09:58,921 DEBUG Waiting for 100 Continue response.
2024-07-12 15:09:59,027 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:09:59,028 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:09:59,044 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-003.dcm HTTP/11" 400 None
2024-07-12 15:09:59,045 DEBUG Response headers: {'x-amz-request-id': 'N2B4P7XS6X4ER5XD', 'x-amz-id-2': 'sNuOi2WdRm3brhNdC8aTs16k7FoTo9pXTg2Fcu/Is5rxIxRHuUiXPYsDBO7+G96sauMz7d82i0c=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:09:59 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:09:59,046 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>N2B4P7XS6X4ER5XD</RequestId><HostId>sNuOi2WdRm3brhNdC8aTs16k7FoTo9pXTg2Fcu/Is5rxIxRHuUiXPYsDBO7+G96sauMz7d82i0c=</HostId></Error>'
2024-07-12 15:09:59,054 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808df57bd0>
2024-07-12 15:09:59,055 DEBUG No retry needed.
2024-07-12 15:09:59,058 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808df4fd10>>
2024-07-12 15:09:59,064 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:09:59,073 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:09:59,087 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808df4fd10>>
2024-07-12 15:09:59,088 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-003.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:09:59,090 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:09:59,106 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-003.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-003.dcm
2024-07-12 15:09:59,107 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:09:59,108 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:09:59,109 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:09:59,110 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f808df91ad0>
2024-07-12 15:09:59,111 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:09:59,127 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f808df40cd0>>
2024-07-12 15:09:59,129 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808f0e98d0>>
2024-07-12 15:09:59,129 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:09:59,130 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:09:59,130 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808df57e10>>
2024-07-12 15:09:59,131 DEBUG Calculating signature using v4 auth.
2024-07-12 15:09:59,132 DEBUG CanonicalRequest:
PUT
/1-003.dcm

content-md5:qV+1yLW6Gc1LVyynkumYTA==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T150959Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:09:59,132 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T150959Z
20240712/eu-north-1/s3/aws4_request
226125c034b45164b6b8872a4cd88b266fb396c67e195c8b87177db01f984a15
2024-07-12 15:09:59,133 DEBUG Signature:
628caf50d748ceb873dae0bd53ab962427ef653d4cb0bf98c47cd34884d0ff6b
2024-07-12 15:09:59,133 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:09:59,134 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:09:59,135 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-003.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'qV+1yLW6Gc1LVyynkumYTA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T150959Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=628caf50d748ceb873dae0bd53ab962427ef653d4cb0bf98c47cd34884d0ff6b', 'amz-sdk-invocation-id': b'245a44f4-44ac-4bd7-bbac-61f158274e3e', 'amz-sdk-request': b'ttl=20240712T151059Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:09:59,136 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:09:59,137 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:09:59,329 DEBUG Waiting for 100 Continue response.
2024-07-12 15:09:59,447 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:10:00,203 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-003.dcm HTTP/11" 200 0
2024-07-12 15:10:00,204 DEBUG Response headers: {'x-amz-id-2': 'hdPYlze6wrYfcckL1/4l/Fifh+n4ACdy1GB2BpZdjQinNV2phlh0TbsDi4D82pazb5bBWTrIlXw/t5srur9LHsCXhr7HyLXl', 'x-amz-request-id': 'N2B1VM522DBAFB8E', 'Date': 'Fri, 12 Jul 2024 15:10:01 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"a95fb5c8b5ba19cd4b572ca792e9984c"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:10:00,204 DEBUG Response body:
b''
2024-07-12 15:10:00,205 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808df57bd0>
2024-07-12 15:10:00,205 DEBUG No retry needed.
2024-07-12 15:10:00,206 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808df4fd10>>
2024-07-12 15:10:00,206 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:10:00,208 DEBUG Releasing acquire 0/None
2024-07-12 15:10:00,209 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:00,210 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:10:00,210 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:00,211 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,212 INFO Message received
2024-07-12 15:10:00,213 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,213 INFO {'type': 'file_dowloaded', 'file_name': '1-010.dcm'}
2024-07-12 15:10:00,214 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0012887409998256771}
2024-07-12 15:10:00,216 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147446067cb51e93c959a\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YZAXfAoORy2vjuRHJSWN+Q==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 5, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,218 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 2.1879999999999997, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147446067cb51e93c959a\"}, \"FileName\": \"1-008.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 5, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,218 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 15:10:00,232 INFO Created new item on mongodb 
2024-07-12 15:10:00,232 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:10:00,233 INFO {'_id': ObjectId('669147436067cb51e93c9597'), 'FileName': '1-005.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147436067cb51e93c9597'}
2024-07-12 15:10:00,234 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,234 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:10:00,236 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,237 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,238 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0015128659997571958}
2024-07-12 15:10:00,239 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,240 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YZAXfAoORy2vjuRHJSWN+Q==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-010.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147486067cb51e93c959c\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 5, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,243 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.004594882000219513}
2024-07-12 15:10:00,246 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147446067cb51e93c959b\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 2145174067, "operationId": 2145174067, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,249 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 9.332, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 5, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,251 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 15:10:00,251 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 5.8469999999999995, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147446067cb51e93c959b\"}, \"FileName\": \"1-009.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 2145174067, "operationId": 2145174067, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:00,255 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 15:10:00,262 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:10:00,265 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:10:00,268 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:10:00,271 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:10:00,271 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:10:00,273 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:10:00,274 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:10:00,279 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:10:00,280 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:10:00,280 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:10:00,282 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:10:00,296 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:10:00,299 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:10:00,321 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:10:00,322 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:10:00,347 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:10:00,374 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:10:00,380 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:10:00,382 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:10:00,383 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80adb0c860>
2024-07-12 15:10:00,383 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:10:00,384 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:10:00,384 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:10:00,385 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:10:00,385 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:10:00,386 DEBUG No configured endpoint found.
2024-07-12 15:10:00,388 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:10:00,391 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:10:00,392 DEBUG Registering retry handlers for service: s3
2024-07-12 15:10:00,393 DEBUG Registering S3 region redirector handler
2024-07-12 15:10:00,394 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:10:00,395 DEBUG Loading s3:s3
2024-07-12 15:10:00,397 DEBUG Loading s3:Bucket
2024-07-12 15:10:00,398 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:00,402 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808df8dda0>
2024-07-12 15:10:00,403 DEBUG Loading s3:Bucket
2024-07-12 15:10:00,403 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:00,405 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808df8dda0>
2024-07-12 15:10:00,405 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:10:00,406 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:10:00,407 DEBUG Acquiring 0
2024-07-12 15:10:00,408 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808d652ed0>}) about to wait for the following futures []
2024-07-12 15:10:00,408 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808d652ed0>}) done waiting for dependent futures
2024-07-12 15:10:00,409 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808d652ed0>}) with kwargs {'client': <botocore.client.S3 object at 0x7f808d7ebd50>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f808d6520d0>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f808d652190>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f808d652250>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808d652ed0>}
2024-07-12 15:10:00,413 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f808d652250> for transfer request: 0.
2024-07-12 15:10:00,414 DEBUG Acquiring 0
2024-07-12 15:10:00,415 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:10:00,415 DEBUG Releasing acquire 0/None
2024-07-12 15:10:00,416 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:10:00,417 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f808d7ebd50>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f808d6536d0>, 'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}
2024-07-12 15:10:00,418 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:10:00,418 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:10:00,419 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:10:00,419 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:10:00,420 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:10:00,420 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808d6293d0>>
2024-07-12 15:10:00,421 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f808daeced0>>
2024-07-12 15:10:00,421 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:10:00,422 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:00,423 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808d6293d0>>
2024-07-12 15:10:00,424 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-005.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:00,425 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:10:00,426 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:00,426 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:00,427 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:10:00,433 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:10:00,434 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:10:00,434 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808d635810>>
2024-07-12 15:10:00,434 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:10:00,435 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:10:00,437 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-005.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': '64MAcsP5b/yUJi6nhalpKQ==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f808d6536d0>, 'auth_path': '/dicommetadata/1-005.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-005.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f808d612490>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-005.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f808d6536d0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-005.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:10:00,439 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:00,440 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f808d612450>>
2024-07-12 15:10:00,440 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808daeced0>>
2024-07-12 15:10:00,441 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:00,442 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:00,442 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808d635810>>
2024-07-12 15:10:00,443 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:00,444 DEBUG CanonicalRequest:
PUT
/1-005.dcm

content-md5:64MAcsP5b/yUJi6nhalpKQ==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151000Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:00,444 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151000Z
20240712/us-east-1/s3/aws4_request
b3f15d6220b9452a7d4bc10244146a64961ad06a2c0f2b67233e2bbe00e1b1dd
2024-07-12 15:10:00,445 DEBUG Signature:
3fc076282675f69ef3df6c0e7038b343ce741a21702262cf24b1ab4928a537a4
2024-07-12 15:10:00,446 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:00,446 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:00,447 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-005.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'64MAcsP5b/yUJi6nhalpKQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151000Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=3fc076282675f69ef3df6c0e7038b343ce741a21702262cf24b1ab4928a537a4', 'amz-sdk-invocation-id': b'5c7568e9-8422-45a6-a978-143026a58ee2', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:10:00,448 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:00,448 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:10:00,741 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:00,851 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:10:00,852 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:10:00,861 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-005.dcm HTTP/11" 400 None
2024-07-12 15:10:00,862 DEBUG Response headers: {'x-amz-request-id': '883B1GEY2JZWSXKR', 'x-amz-id-2': 'LAzULYip9F3TDrTH6mnZ6pe2XBXpA4gOh8d9v6/3F5/X5k8PFg5yiofInwQejr0oaBefkSK2CS4=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:10:01 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:10:00,863 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>883B1GEY2JZWSXKR</RequestId><HostId>LAzULYip9F3TDrTH6mnZ6pe2XBXpA4gOh8d9v6/3F5/X5k8PFg5yiofInwQejr0oaBefkSK2CS4=</HostId></Error>'
2024-07-12 15:10:00,867 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808d635590>
2024-07-12 15:10:00,868 DEBUG No retry needed.
2024-07-12 15:10:00,868 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808d6293d0>>
2024-07-12 15:10:00,869 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:10:00,870 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:00,870 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808d6293d0>>
2024-07-12 15:10:00,871 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-005.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:00,872 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:10:00,873 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-005.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-005.dcm
2024-07-12 15:10:00,873 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:00,874 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:00,875 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:10:00,875 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f808d6536d0>
2024-07-12 15:10:00,876 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:00,877 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f808d612450>>
2024-07-12 15:10:00,877 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808daeced0>>
2024-07-12 15:10:00,878 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:00,878 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:00,878 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808d635810>>
2024-07-12 15:10:00,880 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:00,880 DEBUG CanonicalRequest:
PUT
/1-005.dcm

content-md5:64MAcsP5b/yUJi6nhalpKQ==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151000Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:00,881 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151000Z
20240712/eu-north-1/s3/aws4_request
5f89cd284d4b668937bb34106d92fb90b50e8fd76eecf19ae9926036620f6cef
2024-07-12 15:10:00,881 DEBUG Signature:
f52af5a7e7618776e03a49f6f076a5013eb0f52ad30e9104668742da0479e8c3
2024-07-12 15:10:00,882 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:00,883 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:00,884 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-005.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'64MAcsP5b/yUJi6nhalpKQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151000Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=f52af5a7e7618776e03a49f6f076a5013eb0f52ad30e9104668742da0479e8c3', 'amz-sdk-invocation-id': b'5c7568e9-8422-45a6-a978-143026a58ee2', 'amz-sdk-request': b'ttl=20240712T151101Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:10:00,885 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:00,887 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:10:01,077 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:01,212 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:10:01,925 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-005.dcm HTTP/11" 200 0
2024-07-12 15:10:01,927 DEBUG Response headers: {'x-amz-id-2': 'HyE516+ua9So76SAbXVB13OVWHTuHA9YCinyRV3ZaXBrd8GfsBGQhzIdwV4gD9XkE5lvmHfulYAfpPtRqV4gNqIJZIASB3Mm', 'x-amz-request-id': '8834RXRPQYE3BQ14', 'Date': 'Fri, 12 Jul 2024 15:10:03 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"eb830072c3f96ffc94262ea785a96929"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:10:01,928 DEBUG Response body:
b''
2024-07-12 15:10:01,933 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808d635590>
2024-07-12 15:10:01,935 DEBUG No retry needed.
2024-07-12 15:10:01,938 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808d6293d0>>
2024-07-12 15:10:01,941 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:10:01,947 DEBUG Releasing acquire 0/None
2024-07-12 15:10:01,949 INFO Created new item on mongodb 
2024-07-12 15:10:01,950 INFO {'_id': ObjectId('669147436067cb51e93c9596'), 'FileName': '1-004.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147436067cb51e93c9596'}
2024-07-12 15:10:01,980 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:10:01,985 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:10:01,988 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:10:01,990 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:10:01,991 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:10:01,992 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:10:01,994 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:10:01,999 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:10:02,000 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:10:02,003 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:10:02,003 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:10:02,020 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:10:02,022 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:10:02,044 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:10:02,044 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:10:02,063 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:10:02,094 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:10:02,168 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:10:02,170 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:10:02,171 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80adbfb420>
2024-07-12 15:10:02,171 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:10:02,172 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:10:02,172 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:10:02,173 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:10:02,173 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:10:02,173 DEBUG No configured endpoint found.
2024-07-12 15:10:02,176 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:10:02,178 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:10:02,179 DEBUG Registering retry handlers for service: s3
2024-07-12 15:10:02,180 DEBUG Registering S3 region redirector handler
2024-07-12 15:10:02,181 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:10:02,182 DEBUG Loading s3:s3
2024-07-12 15:10:02,183 DEBUG Loading s3:Bucket
2024-07-12 15:10:02,184 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:02,185 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80ad88a5c0>
2024-07-12 15:10:02,186 DEBUG Loading s3:Bucket
2024-07-12 15:10:02,187 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:02,188 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80ad88a5c0>
2024-07-12 15:10:02,189 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:10:02,189 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:10:02,190 DEBUG Acquiring 0
2024-07-12 15:10:02,191 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808cd16b10>}) about to wait for the following futures []
2024-07-12 15:10:02,191 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808cd16b10>}) done waiting for dependent futures
2024-07-12 15:10:02,192 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808cd16b10>}) with kwargs {'client': <botocore.client.S3 object at 0x7f808ceb6d10>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f80b4cce090>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f808cd15e10>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f808cd160d0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808cd16b10>}
2024-07-12 15:10:02,195 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f808cd160d0> for transfer request: 0.
2024-07-12 15:10:02,195 DEBUG Acquiring 0
2024-07-12 15:10:02,196 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:10:02,196 DEBUG Releasing acquire 0/None
2024-07-12 15:10:02,196 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:10:02,197 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f808ceb6d10>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f808cd17390>, 'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}
2024-07-12 15:10:02,199 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:10:02,199 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:10:02,200 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:10:02,200 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:10:02,201 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:10:02,202 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808cee5810>>
2024-07-12 15:10:02,203 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f808d1b3190>>
2024-07-12 15:10:02,203 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:10:02,204 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:02,205 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808cee5810>>
2024-07-12 15:10:02,206 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-004.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:02,208 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:10:02,208 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:02,209 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:02,210 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:10:02,217 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:10:02,218 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:10:02,218 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808ceed410>>
2024-07-12 15:10:02,218 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:10:02,219 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:10:02,220 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-004.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'nNGkBb77TEAYr2kCLzvfGg==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f808cd17390>, 'auth_path': '/dicommetadata/1-004.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-004.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f808ced17d0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-004.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f808cd17390>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-004.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:10:02,221 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:02,222 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f808ced1790>>
2024-07-12 15:10:02,222 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808d1b3190>>
2024-07-12 15:10:02,223 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:02,223 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:02,224 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808ceed410>>
2024-07-12 15:10:02,225 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:02,225 DEBUG CanonicalRequest:
PUT
/1-004.dcm

content-md5:nNGkBb77TEAYr2kCLzvfGg==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151002Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:02,226 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151002Z
20240712/us-east-1/s3/aws4_request
c5dd5878b92ac51c4d2fdd0cc120aca23d2b5cd8877ce4c63ed99e4cb1b7927d
2024-07-12 15:10:02,226 DEBUG Signature:
46b3725d6e55d868d42c16eaf4a3ac26f4f7eec541f707b131e4cc68f35d1f7d
2024-07-12 15:10:02,227 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:02,228 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:02,228 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-004.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'nNGkBb77TEAYr2kCLzvfGg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151002Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=46b3725d6e55d868d42c16eaf4a3ac26f4f7eec541f707b131e4cc68f35d1f7d', 'amz-sdk-invocation-id': b'd0464107-c68f-44a3-92a9-20a5a7f3e8ce', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:10:02,229 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:02,230 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:10:02,623 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:02,730 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:10:02,730 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:10:02,740 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-004.dcm HTTP/11" 400 None
2024-07-12 15:10:02,741 DEBUG Response headers: {'x-amz-request-id': 'C5W5A264D8ADNRVF', 'x-amz-id-2': 'EM+m5mm8MSxRsBVj28Exc5G7IcvJ+OpoNVoJmlRGuoS9pZ68RqoMZ5jsTB/ZZRXVitzVNBPuq+Y=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:10:03 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:10:02,742 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>C5W5A264D8ADNRVF</RequestId><HostId>EM+m5mm8MSxRsBVj28Exc5G7IcvJ+OpoNVoJmlRGuoS9pZ68RqoMZ5jsTB/ZZRXVitzVNBPuq+Y=</HostId></Error>'
2024-07-12 15:10:02,746 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808ceed190>
2024-07-12 15:10:02,747 DEBUG No retry needed.
2024-07-12 15:10:02,747 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808cee5810>>
2024-07-12 15:10:02,748 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:10:02,749 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:02,751 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808cee5810>>
2024-07-12 15:10:02,752 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-004.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:02,754 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:10:02,754 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-004.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-004.dcm
2024-07-12 15:10:02,755 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:02,756 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:02,757 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:10:02,758 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f808cd17390>
2024-07-12 15:10:02,758 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:02,759 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f808ced1790>>
2024-07-12 15:10:02,760 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808d1b3190>>
2024-07-12 15:10:02,760 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:02,761 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:02,762 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808ceed410>>
2024-07-12 15:10:02,763 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:02,763 DEBUG CanonicalRequest:
PUT
/1-004.dcm

content-md5:nNGkBb77TEAYr2kCLzvfGg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151002Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:02,764 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151002Z
20240712/eu-north-1/s3/aws4_request
aa5c47b5c51ea0ae957c4b918342575ac0de89c686367ab4104c9a44489e868c
2024-07-12 15:10:02,765 DEBUG Signature:
7ad405d45331dba268d6549ad2e968ea51c0fb29d2967e61366922143f8a6eb1
2024-07-12 15:10:02,766 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:02,767 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:02,768 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-004.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'nNGkBb77TEAYr2kCLzvfGg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151002Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=7ad405d45331dba268d6549ad2e968ea51c0fb29d2967e61366922143f8a6eb1', 'amz-sdk-invocation-id': b'd0464107-c68f-44a3-92a9-20a5a7f3e8ce', 'amz-sdk-request': b'ttl=20240712T151103Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:10:02,769 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:02,771 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:10:03,185 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:03,317 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:10:03,970 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-004.dcm HTTP/11" 200 0
2024-07-12 15:10:03,972 DEBUG Response headers: {'x-amz-id-2': 'b4a9Ym3mzM0eE+Ks0R0wslr4qHvQ2aTvmvS5ARddwtdHqmL7t4+dCiuCDoSprxJpPoEmS9Y9q8BQARpj82hdvRb6gapoDAg9', 'x-amz-request-id': 'C5W6C4R0MNZ027WE', 'Date': 'Fri, 12 Jul 2024 15:10:05 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"9cd1a405befb4c4018af69022f3bdf1a"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:10:03,973 DEBUG Response body:
b''
2024-07-12 15:10:03,974 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808ceed190>
2024-07-12 15:10:03,976 DEBUG No retry needed.
2024-07-12 15:10:03,977 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808cee5810>>
2024-07-12 15:10:03,978 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:10:03,982 DEBUG Releasing acquire 0/None
2024-07-12 15:10:03,983 INFO Created new item on mongodb 
2024-07-12 15:10:03,984 INFO {'_id': ObjectId('669147436067cb51e93c9598'), 'FileName': '1-006.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147436067cb51e93c9598'}
2024-07-12 15:10:04,018 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:10:04,025 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:10:04,027 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:10:04,031 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:10:04,031 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:10:04,034 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:10:04,036 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:10:04,040 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:10:04,041 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:10:04,042 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:10:04,042 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:10:04,060 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:10:04,063 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:10:04,085 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:10:04,086 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:10:04,105 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:10:04,131 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:10:04,136 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:10:04,140 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:10:04,141 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80ad84b9c0>
2024-07-12 15:10:04,141 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:10:04,142 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:10:04,142 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:10:04,143 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:10:04,143 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:10:04,144 DEBUG No configured endpoint found.
2024-07-12 15:10:04,147 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:10:04,151 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:10:04,152 DEBUG Registering retry handlers for service: s3
2024-07-12 15:10:04,152 DEBUG Registering S3 region redirector handler
2024-07-12 15:10:04,154 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:10:04,155 DEBUG Loading s3:s3
2024-07-12 15:10:04,157 DEBUG Loading s3:Bucket
2024-07-12 15:10:04,157 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:04,159 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808cebbd80>
2024-07-12 15:10:04,159 DEBUG Loading s3:Bucket
2024-07-12 15:10:04,160 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:04,162 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808cebbd80>
2024-07-12 15:10:04,163 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:10:04,163 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:10:04,164 DEBUG Acquiring 0
2024-07-12 15:10:04,165 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808c5d4350>}) about to wait for the following futures []
2024-07-12 15:10:04,166 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808c5d4350>}) done waiting for dependent futures
2024-07-12 15:10:04,166 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808c5d4350>}) with kwargs {'client': <botocore.client.S3 object at 0x7f808c57cb90>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f808c5d3590>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f808c59f0d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f808c5d3650>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808c5d4350>}
2024-07-12 15:10:04,169 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f808c5d3650> for transfer request: 0.
2024-07-12 15:10:04,169 DEBUG Acquiring 0
2024-07-12 15:10:04,170 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:10:04,170 DEBUG Releasing acquire 0/None
2024-07-12 15:10:04,171 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:10:04,171 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f808c57cb90>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f808c5d4b50>, 'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}
2024-07-12 15:10:04,173 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:10:04,173 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:10:04,174 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:10:04,174 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:10:04,174 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:10:04,175 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808c59eed0>>
2024-07-12 15:10:04,175 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f808c86fdd0>>
2024-07-12 15:10:04,176 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:10:04,177 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:04,177 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808c59eed0>>
2024-07-12 15:10:04,178 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-006.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:04,179 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:10:04,180 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:04,180 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:04,181 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:10:04,188 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:10:04,189 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:10:04,189 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808c59aa10>>
2024-07-12 15:10:04,189 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:10:04,190 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:10:04,190 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-006.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': '38yWUM01vyO4KwvpQt0LLg==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f808c5d4b50>, 'auth_path': '/dicommetadata/1-006.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-006.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f808c58f2d0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-006.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f808c5d4b50>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-006.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:10:04,192 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:04,192 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f808c58f290>>
2024-07-12 15:10:04,193 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808c86fdd0>>
2024-07-12 15:10:04,193 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:04,194 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:04,194 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808c59aa10>>
2024-07-12 15:10:04,195 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:04,195 DEBUG CanonicalRequest:
PUT
/1-006.dcm

content-md5:38yWUM01vyO4KwvpQt0LLg==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151004Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:04,196 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151004Z
20240712/us-east-1/s3/aws4_request
bac1e70f2adbb4b25e4d4af1020fd5ac8ac0847f19fd1d0f7eae0f6711ca1416
2024-07-12 15:10:04,196 DEBUG Signature:
b54bc286bb5c1800a3c63260ab18d06fccea483fdefbf01c749c96a9cd7a4f98
2024-07-12 15:10:04,197 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:04,198 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:04,198 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-006.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'38yWUM01vyO4KwvpQt0LLg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151004Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=b54bc286bb5c1800a3c63260ab18d06fccea483fdefbf01c749c96a9cd7a4f98', 'amz-sdk-invocation-id': b'ca537abc-3063-4582-89f4-3d889b5f8de2', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:10:04,200 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:04,201 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:10:04,498 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:04,645 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:10:04,646 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:10:04,655 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-006.dcm HTTP/11" 400 None
2024-07-12 15:10:04,656 DEBUG Response headers: {'x-amz-request-id': 'GMEWBATVRYTTP5XN', 'x-amz-id-2': '2LCAEDziJWPu3DsdIo6K2F1OtF3wUF/RcyMVOLr99vJpUAOOHyrAB4Rdl9qCbXRTas8k3oaY2Bc=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:10:05 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:10:04,657 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>GMEWBATVRYTTP5XN</RequestId><HostId>2LCAEDziJWPu3DsdIo6K2F1OtF3wUF/RcyMVOLr99vJpUAOOHyrAB4Rdl9qCbXRTas8k3oaY2Bc=</HostId></Error>'
2024-07-12 15:10:04,660 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808c59a850>
2024-07-12 15:10:04,661 DEBUG No retry needed.
2024-07-12 15:10:04,662 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808c59eed0>>
2024-07-12 15:10:04,662 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:10:04,663 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:04,663 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808c59eed0>>
2024-07-12 15:10:04,664 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-006.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:04,665 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:10:04,666 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-006.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-006.dcm
2024-07-12 15:10:04,667 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:04,668 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:04,669 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:10:04,670 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f808c5d4b50>
2024-07-12 15:10:04,670 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:04,671 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f808c58f290>>
2024-07-12 15:10:04,672 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808c86fdd0>>
2024-07-12 15:10:04,672 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:04,673 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:04,674 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808c59aa10>>
2024-07-12 15:10:04,674 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:04,675 DEBUG CanonicalRequest:
PUT
/1-006.dcm

content-md5:38yWUM01vyO4KwvpQt0LLg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151004Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:04,676 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151004Z
20240712/eu-north-1/s3/aws4_request
db8013def520f3302413dcdaa87c3db42e83feb24cce91fe86db594e8780f8ca
2024-07-12 15:10:04,676 DEBUG Signature:
7fd4685e0eaf706d6ea0f1aed3b57d6fa03c83afb0f317607db52c487943193f
2024-07-12 15:10:04,677 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:04,677 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:04,678 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-006.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'38yWUM01vyO4KwvpQt0LLg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151004Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=7fd4685e0eaf706d6ea0f1aed3b57d6fa03c83afb0f317607db52c487943193f', 'amz-sdk-invocation-id': b'ca537abc-3063-4582-89f4-3d889b5f8de2', 'amz-sdk-request': b'ttl=20240712T151105Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:10:04,679 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:04,680 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:10:04,981 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:05,122 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:10:05,787 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-006.dcm HTTP/11" 200 0
2024-07-12 15:10:05,789 DEBUG Response headers: {'x-amz-id-2': 'PQOk4CKskYyhUtMuTJEYyxlJuxbw97RmwRj779AQac8tCBH71nt+CQ4BD6LC1RYZ/JRiwkwOf4tJF32rz4ffKn1CQGOGsa09', 'x-amz-request-id': 'GMENYH0ETMJGXDDD', 'Date': 'Fri, 12 Jul 2024 15:10:07 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"dfcc9650cd35bf23b82b0be942dd0b2e"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:10:05,790 DEBUG Response body:
b''
2024-07-12 15:10:05,794 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808c59a850>
2024-07-12 15:10:05,796 DEBUG No retry needed.
2024-07-12 15:10:05,799 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808c59eed0>>
2024-07-12 15:10:05,801 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:10:05,808 DEBUG Releasing acquire 0/None
2024-07-12 15:10:05,812 INFO Created new item on mongodb 
2024-07-12 15:10:05,814 INFO {'_id': ObjectId('669147436067cb51e93c9599'), 'FileName': '1-007.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147436067cb51e93c9599'}
2024-07-12 15:10:05,847 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:10:05,852 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:10:05,854 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:10:05,857 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:10:05,858 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:10:05,860 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:10:05,861 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:10:05,864 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:10:05,865 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:10:05,866 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:10:05,867 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:10:05,882 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:10:05,884 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:10:05,911 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:10:05,911 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:10:05,929 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:10:05,958 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:10:05,963 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:10:05,964 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:10:05,965 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f808c5c3ce0>
2024-07-12 15:10:05,965 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:10:05,966 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:10:05,967 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:10:05,967 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:10:05,968 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:10:05,968 DEBUG No configured endpoint found.
2024-07-12 15:10:05,972 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:10:05,975 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:10:05,977 DEBUG Registering retry handlers for service: s3
2024-07-12 15:10:05,977 DEBUG Registering S3 region redirector handler
2024-07-12 15:10:05,979 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:10:05,980 DEBUG Loading s3:s3
2024-07-12 15:10:05,982 DEBUG Loading s3:Bucket
2024-07-12 15:10:05,983 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:05,986 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808c5d8720>
2024-07-12 15:10:05,987 DEBUG Loading s3:Bucket
2024-07-12 15:10:05,987 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:05,991 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808c5d8720>
2024-07-12 15:10:05,992 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:10:05,993 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:10:05,994 DEBUG Acquiring 0
2024-07-12 15:10:05,995 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f807fb8ae10>}) about to wait for the following futures []
2024-07-12 15:10:05,996 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f807fb8ae10>}) done waiting for dependent futures
2024-07-12 15:10:05,997 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f807fb8ae10>}) with kwargs {'client': <botocore.client.S3 object at 0x7f807fb1f550>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f807fb8a090>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f807fb8a150>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f807fb8a650>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f807fb8ae10>}
2024-07-12 15:10:05,999 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f807fb8a650> for transfer request: 0.
2024-07-12 15:10:05,999 DEBUG Acquiring 0
2024-07-12 15:10:06,000 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:10:06,000 DEBUG Releasing acquire 0/None
2024-07-12 15:10:06,001 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:10:06,002 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f807fb1f550>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f807fb8b590>, 'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}
2024-07-12 15:10:06,003 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:10:06,004 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:10:06,004 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:10:06,004 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:10:06,005 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:10:06,005 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f807fb511d0>>
2024-07-12 15:10:06,006 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f807fe34690>>
2024-07-12 15:10:06,006 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:10:06,007 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:06,008 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f807fb511d0>>
2024-07-12 15:10:06,008 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-007.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:06,010 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:10:06,010 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:06,011 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:06,012 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:10:06,019 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:10:06,020 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:10:06,020 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f807fb61610>>
2024-07-12 15:10:06,020 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:10:06,021 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:10:06,022 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-007.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'VIjsqzbI/1jClXbumjJL+g==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f807fb8b590>, 'auth_path': '/dicommetadata/1-007.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-007.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f807fb45cd0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-007.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f807fb8b590>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-007.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:10:06,023 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:06,024 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f807fb45c90>>
2024-07-12 15:10:06,024 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f807fe34690>>
2024-07-12 15:10:06,025 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:06,026 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:06,027 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f807fb61610>>
2024-07-12 15:10:06,027 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:06,028 DEBUG CanonicalRequest:
PUT
/1-007.dcm

content-md5:VIjsqzbI/1jClXbumjJL+g==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151006Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:06,028 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151006Z
20240712/us-east-1/s3/aws4_request
fc30ae46f787a2dc49d6e7da43f182d462f1ef12df4b84f4d1905ff45f8a9a93
2024-07-12 15:10:06,029 DEBUG Signature:
9bd853f923367364756166a6e531533dcebada137f4c863c16de627e3e99f6ee
2024-07-12 15:10:06,029 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:06,030 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:06,031 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-007.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'VIjsqzbI/1jClXbumjJL+g==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151006Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=9bd853f923367364756166a6e531533dcebada137f4c863c16de627e3e99f6ee', 'amz-sdk-invocation-id': b'e08345ce-c10a-4641-8382-e8d75453dedf', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:10:06,032 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:06,032 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:10:06,344 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:06,450 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:10:06,451 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:10:06,462 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-007.dcm HTTP/11" 400 None
2024-07-12 15:10:06,463 DEBUG Response headers: {'x-amz-request-id': 'CSQN7RX9HF3APH7H', 'x-amz-id-2': 'VIvESHwzXc27WnTxR2MqYCGiHgEddiVlsAW4HrRzBZjHje+OrswSQNDvDM/WQypjnTwIPIxXGgc=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:10:08 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:10:06,463 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>CSQN7RX9HF3APH7H</RequestId><HostId>VIvESHwzXc27WnTxR2MqYCGiHgEddiVlsAW4HrRzBZjHje+OrswSQNDvDM/WQypjnTwIPIxXGgc=</HostId></Error>'
2024-07-12 15:10:06,468 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f807fb61390>
2024-07-12 15:10:06,468 DEBUG No retry needed.
2024-07-12 15:10:06,469 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f807fb511d0>>
2024-07-12 15:10:06,470 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:10:06,470 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:06,471 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f807fb511d0>>
2024-07-12 15:10:06,472 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-007.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:06,474 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:10:06,475 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-007.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-007.dcm
2024-07-12 15:10:06,475 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:06,476 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:06,476 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:10:06,478 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f807fb8b590>
2024-07-12 15:10:06,478 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:06,480 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f807fb45c90>>
2024-07-12 15:10:06,480 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f807fe34690>>
2024-07-12 15:10:06,481 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:06,482 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:06,483 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f807fb61610>>
2024-07-12 15:10:06,484 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:06,484 DEBUG CanonicalRequest:
PUT
/1-007.dcm

content-md5:VIjsqzbI/1jClXbumjJL+g==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151006Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:06,485 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151006Z
20240712/eu-north-1/s3/aws4_request
60583a8080e2bb3b4f3b729208354910b3de221b8e182c3d5208b329e8c1c0b9
2024-07-12 15:10:06,486 DEBUG Signature:
4750f3a8055826f3ba196cfe334618e654fa8c0486b6ebe2d23b534a6864e190
2024-07-12 15:10:06,487 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:06,488 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:06,489 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-007.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'VIjsqzbI/1jClXbumjJL+g==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151006Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=4750f3a8055826f3ba196cfe334618e654fa8c0486b6ebe2d23b534a6864e190', 'amz-sdk-invocation-id': b'e08345ce-c10a-4641-8382-e8d75453dedf', 'amz-sdk-request': b'ttl=20240712T151108Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:10:06,490 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:06,491 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:10:06,783 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:06,915 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:10:07,481 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-007.dcm HTTP/11" 200 0
2024-07-12 15:10:07,482 DEBUG Response headers: {'x-amz-id-2': '66bAx6OIMVNe2gkhheQ8jhat6dZjTrM8xi9upTie/iTFpyQUeQHCJi7ftC+iUPp5G/Agfoo4UJ4lCmWV3ZVf02YNzo5YzOc9', 'x-amz-request-id': 'CSQHZT6T7RHC0V4M', 'Date': 'Fri, 12 Jul 2024 15:10:09 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"5488ecab36c8ff58c29576ee9a324bfa"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:10:07,483 DEBUG Response body:
b''
2024-07-12 15:10:07,483 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f807fb61390>
2024-07-12 15:10:07,484 DEBUG No retry needed.
2024-07-12 15:10:07,484 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f807fb511d0>>
2024-07-12 15:10:07,485 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:10:07,487 DEBUG Releasing acquire 0/None
2024-07-12 15:10:07,492 DEBUG Received frame <Basic.Deliver object at 0x7f80addd9730> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:10:07,493 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f80b4cccfd0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:10:07,494 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80ada05210> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:10:07,495 DEBUG Received frame <Basic.Deliver object at 0x7f80addda210> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:10:07,496 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f808f0e9910> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:10:07,497 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f80b40c6f10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:10:07,498 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:07,498 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:07,499 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:07,500 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:07,501 INFO Created new item on mongodb 
2024-07-12 15:10:07,502 INFO {'_id': ObjectId('669147446067cb51e93c959a'), 'FileName': '1-008.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147446067cb51e93c959a'}
2024-07-12 15:10:07,524 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:10:07,530 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:10:07,534 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:10:07,538 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:10:07,539 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:10:07,540 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:10:07,542 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:10:07,547 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:10:07,548 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:10:07,548 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:10:07,550 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:10:07,572 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:10:07,575 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:10:07,609 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:10:07,609 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:10:07,634 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:10:07,682 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:10:07,843 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:10:07,845 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:10:07,845 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80adbf99e0>
2024-07-12 15:10:07,846 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:10:07,847 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:10:07,847 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:10:07,848 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:10:07,848 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:10:07,849 DEBUG No configured endpoint found.
2024-07-12 15:10:07,852 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:10:07,856 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:10:07,857 DEBUG Registering retry handlers for service: s3
2024-07-12 15:10:07,857 DEBUG Registering S3 region redirector handler
2024-07-12 15:10:07,859 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:10:07,860 DEBUG Loading s3:s3
2024-07-12 15:10:07,862 DEBUG Loading s3:Bucket
2024-07-12 15:10:07,863 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:07,864 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808df8cf40>
2024-07-12 15:10:07,865 DEBUG Loading s3:Bucket
2024-07-12 15:10:07,867 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:07,869 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808df8cf40>
2024-07-12 15:10:07,870 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:10:07,871 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:10:07,872 DEBUG Acquiring 0
2024-07-12 15:10:07,873 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80b4d3cbd0>}) about to wait for the following futures []
2024-07-12 15:10:07,874 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80b4d3cbd0>}) done waiting for dependent futures
2024-07-12 15:10:07,875 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80b4d3cbd0>}) with kwargs {'client': <botocore.client.S3 object at 0x7f80b4165b50>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f80b4d6c910>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f80b4d6e7d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f80b4d6e8d0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80b4d3cbd0>}
2024-07-12 15:10:07,878 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f80b4d6e8d0> for transfer request: 0.
2024-07-12 15:10:07,879 DEBUG Acquiring 0
2024-07-12 15:10:07,879 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:10:07,880 DEBUG Releasing acquire 0/None
2024-07-12 15:10:07,880 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:10:07,882 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f80b4165b50>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f80b4d3d3d0>, 'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}
2024-07-12 15:10:07,883 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:10:07,884 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:10:07,884 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:10:07,884 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:10:07,885 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:10:07,886 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80b4186e10>>
2024-07-12 15:10:07,886 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f807f669490>>
2024-07-12 15:10:07,887 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:10:07,888 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:07,889 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80b4186e10>>
2024-07-12 15:10:07,890 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-008.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:07,891 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:10:07,892 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:07,892 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:07,894 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:10:07,903 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:10:07,904 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:10:07,904 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80addfbc90>>
2024-07-12 15:10:07,905 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:10:07,906 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:10:07,906 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-008.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': '5A6qvI+LKRquU7+tQwW4gA==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f80b4d3d3d0>, 'auth_path': '/dicommetadata/1-008.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-008.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f80b4192050>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-008.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f80b4d3d3d0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-008.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:10:07,907 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:07,908 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f80b41646d0>>
2024-07-12 15:10:07,908 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f807f669490>>
2024-07-12 15:10:07,909 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:07,910 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:07,910 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80addfbc90>>
2024-07-12 15:10:07,912 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:07,912 DEBUG CanonicalRequest:
PUT
/1-008.dcm

content-md5:5A6qvI+LKRquU7+tQwW4gA==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151007Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:07,913 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151007Z
20240712/us-east-1/s3/aws4_request
cc7307675fc098c20007c422dd3698e24d7a3734917d63e3c5354b60710e7a1c
2024-07-12 15:10:07,913 DEBUG Signature:
35935dcdb35c213c38b65fab4646af92a9a03843a0319174f8159455a51c9ca6
2024-07-12 15:10:07,914 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:07,915 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:07,916 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-008.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'5A6qvI+LKRquU7+tQwW4gA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151007Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=35935dcdb35c213c38b65fab4646af92a9a03843a0319174f8159455a51c9ca6', 'amz-sdk-invocation-id': b'1e350fd8-01b2-481b-994c-c3db28cfea4d', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:10:07,917 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:07,917 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:10:08,261 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:08,379 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:10:08,380 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:10:08,394 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-008.dcm HTTP/11" 400 None
2024-07-12 15:10:08,396 DEBUG Response headers: {'x-amz-request-id': 'F0PGG1QA9Q0SVY1V', 'x-amz-id-2': '6ojTVV4gfTX8XkoNnZjv9r+pv9odNdOAH18nVLg49ezl9bGa4f5idDelOGHD8w2cvpc/9+KYsm4=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:10:10 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:10:08,396 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>F0PGG1QA9Q0SVY1V</RequestId><HostId>6ojTVV4gfTX8XkoNnZjv9r+pv9odNdOAH18nVLg49ezl9bGa4f5idDelOGHD8w2cvpc/9+KYsm4=</HostId></Error>'
2024-07-12 15:10:08,404 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f80addfa3d0>
2024-07-12 15:10:08,405 DEBUG No retry needed.
2024-07-12 15:10:08,406 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80b4186e10>>
2024-07-12 15:10:08,407 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:10:08,408 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:08,410 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80b4186e10>>
2024-07-12 15:10:08,410 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-008.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:08,412 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:10:08,412 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-008.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-008.dcm
2024-07-12 15:10:08,413 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:08,413 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:08,414 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:10:08,415 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f80b4d3d3d0>
2024-07-12 15:10:08,415 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:08,416 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f80b41646d0>>
2024-07-12 15:10:08,417 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f807f669490>>
2024-07-12 15:10:08,418 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:08,419 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:08,420 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80addfbc90>>
2024-07-12 15:10:08,421 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:08,422 DEBUG CanonicalRequest:
PUT
/1-008.dcm

content-md5:5A6qvI+LKRquU7+tQwW4gA==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151008Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:08,422 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151008Z
20240712/eu-north-1/s3/aws4_request
860fa8ffd651cf5d7af46a7d104c724c8b2de73ac18cc04a5dd9eb417745f2f9
2024-07-12 15:10:08,423 DEBUG Signature:
bbc2dd28543ebf772d8019de6388c4b4a3e7c5fb8a9d02d9d9d662478b0e59af
2024-07-12 15:10:08,424 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:08,425 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:08,426 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-008.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'5A6qvI+LKRquU7+tQwW4gA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151008Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=bbc2dd28543ebf772d8019de6388c4b4a3e7c5fb8a9d02d9d9d662478b0e59af', 'amz-sdk-invocation-id': b'1e350fd8-01b2-481b-994c-c3db28cfea4d', 'amz-sdk-request': b'ttl=20240712T151110Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:10:08,428 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:08,430 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:10:08,734 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:08,863 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:10:09,539 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-008.dcm HTTP/11" 200 0
2024-07-12 15:10:09,540 DEBUG Response headers: {'x-amz-id-2': 'dOUnXxBDZTzXZszVHtrDrktEtkVoLppI4HmBVPXIqhhi6r0iuufsR2O0gPLr58ynEDhOj9PuDm0=', 'x-amz-request-id': 'F0PW62TKSG8JP84R', 'Date': 'Fri, 12 Jul 2024 15:10:11 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"e40eaabc8f8b291aae53bfad4305b880"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:10:09,540 DEBUG Response body:
b''
2024-07-12 15:10:09,541 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f80addfa3d0>
2024-07-12 15:10:09,542 DEBUG No retry needed.
2024-07-12 15:10:09,542 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80b4186e10>>
2024-07-12 15:10:09,543 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:10:09,544 DEBUG Releasing acquire 0/None
2024-07-12 15:10:09,546 INFO Created new item on mongodb 
2024-07-12 15:10:09,546 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:10:09,546 INFO {'_id': ObjectId('669147446067cb51e93c959b'), 'FileName': '1-009.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147446067cb51e93c959b'}
2024-07-12 15:10:09,547 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:09,549 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:09,550 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.0006825500004197238}
2024-07-12 15:10:09,551 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147486067cb51e93c959c\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1101513929, "operationId": 1101513929, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:09,552 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 1.716, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147486067cb51e93c959c\"}, \"FileName\": \"1-010.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1101513929, "operationId": 1101513929, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:09,553 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 15:10:09,568 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:10:09,572 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:10:09,574 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:10:09,577 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:10:09,578 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:10:09,580 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:10:09,582 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:10:09,586 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:10:09,586 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:10:09,587 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:10:09,588 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:10:09,606 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:10:09,608 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:10:09,634 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:10:09,635 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:10:09,658 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:10:09,685 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:10:09,692 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:10:09,694 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:10:09,695 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80adcab7e0>
2024-07-12 15:10:09,695 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:10:09,696 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:10:09,696 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:10:09,697 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:10:09,697 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:10:09,698 DEBUG No configured endpoint found.
2024-07-12 15:10:09,702 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:10:09,705 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:10:09,706 DEBUG Registering retry handlers for service: s3
2024-07-12 15:10:09,707 DEBUG Registering S3 region redirector handler
2024-07-12 15:10:09,708 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:10:09,709 DEBUG Loading s3:s3
2024-07-12 15:10:09,711 DEBUG Loading s3:Bucket
2024-07-12 15:10:09,711 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:09,712 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80adcaab60>
2024-07-12 15:10:09,713 DEBUG Loading s3:Bucket
2024-07-12 15:10:09,713 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:09,715 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80adcaab60>
2024-07-12 15:10:09,715 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:10:09,716 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:10:09,717 DEBUG Acquiring 0
2024-07-12 15:10:09,717 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80b4447550>}) about to wait for the following futures []
2024-07-12 15:10:09,718 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80b4447550>}) done waiting for dependent futures
2024-07-12 15:10:09,718 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80b4447550>}) with kwargs {'client': <botocore.client.S3 object at 0x7f80adfd69d0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f80b4cce1d0>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f80b4d493d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f80b4446e50>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80b4447550>}
2024-07-12 15:10:09,721 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f80b4446e50> for transfer request: 0.
2024-07-12 15:10:09,722 DEBUG Acquiring 0
2024-07-12 15:10:09,723 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:10:09,724 DEBUG Releasing acquire 0/None
2024-07-12 15:10:09,724 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:10:09,725 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f80adfd69d0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f80b4444510>, 'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}
2024-07-12 15:10:09,727 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:10:09,728 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:10:09,729 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:10:09,729 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:10:09,730 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:10:09,730 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80adf4f810>>
2024-07-12 15:10:09,731 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f808f114dd0>>
2024-07-12 15:10:09,731 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:10:09,732 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:09,733 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80adf4f810>>
2024-07-12 15:10:09,734 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-009.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:09,735 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:10:09,736 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:09,736 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:09,737 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:10:09,743 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:10:09,743 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:10:09,744 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80b43d8510>>
2024-07-12 15:10:09,744 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:10:09,744 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:10:09,745 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-009.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': '2Un3Bodl+8DSgTyPKODS7Q==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f80b4444510>, 'auth_path': '/dicommetadata/1-009.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-009.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f80adff1050>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-009.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f80b4444510>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-009.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:10:09,746 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:09,746 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f80adff1010>>
2024-07-12 15:10:09,747 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808f114dd0>>
2024-07-12 15:10:09,748 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:09,750 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:09,751 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80b43d8510>>
2024-07-12 15:10:09,753 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:09,753 DEBUG CanonicalRequest:
PUT
/1-009.dcm

content-md5:2Un3Bodl+8DSgTyPKODS7Q==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151009Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:09,754 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151009Z
20240712/us-east-1/s3/aws4_request
cd49515b5592005f81ff5a7951326a6497953cdb184ce82a8f692afed98fbde8
2024-07-12 15:10:09,754 DEBUG Signature:
30161ad897b957bb99ce79a59015add2479808cd0ca375e1d0a4ea59e7ce7bf2
2024-07-12 15:10:09,755 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:09,756 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:09,757 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-009.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'2Un3Bodl+8DSgTyPKODS7Q==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151009Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=30161ad897b957bb99ce79a59015add2479808cd0ca375e1d0a4ea59e7ce7bf2', 'amz-sdk-invocation-id': b'57836b06-c108-4c05-97aa-5646ecf02481', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:10:09,758 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:09,759 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:10:09,955 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:10,067 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:10:10,068 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:10:10,081 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-009.dcm HTTP/11" 400 None
2024-07-12 15:10:10,082 DEBUG Response headers: {'x-amz-request-id': 'KJ52TWZWBSFA57S5', 'x-amz-id-2': 'G33H+jMYkA1Gfv6MH397ntWkgKnsMExRBo7GasCLrlT02ohPDoLNG7X+KfHt3EPjRUjGNSShqtI=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:10:11 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:10:10,082 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>KJ52TWZWBSFA57S5</RequestId><HostId>G33H+jMYkA1Gfv6MH397ntWkgKnsMExRBo7GasCLrlT02ohPDoLNG7X+KfHt3EPjRUjGNSShqtI=</HostId></Error>'
2024-07-12 15:10:10,088 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f80b43d8290>
2024-07-12 15:10:10,088 DEBUG No retry needed.
2024-07-12 15:10:10,089 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80adf4f810>>
2024-07-12 15:10:10,089 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:10:10,090 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:10,091 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80adf4f810>>
2024-07-12 15:10:10,092 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-009.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:10,095 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:10:10,096 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-009.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-009.dcm
2024-07-12 15:10:10,097 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:10,098 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:10,099 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:10:10,100 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f80b4444510>
2024-07-12 15:10:10,101 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:10,102 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f80adff1010>>
2024-07-12 15:10:10,103 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808f114dd0>>
2024-07-12 15:10:10,103 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:10,104 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:10,105 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f80b43d8510>>
2024-07-12 15:10:10,106 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:10,107 DEBUG CanonicalRequest:
PUT
/1-009.dcm

content-md5:2Un3Bodl+8DSgTyPKODS7Q==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151010Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:10,108 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151010Z
20240712/eu-north-1/s3/aws4_request
fbf12efa4e5468fe396bfc00949ea7453c4c44b9e224d45484882d32a56259a7
2024-07-12 15:10:10,109 DEBUG Signature:
ac0cf20e8a9f81db6fbd63d67c223b3c8b602aeb1d2652031bff15e33b322b1f
2024-07-12 15:10:10,110 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:10,111 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:10,112 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-009.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'2Un3Bodl+8DSgTyPKODS7Q==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151010Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=ac0cf20e8a9f81db6fbd63d67c223b3c8b602aeb1d2652031bff15e33b322b1f', 'amz-sdk-invocation-id': b'57836b06-c108-4c05-97aa-5646ecf02481', 'amz-sdk-request': b'ttl=20240712T151111Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:10:10,114 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:10,114 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:10:10,296 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:10,432 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:10:11,018 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-009.dcm HTTP/11" 200 0
2024-07-12 15:10:11,019 DEBUG Response headers: {'x-amz-id-2': 'fZ90+ApgZj2vAn1GYb/5kEAGRutGgkAZqNX+GPOCr867pZ39Sdjw2nQenKbKAZdvKNvwng4J70I=', 'x-amz-request-id': 'KJ5DRH4MMAEGB51M', 'Date': 'Fri, 12 Jul 2024 15:10:13 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"d949f7068765fbc0d2813c8f28e0d2ed"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:10:11,019 DEBUG Response body:
b''
2024-07-12 15:10:11,020 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f80b43d8290>
2024-07-12 15:10:11,021 DEBUG No retry needed.
2024-07-12 15:10:11,021 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f80adf4f810>>
2024-07-12 15:10:11,022 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:10:11,024 DEBUG Releasing acquire 0/None
2024-07-12 15:10:11,034 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:11,034 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:11,043 INFO Message received
2024-07-12 15:10:11,044 INFO {'type': 'file_dowloaded', 'file_name': '1-011.dcm'}
2024-07-12 15:10:11,060 INFO Message received
2024-07-12 15:10:11,060 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:10:11,061 INFO {'type': 'file_dowloaded', 'file_name': '1-012.dcm'}
2024-07-12 15:10:11,062 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:11,063 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:11,064 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.0006992329999775393}
2024-07-12 15:10:11,065 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-011.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147536067cb51e93c959d\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1801979802, "operationId": 1801979802, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:11,067 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 2.538, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1801979802, "operationId": 1801979802, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:11,069 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 15:10:11,082 INFO Created new item on mongodb 
2024-07-12 15:10:11,082 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:10:11,083 INFO {'_id': ObjectId('669147486067cb51e93c959c'), 'FileName': '1-010.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147486067cb51e93c959c'}
2024-07-12 15:10:11,084 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f80b6559120>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:11,086 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:11,086 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.000799974000074144}
2024-07-12 15:10:11,088 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-012.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669147536067cb51e93c959e\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1315634022, "operationId": 1315634022, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:11,090 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 1.863, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1315634022, "operationId": 1315634022, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:11,090 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 15:10:11,107 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:10:11,111 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:10:11,112 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:10:11,115 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:10:11,116 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:10:11,119 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:10:11,121 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:10:11,126 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:10:11,127 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:10:11,127 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:10:11,128 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:10:11,145 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:10:11,148 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:10:11,171 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:10:11,172 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:10:11,195 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:10:11,222 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:10:11,227 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:10:11,230 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:10:11,231 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80adcab240>
2024-07-12 15:10:11,231 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:10:11,233 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:10:11,233 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:10:11,234 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:10:11,234 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:10:11,235 DEBUG No configured endpoint found.
2024-07-12 15:10:11,238 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:10:11,241 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:10:11,242 DEBUG Registering retry handlers for service: s3
2024-07-12 15:10:11,243 DEBUG Registering S3 region redirector handler
2024-07-12 15:10:11,244 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:10:11,245 DEBUG Loading s3:s3
2024-07-12 15:10:11,247 DEBUG Loading s3:Bucket
2024-07-12 15:10:11,247 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:11,250 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808c5c3d80>
2024-07-12 15:10:11,251 DEBUG Loading s3:Bucket
2024-07-12 15:10:11,251 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:11,253 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808c5c3d80>
2024-07-12 15:10:11,254 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:10:11,254 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:10:11,255 DEBUG Acquiring 0
2024-07-12 15:10:11,256 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808f4c6510>}) about to wait for the following futures []
2024-07-12 15:10:11,257 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808f4c6510>}) done waiting for dependent futures
2024-07-12 15:10:11,257 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808f4c6510>}) with kwargs {'client': <botocore.client.S3 object at 0x7f808f477590>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f808f4c5550>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f808f4c5890>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f808f4c5ad0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808f4c6510>}
2024-07-12 15:10:11,260 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f808f4c5ad0> for transfer request: 0.
2024-07-12 15:10:11,260 DEBUG Acquiring 0
2024-07-12 15:10:11,261 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:10:11,261 DEBUG Releasing acquire 0/None
2024-07-12 15:10:11,261 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:10:11,262 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f808f477590>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f808f4c6d10>, 'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}
2024-07-12 15:10:11,266 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:10:11,267 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:10:11,267 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:10:11,267 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:10:11,269 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:10:11,270 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808f49ffd0>>
2024-07-12 15:10:11,270 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f808f2e5a90>>
2024-07-12 15:10:11,271 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:10:11,272 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:11,273 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808f49ffd0>>
2024-07-12 15:10:11,274 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-010.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:11,275 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:10:11,276 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:11,277 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:11,278 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:10:11,284 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:10:11,284 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:10:11,285 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808f4a8cd0>>
2024-07-12 15:10:11,285 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:10:11,285 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:10:11,286 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-010.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': '1dhBQQ8LsD6zPMVdN2NLIA==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f808f4c6d10>, 'auth_path': '/dicommetadata/1-010.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-010.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f808f48dcd0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-010.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f808f4c6d10>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-010.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:10:11,287 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:11,288 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f808f48dc90>>
2024-07-12 15:10:11,288 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808f2e5a90>>
2024-07-12 15:10:11,290 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:11,291 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:11,291 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808f4a8cd0>>
2024-07-12 15:10:11,293 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:11,293 DEBUG CanonicalRequest:
PUT
/1-010.dcm

content-md5:1dhBQQ8LsD6zPMVdN2NLIA==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151011Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:11,294 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151011Z
20240712/us-east-1/s3/aws4_request
f12b3344288c223297053d7a9ec1d7099df340a04951d33198adc2e5db6626fe
2024-07-12 15:10:11,295 DEBUG Signature:
851e935e9d624250fc222dc05e6ef4346201d8bc6921bff60ea41e6b4fce59dc
2024-07-12 15:10:11,295 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:11,296 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:11,297 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-010.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'1dhBQQ8LsD6zPMVdN2NLIA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151011Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=851e935e9d624250fc222dc05e6ef4346201d8bc6921bff60ea41e6b4fce59dc', 'amz-sdk-invocation-id': b'd7de9932-60f7-4f21-9ca2-063026fecacd', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:10:11,298 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:11,299 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:10:11,484 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:11,605 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:10:11,606 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:10:11,614 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-010.dcm HTTP/11" 400 None
2024-07-12 15:10:11,615 DEBUG Response headers: {'x-amz-request-id': '48XFGV08F0QQ0TRX', 'x-amz-id-2': 'vQ9ZGLIEzPMYdFpzbeiyG2AbwR9DzaNKq3onFIVj412F6Gluaq43h0GqCmzExrn3mBbuHkjPRac=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:10:13 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:10:11,616 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>48XFGV08F0QQ0TRX</RequestId><HostId>vQ9ZGLIEzPMYdFpzbeiyG2AbwR9DzaNKq3onFIVj412F6Gluaq43h0GqCmzExrn3mBbuHkjPRac=</HostId></Error>'
2024-07-12 15:10:11,620 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808f4a8a50>
2024-07-12 15:10:11,620 DEBUG No retry needed.
2024-07-12 15:10:11,621 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808f49ffd0>>
2024-07-12 15:10:11,622 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:10:11,622 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:11,623 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808f49ffd0>>
2024-07-12 15:10:11,624 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-010.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:11,625 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:10:11,625 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-010.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-010.dcm
2024-07-12 15:10:11,626 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:11,627 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:11,627 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:10:11,628 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f808f4c6d10>
2024-07-12 15:10:11,629 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:11,629 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f808f48dc90>>
2024-07-12 15:10:11,630 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f808f2e5a90>>
2024-07-12 15:10:11,630 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:11,631 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:11,631 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808f4a8cd0>>
2024-07-12 15:10:11,632 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:11,633 DEBUG CanonicalRequest:
PUT
/1-010.dcm

content-md5:1dhBQQ8LsD6zPMVdN2NLIA==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151011Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:11,633 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151011Z
20240712/eu-north-1/s3/aws4_request
d51cc325f2c4b2db2b4fab5b14fe6ac66f143dcfa687916298f71d788a6dfad1
2024-07-12 15:10:11,634 DEBUG Signature:
d52deba21a2a343a3a488babd7cc3e3b08c9eada0961f55a5b3784cf5e5e5f9e
2024-07-12 15:10:11,635 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:11,635 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:11,636 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-010.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'1dhBQQ8LsD6zPMVdN2NLIA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151011Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=d52deba21a2a343a3a488babd7cc3e3b08c9eada0961f55a5b3784cf5e5e5f9e', 'amz-sdk-invocation-id': b'd7de9932-60f7-4f21-9ca2-063026fecacd', 'amz-sdk-request': b'ttl=20240712T151113Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:10:11,637 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:11,638 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:10:11,815 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:11,934 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:10:12,527 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-010.dcm HTTP/11" 200 0
2024-07-12 15:10:12,528 DEBUG Response headers: {'x-amz-id-2': 'Faz4Yu4rDRojbGRL6i7sM2RiwgYZgSImtuOTe+L/oCbbh++AnbqxT8M0OhdTPpLQ6oupplGGnjc=', 'x-amz-request-id': 'AEGXFY3QKJQEKMX1', 'Date': 'Fri, 12 Jul 2024 15:10:15 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"d5d841410f0bb03eb33cc55d37634b20"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:10:12,529 DEBUG Response body:
b''
2024-07-12 15:10:12,530 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808f4a8a50>
2024-07-12 15:10:12,531 DEBUG No retry needed.
2024-07-12 15:10:12,531 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808f49ffd0>>
2024-07-12 15:10:12,532 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:10:12,533 DEBUG Releasing acquire 0/None
2024-07-12 15:10:12,534 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:12,536 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:10:12,538 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:12,538 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}}
2024-07-12 15:10:12,539 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:12,540 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 669147226067cb51e93c9592, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0013759610638844609>]>", "clientId": {"$oid": "669147226067cb51e93c9592"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:12,541 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.0015507240000260936}
2024-07-12 15:10:12,542 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:12,543 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147536067cb51e93c959d\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"cp9WjUpsTyCtyqS5EKghrA==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 635723058, "operationId": 635723058, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:12,544 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0018772410003293771}
2024-07-12 15:10:12,546 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669147536067cb51e93c959e\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"YZAXfAoORy2vjuRHJSWN+Q==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1369133069, "operationId": 1369133069, "driverConnectionId": 5, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:12,546 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 2.917, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147536067cb51e93c959d\"}, \"FileName\": \"1-011.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 635723058, "operationId": 635723058, "driverConnectionId": 4, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:12,547 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 15:10:12,548 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Command succeeded", "durationMS": 2.415, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669147536067cb51e93c959e\"}, \"FileName\": \"1-012.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1369133069, "operationId": 1369133069, "driverConnectionId": 5, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:10:12,549 INFO Created new item on mongodb 
2024-07-12 15:10:12,549 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 15:10:12,550 INFO {'_id': ObjectId('669147536067cb51e93c959d'), 'FileName': '1-011.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147536067cb51e93c959d'}
2024-07-12 15:10:12,575 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:10:12,579 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:10:12,580 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:10:12,584 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:10:12,584 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:10:12,586 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:10:12,588 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:10:12,591 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:10:12,592 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:10:12,592 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:10:12,593 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:10:12,611 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:10:12,614 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:10:12,637 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:10:12,638 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:10:12,660 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:10:12,700 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:10:12,890 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:10:12,893 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:10:12,894 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80adcab380>
2024-07-12 15:10:12,895 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:10:12,896 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:10:12,896 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:10:12,896 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:10:12,897 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:10:12,897 DEBUG No configured endpoint found.
2024-07-12 15:10:12,901 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:10:12,904 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:10:12,905 DEBUG Registering retry handlers for service: s3
2024-07-12 15:10:12,906 DEBUG Registering S3 region redirector handler
2024-07-12 15:10:12,907 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:10:12,908 DEBUG Loading s3:s3
2024-07-12 15:10:12,910 DEBUG Loading s3:Bucket
2024-07-12 15:10:12,910 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:12,912 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808df8db20>
2024-07-12 15:10:12,912 DEBUG Loading s3:Bucket
2024-07-12 15:10:12,913 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:12,915 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f808df8db20>
2024-07-12 15:10:12,916 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:10:12,916 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:10:12,917 DEBUG Acquiring 0
2024-07-12 15:10:12,918 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808f64dc10>}) about to wait for the following futures []
2024-07-12 15:10:12,919 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808f64dc10>}) done waiting for dependent futures
2024-07-12 15:10:12,919 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808f64dc10>}) with kwargs {'client': <botocore.client.S3 object at 0x7f808f5d4550>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f808f64d050>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f808f64d150>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f808f64e190>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f808f64dc10>}
2024-07-12 15:10:12,922 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f808f64e190> for transfer request: 0.
2024-07-12 15:10:12,922 DEBUG Acquiring 0
2024-07-12 15:10:12,923 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:10:12,923 DEBUG Releasing acquire 0/None
2024-07-12 15:10:12,924 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:10:12,925 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f808f5d4550>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f808f64e5d0>, 'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}
2024-07-12 15:10:12,926 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:10:12,926 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:10:12,927 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:10:12,927 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:10:12,928 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:10:12,929 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808f6649d0>>
2024-07-12 15:10:12,929 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f807efd98d0>>
2024-07-12 15:10:12,930 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:10:12,931 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:12,932 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808f6649d0>>
2024-07-12 15:10:12,933 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-011.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:12,937 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:10:12,939 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:12,947 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:12,967 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:10:12,995 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:10:13,009 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:10:13,016 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808f66c0d0>>
2024-07-12 15:10:13,020 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:10:13,021 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:10:13,022 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-011.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'dqv840tj0UI8b/t5tQ13fg==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f808f64e5d0>, 'auth_path': '/dicommetadata/1-011.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-011.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f80b4407f10>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-011.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f808f64e5d0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-011.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:10:13,023 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:13,024 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f80b4407fd0>>
2024-07-12 15:10:13,025 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f807efd98d0>>
2024-07-12 15:10:13,025 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:13,026 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:13,026 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808f66c0d0>>
2024-07-12 15:10:13,027 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:13,028 DEBUG CanonicalRequest:
PUT
/1-011.dcm

content-md5:dqv840tj0UI8b/t5tQ13fg==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151013Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:13,029 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151013Z
20240712/us-east-1/s3/aws4_request
5367f29539bb0f6f9933a082b10a3d448c2590630e58977b30a0a08b00861c46
2024-07-12 15:10:13,030 DEBUG Signature:
7fe9bc27fdc162afaffabc545667f730868e0c71b4d27d52f1b9672bcf428bf8
2024-07-12 15:10:13,030 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:13,031 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:13,031 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-011.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'dqv840tj0UI8b/t5tQ13fg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151013Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=7fe9bc27fdc162afaffabc545667f730868e0c71b4d27d52f1b9672bcf428bf8', 'amz-sdk-invocation-id': b'd19ba9fa-e329-434a-8c3d-223a5a4a03bd', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:10:13,033 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:13,033 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:10:13,288 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:13,405 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:10:13,406 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:10:13,416 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-011.dcm HTTP/11" 400 None
2024-07-12 15:10:13,417 DEBUG Response headers: {'x-amz-request-id': 'G3ACNX63TCMMDN45', 'x-amz-id-2': 'cc+LBrfNoMuhZiqkMihD98/yfWAErUOr3sCrrvzToVDLBeBoM0xmNlxfz6NJL+l/OS314o5KcCs=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:10:15 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:10:13,417 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>G3ACNX63TCMMDN45</RequestId><HostId>cc+LBrfNoMuhZiqkMihD98/yfWAErUOr3sCrrvzToVDLBeBoM0xmNlxfz6NJL+l/OS314o5KcCs=</HostId></Error>'
2024-07-12 15:10:13,421 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808f66c850>
2024-07-12 15:10:13,421 DEBUG No retry needed.
2024-07-12 15:10:13,422 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808f6649d0>>
2024-07-12 15:10:13,422 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:10:13,423 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:13,423 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808f6649d0>>
2024-07-12 15:10:13,424 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-011.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:13,425 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:10:13,426 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-011.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-011.dcm
2024-07-12 15:10:13,426 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:13,427 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:13,428 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:10:13,429 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f808f64e5d0>
2024-07-12 15:10:13,430 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:13,430 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f80b4407fd0>>
2024-07-12 15:10:13,431 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f807efd98d0>>
2024-07-12 15:10:13,431 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:13,432 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:13,433 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f808f66c0d0>>
2024-07-12 15:10:13,434 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:13,434 DEBUG CanonicalRequest:
PUT
/1-011.dcm

content-md5:dqv840tj0UI8b/t5tQ13fg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151013Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:13,435 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151013Z
20240712/eu-north-1/s3/aws4_request
b4ebb0dba6a734a84ad58f8315237e5725c838090b29391c7b5a6edfcf848135
2024-07-12 15:10:13,435 DEBUG Signature:
66861c543b0396ecfb92229e70983641cfc300b437a09efe6c0235fa8b4699eb
2024-07-12 15:10:13,436 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:13,437 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:13,438 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-011.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'dqv840tj0UI8b/t5tQ13fg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151013Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=66861c543b0396ecfb92229e70983641cfc300b437a09efe6c0235fa8b4699eb', 'amz-sdk-invocation-id': b'd19ba9fa-e329-434a-8c3d-223a5a4a03bd', 'amz-sdk-request': b'ttl=20240712T151115Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:10:13,439 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:13,440 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:10:13,703 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:13,828 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:10:14,462 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-011.dcm HTTP/11" 200 0
2024-07-12 15:10:14,462 DEBUG Response headers: {'x-amz-id-2': 'zdq+iZ7ch4sIzbYGu0bdlamFMMrPsUIrF0TYCuMQjIWXl4DgYBL86Ri4vZKcIutN1EFpc/rZgLs=', 'x-amz-request-id': 'FVWGY7JQF9FZSXA8', 'Date': 'Fri, 12 Jul 2024 15:10:17 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"76abfce34b63d1423c6ffb79b50d777e"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:10:14,463 DEBUG Response body:
b''
2024-07-12 15:10:14,464 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f808f66c850>
2024-07-12 15:10:14,465 DEBUG No retry needed.
2024-07-12 15:10:14,465 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f808f6649d0>>
2024-07-12 15:10:14,466 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:10:14,468 DEBUG Releasing acquire 0/None
2024-07-12 15:10:14,469 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:14,471 INFO Created new item on mongodb 
2024-07-12 15:10:14,472 INFO {'_id': ObjectId('669147536067cb51e93c959e'), 'FileName': '1-012.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669147536067cb51e93c959e'}
2024-07-12 15:10:14,500 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 15:10:14,504 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 15:10:14,506 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 15:10:14,509 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 15:10:14,510 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 15:10:14,512 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 15:10:14,514 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 15:10:14,518 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 15:10:14,519 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 15:10:14,519 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 15:10:14,520 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 15:10:14,536 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 15:10:14,539 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 15:10:14,561 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 15:10:14,562 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f80b53fb880>
2024-07-12 15:10:14,585 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 15:10:14,610 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 15:10:14,616 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 15:10:14,618 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f80b537d3a0>
2024-07-12 15:10:14,619 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f80b4cf5e40>
2024-07-12 15:10:14,619 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f80b537d120>
2024-07-12 15:10:14,620 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 15:10:14,621 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 15:10:14,621 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 15:10:14,622 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 15:10:14,622 DEBUG No configured endpoint found.
2024-07-12 15:10:14,624 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 15:10:14,630 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 15:10:14,631 DEBUG Registering retry handlers for service: s3
2024-07-12 15:10:14,632 DEBUG Registering S3 region redirector handler
2024-07-12 15:10:14,633 DEBUG Registering S3Express Identity Resolver
2024-07-12 15:10:14,634 DEBUG Loading s3:s3
2024-07-12 15:10:14,636 DEBUG Loading s3:Bucket
2024-07-12 15:10:14,636 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:14,638 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80b4cf67a0>
2024-07-12 15:10:14,638 DEBUG Loading s3:Bucket
2024-07-12 15:10:14,638 DEBUG Renaming Bucket attribute name
2024-07-12 15:10:14,640 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f80b4cf67a0>
2024-07-12 15:10:14,641 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 15:10:14,641 DEBUG Using default client. pid: 1, thread: 140190819813184
2024-07-12 15:10:14,642 DEBUG Acquiring 0
2024-07-12 15:10:14,643 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80ade2f110>}) about to wait for the following futures []
2024-07-12 15:10:14,643 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80ade2f110>}) done waiting for dependent futures
2024-07-12 15:10:14,644 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80ade2f110>}) with kwargs {'client': <botocore.client.S3 object at 0x7f807fb901d0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f80ade2eb90>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f808f62bc10>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f80ade2f390>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f80ade2f110>}
2024-07-12 15:10:14,646 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f80ade2f390> for transfer request: 0.
2024-07-12 15:10:14,646 DEBUG Acquiring 0
2024-07-12 15:10:14,647 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 15:10:14,648 DEBUG Releasing acquire 0/None
2024-07-12 15:10:14,648 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 15:10:14,650 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f807fb901d0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f80ade2dfd0>, 'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}
2024-07-12 15:10:14,652 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f80b53e3060>
2024-07-12 15:10:14,653 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f80b53e2340>
2024-07-12 15:10:14,653 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f80b53e3a60>
2024-07-12 15:10:14,653 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f80b53e22a0>
2024-07-12 15:10:14,654 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f80b52584a0>
2024-07-12 15:10:14,655 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f807f675c90>>
2024-07-12 15:10:14,655 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f80b428f0d0>>
2024-07-12 15:10:14,656 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f80b53e20c0>
2024-07-12 15:10:14,656 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:14,657 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f807f675c90>>
2024-07-12 15:10:14,657 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-012.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:14,659 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 15:10:14,659 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:14,660 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:14,661 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f80b55419e0>
2024-07-12 15:10:14,667 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f80b53e2660>
2024-07-12 15:10:14,667 DEBUG Adding expect 100 continue header to request.
2024-07-12 15:10:14,668 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f807f668f90>>
2024-07-12 15:10:14,668 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f80b53e0900>
2024-07-12 15:10:14,669 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f80b53e3ba0>
2024-07-12 15:10:14,669 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-012.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'SoFGhUVDDYf+OWLaIOfo1Q==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f80ade2dfd0>, 'auth_path': '/dicommetadata/1-012.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-012.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f807fb8bc10>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-012.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f80ade2dfd0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-012.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 15:10:14,670 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:14,671 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f807fb8b690>>
2024-07-12 15:10:14,672 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f80b428f0d0>>
2024-07-12 15:10:14,672 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:14,673 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:14,673 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f807f668f90>>
2024-07-12 15:10:14,675 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:14,675 DEBUG CanonicalRequest:
PUT
/1-012.dcm

content-md5:SoFGhUVDDYf+OWLaIOfo1Q==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151014Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:14,676 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151014Z
20240712/us-east-1/s3/aws4_request
1d9311b7613e86749227c94c7a9d86fdf7cf7c823e7abe1adfbd5283d735f396
2024-07-12 15:10:14,677 DEBUG Signature:
ecf741c66adb4c66fccdaa0fbd1b65478eeda613c58bb35e515638d47bc0af67
2024-07-12 15:10:14,678 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:14,678 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:14,679 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-012.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'SoFGhUVDDYf+OWLaIOfo1Q==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151014Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=ecf741c66adb4c66fccdaa0fbd1b65478eeda613c58bb35e515638d47bc0af67', 'amz-sdk-invocation-id': b'462c98e0-a87a-4250-8bca-d7b1188c19fc', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 15:10:14,680 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:14,681 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 15:10:14,865 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:14,985 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 15:10:14,986 DEBUG send() called, but response already received. Not sending data.
2024-07-12 15:10:14,999 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-012.dcm HTTP/11" 400 None
2024-07-12 15:10:15,000 DEBUG Response headers: {'x-amz-request-id': '32VATHE8982XDGZX', 'x-amz-id-2': 'ONKyvHGiImERIi1sAW9HExCJgqczt/wOmwR2Ik/HU8YVei6fl0Xh3PORDYmICb7RV1XLvAF01mk=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 15:10:17 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 15:10:15,001 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>32VATHE8982XDGZX</RequestId><HostId>ONKyvHGiImERIi1sAW9HExCJgqczt/wOmwR2Ik/HU8YVei6fl0Xh3PORDYmICb7RV1XLvAF01mk=</HostId></Error>'
2024-07-12 15:10:15,008 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f807f669210>
2024-07-12 15:10:15,009 DEBUG No retry needed.
2024-07-12 15:10:15,009 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f807f675c90>>
2024-07-12 15:10:15,010 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 15:10:15,011 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f80b5258680>
2024-07-12 15:10:15,011 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f807f675c90>>
2024-07-12 15:10:15,012 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-012.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 15:10:15,014 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 15:10:15,014 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-012.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-012.dcm
2024-07-12 15:10:15,014 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 15:10:15,015 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 15:10:15,015 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 15:10:15,017 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f80ade2dfd0>
2024-07-12 15:10:15,017 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f80adbd8900>
2024-07-12 15:10:15,019 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f807fb8b690>>
2024-07-12 15:10:15,019 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f80b428f0d0>>
2024-07-12 15:10:15,020 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f80b53e1f80>
2024-07-12 15:10:15,021 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f80b52585e0>
2024-07-12 15:10:15,021 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f807f668f90>>
2024-07-12 15:10:15,022 DEBUG Calculating signature using v4 auth.
2024-07-12 15:10:15,023 DEBUG CanonicalRequest:
PUT
/1-012.dcm

content-md5:SoFGhUVDDYf+OWLaIOfo1Q==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T151015Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 15:10:15,023 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T151015Z
20240712/eu-north-1/s3/aws4_request
d53c0cf5de6abaea20a4220e2176c244a640b5cd2f2cbf1cd678361fc8dac8ff
2024-07-12 15:10:15,024 DEBUG Signature:
5b43232c950283b7af76b30bc4801b17b96c123fc151adbcc6581abc71216d7e
2024-07-12 15:10:15,025 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f80adbd89a0>
2024-07-12 15:10:15,025 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f80b5258400>
2024-07-12 15:10:15,026 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-012.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'SoFGhUVDDYf+OWLaIOfo1Q==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T151015Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=5b43232c950283b7af76b30bc4801b17b96c123fc151adbcc6581abc71216d7e', 'amz-sdk-invocation-id': b'462c98e0-a87a-4250-8bca-d7b1188c19fc', 'amz-sdk-request': b'ttl=20240712T151117Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 15:10:15,028 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 15:10:15,029 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 15:10:15,213 DEBUG Waiting for 100 Continue response.
2024-07-12 15:10:15,350 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 15:10:18,753 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-012.dcm HTTP/11" 200 0
2024-07-12 15:10:18,754 DEBUG Response headers: {'x-amz-id-2': 'rh6kRuke12NxMqhvN3VITh0SnNKRhx2Fr36PcRVwZI8y6B6VcokxsDBSGo/owtsfkAEMDIv9liA=', 'x-amz-request-id': '32VDZC3DEQHCWQBN', 'Date': 'Fri, 12 Jul 2024 15:10:18 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"4a81468545430d87fe3962da20e7e8d5"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 15:10:18,754 DEBUG Response body:
b''
2024-07-12 15:10:18,755 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f807f669210>
2024-07-12 15:10:18,756 DEBUG No retry needed.
2024-07-12 15:10:18,756 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f807f675c90>>
2024-07-12 15:10:18,757 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 15:10:18,758 DEBUG Releasing acquire 0/None
2024-07-12 15:10:18,761 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 15:10:28,626 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:10:58,004 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f80adc54510> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:10:59,617 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:10:17,341 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f80b4d2f1d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:10:19,105 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:11:40,430 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:11:40,431 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "reason": "Connection pool was stale", "error": "stale"}
2024-07-12 15:11:40,432 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "reason": "Connection pool was stale", "error": "stale"}
2024-07-12 15:11:40,433 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "reason": "Connection pool was stale", "error": "stale"}
2024-07-12 15:11:40,434 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "reason": "Connection pool was stale", "error": "stale"}
2024-07-12 15:11:40,435 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "reason": "Connection pool was stale", "error": "stale"}
2024-07-12 15:11:40,439 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:11:58,532 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f808f0e9910> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:12:00,440 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:12:29,412 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f80adc9fa90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:12:31,613 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:13:01,853 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f80b4d56290> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:13:04,350 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:13:32,498 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f80b730f690> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:13:35,145 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:14:03,124 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f80b4d2f1d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:14:05,772 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:14:34,116 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f808f0e9910> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:14:36,908 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:15:03,607 DEBUG {"clientId": {"$oid": "669147226067cb51e93c9592"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 15:15:06,559 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f80adc9fa90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f80b4cc9c20>
2024-07-12 15:15:09,642 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:16:16,908 INFO Starting consumer...
2024-07-12 15:16:16,909 DEBUG Using selector: EpollSelector
2024-07-12 15:16:16,910 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:16:16,911 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:16:16,911 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:16:16,912 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 15:16:16,919 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:16:16,920 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:16:16,921 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7faf18879850>
2024-07-12 15:16:16,922 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 15:16:16,924 DEBUG Received frame <Channel.OpenOk object at 0x7faf15fab990> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7faf15fcdc70>
2024-07-12 15:16:16,925 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:16:16,926 DEBUG Received frame <Confirm.SelectOk object at 0x7faf16344a10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7faf15fcdc70>
2024-07-12 15:16:16,928 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:16:16,929 DEBUG Received frame <Basic.QosOk object at 0x7faf15fd1bd0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7faf15fcdc70>
2024-07-12 15:16:16,930 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:16:16,931 DEBUG Received frame <Basic.QosOk object at 0x7faf15fd2450> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7faf15fcdc70>
2024-07-12 15:16:16,932 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:16:16,933 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:16:16,940 DEBUG Received frame <Queue.DeclareOk object at 0x7faf15fdb250> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7faf15fcdc70>
2024-07-12 15:16:16,941 INFO Consumer successfully started!
2024-07-12 15:16:16,941 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:16:16,942 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.f2172111d7c348c3bbddddf9a540e35d\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:16:16,944 DEBUG Received frame <Basic.ConsumeOk object at 0x7faf15fc2bd0> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7faf15fcdc70>
2024-07-12 15:16:21,926 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 15:15:36,592 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7faf180ee510> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7faf15fcdc70>
2024-07-12 15:15:36,745 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:18:04,248 INFO Starting consumer...
2024-07-12 15:18:04,248 DEBUG Using selector: EpollSelector
2024-07-12 15:18:04,250 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:18:04,250 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:18:04,251 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:18:04,252 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 15:18:04,258 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:18:04,259 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:18:04,260 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7fa7dfffc610>
2024-07-12 15:18:04,261 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 15:18:04,263 DEBUG Received frame <Channel.OpenOk object at 0x7fa7ddc86390> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa7ddc91a40>
2024-07-12 15:18:04,264 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:18:04,265 DEBUG Received frame <Confirm.SelectOk object at 0x7fa7de014b10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa7ddc91a40>
2024-07-12 15:18:04,265 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:18:04,266 DEBUG Received frame <Basic.QosOk object at 0x7fa7ddc95d10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa7ddc91a40>
2024-07-12 15:18:04,267 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:18:04,268 DEBUG Received frame <Basic.QosOk object at 0x7fa7ddc96550> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa7ddc91a40>
2024-07-12 15:18:04,269 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:18:04,270 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:18:04,276 DEBUG Received frame <Queue.DeclareOk object at 0x7fa7ddc9ef30> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa7ddc91a40>
2024-07-12 15:18:04,277 INFO Consumer successfully started!
2024-07-12 15:18:04,277 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:18:04,279 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.1ffc374b103046b48b322f8959585f4e\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:18:04,280 DEBUG Received frame <Basic.ConsumeOk object at 0x7fa7ddc96510> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa7ddc91a40>
2024-07-12 15:18:09,904 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 15:18:34,692 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa7de911890> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa7ddc91a40>
2024-07-12 15:18:34,903 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:19:44,674 INFO Starting consumer...
2024-07-12 15:19:44,675 DEBUG Using selector: EpollSelector
2024-07-12 15:19:44,676 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:19:44,677 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:19:44,678 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:19:44,679 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 15:19:44,686 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:19:44,687 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:19:44,688 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7fa37fe03810>
2024-07-12 15:19:44,689 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 15:19:44,692 DEBUG Received frame <Channel.OpenOk object at 0x7fa37f749fd0> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:19:44,693 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:19:44,694 DEBUG Received frame <Confirm.SelectOk object at 0x7fa37f7587d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:19:44,695 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:19:44,696 DEBUG Received frame <Basic.QosOk object at 0x7fa37f759b50> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:19:44,698 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:19:44,699 DEBUG Received frame <Basic.QosOk object at 0x7fa37f75a390> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:19:44,700 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:19:44,701 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:19:44,708 DEBUG Received frame <Queue.DeclareOk object at 0x7fa37f760e10> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:19:44,709 INFO Consumer successfully started!
2024-07-12 15:19:44,709 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:19:44,710 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.0285bf99bc34430c8f9e5f215efe942b\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:19:44,712 DEBUG Received frame <Basic.ConsumeOk object at 0x7fa37f75a350> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:19:49,693 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 15:20:15,048 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa3819afa50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:20:15,260 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:19:36,174 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa380f4f050> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:19:36,678 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:21:17,503 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa3818fff10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:21:18,007 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:21:49,391 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa37f74a7d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:21:50,188 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:22:19,628 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa3819afa50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:22:20,717 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:22:50,309 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa380f4f050> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:22:51,691 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:23:21,065 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa3818fff10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:23:22,736 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:22:42,198 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa37f74a7d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:22:44,163 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:23:11,928 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa3819afa50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:24:25,485 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:24:52,936 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa380f4f050> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:24:56,551 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:25:23,707 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa3818fff10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:25:27,444 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:25:54,306 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa37f74a7d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:26:00,119 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:26:26,687 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7fa3819afa50> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7fa37f755d60>
2024-07-12 15:26:30,701 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:28:06,574 INFO Starting consumer...
2024-07-12 15:28:06,575 DEBUG Using selector: EpollSelector
2024-07-12 15:28:06,577 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:28:06,578 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:28:06,580 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:28:06,581 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 15:28:06,591 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:28:06,592 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:28:06,593 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f113708be50>
2024-07-12 15:28:06,594 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 15:28:06,597 DEBUG Received frame <Channel.OpenOk object at 0x7f1134814fd0> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1134811a90>
2024-07-12 15:28:06,598 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:28:06,599 DEBUG Received frame <Confirm.SelectOk object at 0x7f11348161d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1134811a90>
2024-07-12 15:28:06,600 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:28:06,603 DEBUG Received frame <Basic.QosOk object at 0x7f1134816210> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1134811a90>
2024-07-12 15:28:06,604 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:28:06,605 DEBUG Received frame <Basic.QosOk object at 0x7f11348169d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1134811a90>
2024-07-12 15:28:06,607 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:28:06,608 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:28:06,615 DEBUG Received frame <Queue.DeclareOk object at 0x7f113481cb40> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1134811a90>
2024-07-12 15:28:06,616 INFO Consumer successfully started!
2024-07-12 15:28:06,616 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:28:06,618 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.26a3aacf92744a81b67f81dd220e464f\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:28:06,619 DEBUG Received frame <Basic.ConsumeOk object at 0x7f1134816d90> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1134811a90>
2024-07-12 15:28:11,597 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 15:28:36,841 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f1136932750> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1134811a90>
2024-07-12 15:28:37,042 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:29:07,642 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f1134e0eb10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1134811a90>
2024-07-12 15:29:08,135 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:29:40,035 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f1134b89850> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1134811a90>
2024-07-12 15:29:40,815 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:30:48,758 INFO Starting consumer...
2024-07-12 15:30:48,758 DEBUG Using selector: EpollSelector
2024-07-12 15:30:48,760 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:30:48,760 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:30:48,761 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:30:48,762 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 15:30:48,769 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:30:48,770 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:30:48,771 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7ff2911b3610>
2024-07-12 15:30:48,773 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 15:30:48,775 DEBUG Received frame <Channel.OpenOk object at 0x7ff2917ba550> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff2911bda90>
2024-07-12 15:30:48,776 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:30:48,777 DEBUG Received frame <Confirm.SelectOk object at 0x7ff291a5d150> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff2911bda90>
2024-07-12 15:30:48,779 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:30:48,780 DEBUG Received frame <Basic.QosOk object at 0x7ff2911c1d50> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff2911bda90>
2024-07-12 15:30:48,781 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:30:48,782 DEBUG Received frame <Basic.QosOk object at 0x7ff2911c25d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff2911bda90>
2024-07-12 15:30:48,783 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:30:48,784 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:30:48,791 DEBUG Received frame <Queue.DeclareOk object at 0x7ff2911caf30> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff2911bda90>
2024-07-12 15:30:48,792 INFO Consumer successfully started!
2024-07-12 15:30:48,793 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:30:48,794 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.6411545d6fe14e569a3dea31ca0088b4\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:30:48,795 DEBUG Received frame <Basic.ConsumeOk object at 0x7ff2911c2f10> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff2911bda90>
2024-07-12 15:30:53,776 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 15:31:19,522 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7ff2911b2cd0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7ff2911bda90>
2024-07-12 15:31:19,736 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:33:36,110 INFO Starting consumer...
2024-07-12 15:33:36,111 DEBUG Using selector: EpollSelector
2024-07-12 15:33:36,113 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:33:36,113 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:33:36,114 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:33:36,115 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 15:33:36,123 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:33:36,124 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 15:33:36,124 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f1fa5083510>
2024-07-12 15:33:36,126 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 15:33:36,128 DEBUG Received frame <Channel.OpenOk object at 0x7f1fa5090d10> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:33:36,129 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:33:36,130 DEBUG Received frame <Confirm.SelectOk object at 0x7f1fa5507d50> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:33:36,131 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:33:36,133 DEBUG Received frame <Basic.QosOk object at 0x7f1fa5092050> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:33:36,134 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:33:36,135 DEBUG Received frame <Basic.QosOk object at 0x7f1fa5091fd0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:33:36,136 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:33:36,138 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:33:36,145 DEBUG Received frame <Queue.DeclareOk object at 0x7f1fa509afd0> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:33:36,146 INFO Consumer successfully started!
2024-07-12 15:33:36,146 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 15:33:36,147 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.b277ed3ced7046da8470ae26ae7dafac\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:33:36,149 DEBUG Received frame <Basic.ConsumeOk object at 0x7f1fa5093050> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:33:41,129 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 15:34:06,667 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f1fa76ab190> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:34:06,959 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:34:36,997 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f1fa5509190> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:34:37,579 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:33:58,302 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f1fa7765810> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:33:59,032 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:35:39,440 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f1fa5082e10> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:35:40,315 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:36:11,420 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f1fa76ab190> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:36:12,587 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 15:36:41,725 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f1fa5509190> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f1fa508d9f0>
2024-07-12 15:36:43,187 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:00:31,260 INFO Starting consumer...
2024-07-12 16:00:31,261 DEBUG Using selector: EpollSelector
2024-07-12 16:00:31,262 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:00:31,263 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:00:31,263 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:00:31,264 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 16:00:31,272 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:00:31,273 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:00:31,274 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f41f02bef10>
2024-07-12 16:00:31,275 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 16:00:31,277 DEBUG Received frame <Channel.OpenOk object at 0x7f41f02cc850> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:00:31,278 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:00:31,279 DEBUG Received frame <Confirm.SelectOk object at 0x7f41f02cda10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:00:31,280 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:00:31,281 DEBUG Received frame <Basic.QosOk object at 0x7f41f02ce0d0> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:00:31,282 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:00:31,283 DEBUG Received frame <Basic.QosOk object at 0x7f41f02ce290> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:00:31,284 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 16:00:31,285 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:00:31,291 DEBUG Received frame <Queue.DeclareOk object at 0x7f41f02d6ee0> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:00:31,292 INFO Consumer successfully started!
2024-07-12 16:00:31,293 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 16:00:31,294 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.1a0ce824028c42fba3d889b4b5feb981\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:00:31,295 DEBUG Received frame <Basic.ConsumeOk object at 0x7f41f02ce350> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:00:36,276 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 16:01:03,720 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f08c6610> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:01:03,994 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:01:36,170 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f23b7210> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:01:36,736 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:02:07,013 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f08c6610> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:02:07,856 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:02:39,453 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f23b7210> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:02:40,587 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:03:11,882 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f08c6610> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:03:13,309 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:03:42,184 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f23b7210> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:03:43,904 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:04:14,693 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f08c6610> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:04:16,707 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:04:45,260 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f23b7210> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:04:47,569 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:05:15,718 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f08c6610> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:05:18,319 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:05:48,165 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f23b7210> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:05:51,061 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:06:20,588 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f08c6610> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:06:23,776 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:06:52,991 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f23b7210> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:06:56,474 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:07:23,487 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f08c6610> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:07:27,264 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:07:53,745 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f41f23b7210> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f41f02c98b0>
2024-07-12 16:07:57,818 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:08:59,778 INFO Starting consumer...
2024-07-12 16:08:59,778 DEBUG Using selector: EpollSelector
2024-07-12 16:08:59,779 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:08:59,780 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:08:59,781 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:08:59,782 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 16:08:59,789 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:08:59,790 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:08:59,791 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f2254b90210>
2024-07-12 16:08:59,792 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 16:08:59,794 DEBUG Received frame <Channel.OpenOk object at 0x7f2256d00a10> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f2254b8d810>
2024-07-12 16:08:59,795 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:08:59,796 DEBUG Received frame <Confirm.SelectOk object at 0x7f2254b90050> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f2254b8d810>
2024-07-12 16:08:59,798 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:08:59,799 DEBUG Received frame <Basic.QosOk object at 0x7f2254b91410> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f2254b8d810>
2024-07-12 16:08:59,800 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:08:59,801 DEBUG Received frame <Basic.QosOk object at 0x7f2254b91c50> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f2254b8d810>
2024-07-12 16:08:59,802 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 16:08:59,804 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:08:59,810 DEBUG Received frame <Queue.DeclareOk object at 0x7f2254b9ad50> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f2254b8d810>
2024-07-12 16:08:59,811 INFO Consumer successfully started!
2024-07-12 16:08:59,811 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 16:08:59,812 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.44fb695dae9e4431ac84e7b5e0be819b\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:08:59,813 DEBUG Received frame <Basic.ConsumeOk object at 0x7f2254b92490> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f2254b8d810>
2024-07-12 16:09:04,794 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 16:10:06,496 INFO Starting consumer...
2024-07-12 16:10:06,497 DEBUG Using selector: EpollSelector
2024-07-12 16:10:06,498 DEBUG Starting connection factory for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:10:06,499 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:10:06,499 DEBUG Connection attempt for <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:10:06,500 DEBUG Connecting to: amqp://user:******@rabbit:5672/
2024-07-12 16:10:06,507 DEBUG Connection made on <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:10:06,507 DEBUG Creating AMQP channel for connection: <RobustConnection: "amqp://user:******@rabbit:5672/" 0 channels>
2024-07-12 16:10:06,508 DEBUG Channel created: <aio_pika.robust_channel.RobustChannel object at 0x7f97b2c0e850>
2024-07-12 16:10:06,510 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x06\x00\x14\x00\n\x010\xce', should_close=False, drain_future=None)
2024-07-12 16:10:06,511 DEBUG Received frame <Channel.OpenOk object at 0x7f97b0b0c810> in channel #1 weight=16 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:10:06,512 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x05\x00U\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:10:06,513 DEBUG Received frame <Confirm.SelectOk object at 0x7f97b0b0db10> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:10:06,515 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:10:06,516 DEBUG Received frame <Basic.QosOk object at 0x7f97b0b0da50> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:10:06,517 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x0b\x00<\x00\n\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:10:06,518 DEBUG Received frame <Basic.QosOk object at 0x7f97b0b0e310> in channel #1 weight=12 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:10:06,519 DEBUG Declaring queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 16:10:06,519 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\x16\x002\x00\n\x00\x00\ntest_queue\x08\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:10:06,526 DEBUG Received frame <Queue.DeclareOk object at 0x7f97b0b16d50> in channel #1 weight=31 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:10:06,527 INFO Consumer successfully started!
2024-07-12 16:10:06,527 DEBUG Start to consuming queue: <RobustQueue(test_queue): auto_delete=True, durable=False, exclusive=False, arguments=None
2024-07-12 16:10:06,528 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00=\x00<\x00\x14\x00\x00\ntest_queue&ctag1.916d8a02043445e49729b008decd61d6\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:10:06,530 DEBUG Received frame <Basic.ConsumeOk object at 0x7f97b0b0e410> in channel #1 weight=51 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:10:11,512 DEBUG Waiting for connection close event for <RobustConnection: "amqp://user:******@rabbit:5672/" 1 channels>
2024-07-12 16:10:38,954 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f97b18a8a90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:10:39,245 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:11:11,382 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f97b0afe190> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:11,964 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:11:41,767 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f97b2514850> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:42,641 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:11:44,087 DEBUG Received frame <Basic.Deliver object at 0x7f97b0af71d0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:44,088 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97b0b0ed50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:44,090 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97b2514850> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:44,132 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection pool created", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:44,134 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:44,136 DEBUG {"message": "Waiting for suitable server to become available", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Unknown, servers: [<ServerDescription ('mongodb', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "remainingTimeMS": 29}
2024-07-12 16:11:44,137 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:44,138 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:44,140 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:44,141 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:44,144 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0011445999998613843}
2024-07-12 16:11:44,145 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.005359402000067348}
2024-07-12 16:11:44,146 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-001.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c0a7ee35ee91810d81\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:44,157 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 10.342, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1957747793, "operationId": 1957747793, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:44,158 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:44,160 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:44,161 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:44,161 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:44,162 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0005907000004299334}
2024-07-12 16:11:44,163 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c0a7ee35ee91810d81\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:44,165 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 2.195, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c0a7ee35ee91810d81\"}, \"FileName\": \"1-001.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 424238335, "operationId": 424238335, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:44,166 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:44,167 INFO Created new item on mongodb 
2024-07-12 16:11:44,168 INFO {'_id': ObjectId('669155c0a7ee35ee91810d81'), 'FileName': '1-001.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c0a7ee35ee91810d81'}
2024-07-12 16:11:44,216 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:11:44,222 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:11:44,225 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:11:44,238 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:11:44,242 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:11:44,246 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:11:44,252 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:11:44,258 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:11:44,260 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:11:44,261 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:11:44,262 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:11:44,322 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:11:44,327 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:11:44,372 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:11:44,373 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:11:44,397 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:11:44,431 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:11:44,436 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:11:44,440 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:11:44,441 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97b0b385e0>
2024-07-12 16:11:44,498 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:11:44,499 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:11:44,499 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:11:44,500 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:11:44,500 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:11:44,501 DEBUG No configured endpoint found.
2024-07-12 16:11:44,505 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:11:44,508 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:11:44,509 DEBUG Registering retry handlers for service: s3
2024-07-12 16:11:44,510 DEBUG Registering S3 region redirector handler
2024-07-12 16:11:44,511 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:11:44,512 DEBUG Loading s3:s3
2024-07-12 16:11:44,514 DEBUG Loading s3:Bucket
2024-07-12 16:11:44,515 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:44,517 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97b0b391c0>
2024-07-12 16:11:44,517 DEBUG Loading s3:Bucket
2024-07-12 16:11:44,518 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:44,520 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97b0b391c0>
2024-07-12 16:11:44,521 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:11:44,521 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:11:44,523 DEBUG Acquiring 0
2024-07-12 16:11:44,524 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a974dcd0>}) about to wait for the following futures []
2024-07-12 16:11:44,525 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a974dcd0>}) done waiting for dependent futures
2024-07-12 16:11:44,526 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a974dcd0>}) with kwargs {'client': <botocore.client.S3 object at 0x7f97b2d63890>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f97a974cf90>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97a974d2d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97a974d3d0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a974dcd0>}
2024-07-12 16:11:44,529 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97a974d3d0> for transfer request: 0.
2024-07-12 16:11:44,530 DEBUG Acquiring 0
2024-07-12 16:11:44,531 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:11:44,531 DEBUG Releasing acquire 0/None
2024-07-12 16:11:44,531 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:11:44,532 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f97b2d63890>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f97a9bbead0>, 'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}
2024-07-12 16:11:44,534 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:11:44,535 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:11:44,535 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:11:44,536 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:11:44,536 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:11:44,537 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9bbeb50>>
2024-07-12 16:11:44,537 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f97a9cbbc10>>
2024-07-12 16:11:44,539 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:11:44,540 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:44,541 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9bbeb50>>
2024-07-12 16:11:44,542 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-001.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:44,545 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:11:44,546 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:44,546 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:44,547 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:11:44,560 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:11:44,560 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:11:44,561 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9bacd90>>
2024-07-12 16:11:44,561 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:11:44,562 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:11:44,563 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-001.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'a+SEL26fg7TNUEdKeU7CgQ==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f97a9bbead0>, 'auth_path': '/dicommetadata/1-001.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-001.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f97a9af04d0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-001.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f97a9bbead0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-001.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:11:44,565 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:44,565 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a9bbf2d0>>
2024-07-12 16:11:44,566 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a9cbbc10>>
2024-07-12 16:11:44,567 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:44,567 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:44,568 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9bacd90>>
2024-07-12 16:11:44,569 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:44,570 DEBUG CanonicalRequest:
PUT
/1-001.dcm

content-md5:a+SEL26fg7TNUEdKeU7CgQ==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161144Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:44,570 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161144Z
20240712/us-east-1/s3/aws4_request
79ce126fe2870dfc434bf6a885d9c7018194687c9fdd8e9df53096c33f8d9fff
2024-07-12 16:11:44,571 DEBUG Signature:
735724c9e050480fc4b0dea1cda1cf81d8e0ec141f4f1b86e70d9f5387cd6f60
2024-07-12 16:11:44,572 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:44,573 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:44,574 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-001.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'a+SEL26fg7TNUEdKeU7CgQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161144Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=735724c9e050480fc4b0dea1cda1cf81d8e0ec141f4f1b86e70d9f5387cd6f60', 'amz-sdk-invocation-id': b'2485758b-2710-4b8a-b896-9b2ceb2083d3', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527938'}>
2024-07-12 16:11:44,575 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:44,576 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:11:44,974 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:45,091 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:11:45,093 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:11:45,126 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-001.dcm HTTP/11" 400 None
2024-07-12 16:11:45,127 DEBUG Response headers: {'x-amz-request-id': 'GX0Q7SJ32MGGBXS2', 'x-amz-id-2': '1i0r/dsyOojFtjXm5PNrNzOiUxH8JZKEZ1G+LD8XeWuwI5g0+ZwZIKwhdZw/UyuSx75RxBJJm4L9PzNAnSg0TdLYlygac8Lf', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:11:44 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:11:45,127 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>GX0Q7SJ32MGGBXS2</RequestId><HostId>1i0r/dsyOojFtjXm5PNrNzOiUxH8JZKEZ1G+LD8XeWuwI5g0+ZwZIKwhdZw/UyuSx75RxBJJm4L9PzNAnSg0TdLYlygac8Lf</HostId></Error>'
2024-07-12 16:11:45,134 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a9bbe990>
2024-07-12 16:11:45,134 DEBUG No retry needed.
2024-07-12 16:11:45,135 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9bbeb50>>
2024-07-12 16:11:45,136 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:11:45,137 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:45,138 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9bbeb50>>
2024-07-12 16:11:45,139 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-001.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:45,140 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:11:45,141 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-001.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-001.dcm
2024-07-12 16:11:45,142 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:45,143 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:45,144 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:11:45,157 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f97a9bbead0>
2024-07-12 16:11:45,158 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:45,158 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a9bbf2d0>>
2024-07-12 16:11:45,159 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a9cbbc10>>
2024-07-12 16:11:45,160 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:45,161 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:45,162 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9bacd90>>
2024-07-12 16:11:45,163 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:45,164 DEBUG CanonicalRequest:
PUT
/1-001.dcm

content-md5:a+SEL26fg7TNUEdKeU7CgQ==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161145Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:45,165 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161145Z
20240712/eu-north-1/s3/aws4_request
ab5ad30524f7455132066e1047514e68762d2ee59d6b7c99d48b581144a9d8e6
2024-07-12 16:11:45,166 DEBUG Signature:
a9f9dc4b173612ddedc9916b7f19f81210d6f6a3b73ee59c42389bd579e6f296
2024-07-12 16:11:45,167 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:45,169 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:45,170 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-001.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'a+SEL26fg7TNUEdKeU7CgQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161145Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=a9f9dc4b173612ddedc9916b7f19f81210d6f6a3b73ee59c42389bd579e6f296', 'amz-sdk-invocation-id': b'2485758b-2710-4b8a-b896-9b2ceb2083d3', 'amz-sdk-request': b'ttl=20240712T161244Z; attempt=2; max=5', 'Content-Length': '527938'}>
2024-07-12 16:11:45,171 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:45,172 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:11:45,541 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:45,683 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:11:46,528 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-001.dcm HTTP/11" 200 0
2024-07-12 16:11:46,529 DEBUG Response headers: {'x-amz-id-2': 'JXXsfYT2PHVkWqHLrTUncE3YY+z4x3cAP7WO70cWux/m0gEQ/QZNyU6xZpY4uDwgRePns021w6ibPT6kr38hg+5F9xlct5Mh', 'x-amz-request-id': 'GX0TFRK3X1KX37CG', 'Date': 'Fri, 12 Jul 2024 16:11:46 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"6be4842f6e9f83b4cd50474a794ec281"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:11:46,529 DEBUG Response body:
b''
2024-07-12 16:11:46,530 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a9bbe990>
2024-07-12 16:11:46,531 DEBUG No retry needed.
2024-07-12 16:11:46,531 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9bbeb50>>
2024-07-12 16:11:46,532 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:11:46,534 DEBUG Releasing acquire 0/None
2024-07-12 16:11:46,535 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x01\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:11:46,539 DEBUG Received frame <Basic.Deliver object at 0x7f97b0b507d0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:46,540 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a9ad7650> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:46,541 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97b2bedf10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:46,544 DEBUG Received frame <Basic.Deliver object at 0x7f97b0b50770> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:46,545 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a98c1110> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:46,547 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97b18f4b10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:46,551 DEBUG Received frame <Basic.Deliver object at 0x7f97b0b50170> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:46,552 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a9714050> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:46,553 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97a97144d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:46,569 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:46,570 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,571 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,575 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.003547700000126497}
2024-07-12 16:11:46,576 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-002.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c2a7ee35ee91810d82\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,579 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 2.644, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 719885386, "operationId": 719885386, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,583 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:46,595 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:46,596 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,597 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,598 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007936009997138171}
2024-07-12 16:11:46,599 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-003.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c2a7ee35ee91810d83\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,603 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.3080000000000003, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1649760492, "operationId": 1649760492, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,605 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:46,621 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:46,623 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,623 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:46,624 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,625 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,625 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:46,626 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.002272100000482169}
2024-07-12 16:11:46,627 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,628 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,629 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-004.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c2a7ee35ee91810d84\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,630 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 16:11:46,631 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,634 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 16:11:46,636 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 7.079000000000001, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 596516649, "operationId": 596516649, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,637 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0030210000004444737}
2024-07-12 16:11:46,638 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:46,639 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.0007936009997138171}
2024-07-12 16:11:46,642 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.014651002999926277}
2024-07-12 16:11:46,645 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:46,645 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.014269103000515315}
2024-07-12 16:11:46,646 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c2a7ee35ee91810d82\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,647 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,648 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c2a7ee35ee91810d83\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 3, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,651 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 5.1000000000000005, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c2a7ee35ee91810d82\"}, \"FileName\": \"1-002.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1350490027, "operationId": 1350490027, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,653 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,655 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 7.276999999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c2a7ee35ee91810d83\"}, \"FileName\": \"1-003.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 783368690, "operationId": 783368690, "driverConnectionId": 3, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,656 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 16:11:46,657 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00470160099939676}
2024-07-12 16:11:46,658 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 16:11:46,660 INFO Created new item on mongodb 
2024-07-12 16:11:46,661 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c2a7ee35ee91810d84\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,662 INFO {'_id': ObjectId('669155c2a7ee35ee91810d82'), 'FileName': '1-002.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c2a7ee35ee91810d82'}
2024-07-12 16:11:46,665 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.891, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c2a7ee35ee91810d84\"}, \"FileName\": \"1-004.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1102520059, "operationId": 1102520059, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:46,667 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:46,694 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:11:46,699 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:11:46,702 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:11:46,706 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:11:46,707 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:11:46,711 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:11:46,714 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:11:46,722 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:11:46,723 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:11:46,723 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:11:46,724 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:11:46,747 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:11:46,750 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:11:46,797 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:11:46,800 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:11:46,847 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:11:46,889 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:11:46,903 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:11:46,993 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:11:46,994 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a9746020>
2024-07-12 16:11:46,995 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:11:46,997 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:11:46,997 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:11:46,998 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:11:46,999 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:11:46,999 DEBUG No configured endpoint found.
2024-07-12 16:11:47,007 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:11:47,012 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:11:47,013 DEBUG Registering retry handlers for service: s3
2024-07-12 16:11:47,015 DEBUG Registering S3 region redirector handler
2024-07-12 16:11:47,016 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:11:47,018 DEBUG Loading s3:s3
2024-07-12 16:11:47,025 DEBUG Loading s3:Bucket
2024-07-12 16:11:47,026 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:47,028 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9744b80>
2024-07-12 16:11:47,029 DEBUG Loading s3:Bucket
2024-07-12 16:11:47,030 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:47,032 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9744b80>
2024-07-12 16:11:47,033 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:11:47,033 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:11:47,035 DEBUG Acquiring 0
2024-07-12 16:11:47,036 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97b02b6110>}) about to wait for the following futures []
2024-07-12 16:11:47,037 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97b02b6110>}) done waiting for dependent futures
2024-07-12 16:11:47,037 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97b02b6110>}) with kwargs {'client': <botocore.client.S3 object at 0x7f97a80135d0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f97b02b7210>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97a8297e50>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97b02b6bd0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97b02b6110>}
2024-07-12 16:11:47,040 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97b02b6bd0> for transfer request: 0.
2024-07-12 16:11:47,041 DEBUG Acquiring 0
2024-07-12 16:11:47,042 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:11:47,042 DEBUG Releasing acquire 0/None
2024-07-12 16:11:47,042 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:11:47,043 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f97a80135d0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f97b02b5850>, 'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}
2024-07-12 16:11:47,045 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:11:47,046 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:11:47,046 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:11:47,047 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:11:47,047 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:11:47,048 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a984c5d0>>
2024-07-12 16:11:47,049 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f97a82a0710>>
2024-07-12 16:11:47,050 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:11:47,052 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:47,053 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a984c5d0>>
2024-07-12 16:11:47,055 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-002.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:47,057 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:11:47,058 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:47,059 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:47,060 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:11:47,067 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:11:47,067 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:11:47,068 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9838850>>
2024-07-12 16:11:47,068 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:11:47,068 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:11:47,069 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-002.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'G3/8anluLA09gcQ+8/fcPw==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f97b02b5850>, 'auth_path': '/dicommetadata/1-002.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-002.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f97a987cf90>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-002.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f97b02b5850>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-002.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:11:47,070 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:47,071 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a987c150>>
2024-07-12 16:11:47,072 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a82a0710>>
2024-07-12 16:11:47,075 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:47,078 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:47,078 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9838850>>
2024-07-12 16:11:47,079 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:47,080 DEBUG CanonicalRequest:
PUT
/1-002.dcm

content-md5:G3/8anluLA09gcQ+8/fcPw==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161147Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:47,080 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161147Z
20240712/us-east-1/s3/aws4_request
dd1c60f0d678d592a1b032f979e1b869c12b6b3d0d7b816e09a9b92424261987
2024-07-12 16:11:47,081 DEBUG Signature:
f69bf5d74124d5cc4cc8cb4ec73f1a47c125d06214f0dcd487e316f53da8fef4
2024-07-12 16:11:47,081 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:47,082 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:47,083 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-002.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'G3/8anluLA09gcQ+8/fcPw==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161147Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=f69bf5d74124d5cc4cc8cb4ec73f1a47c125d06214f0dcd487e316f53da8fef4', 'amz-sdk-invocation-id': b'bb68c3a5-9c82-48cd-af7e-ef434edbcb25', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:11:47,085 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:47,085 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:11:47,428 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:47,550 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:11:47,551 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:11:47,560 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-002.dcm HTTP/11" 400 None
2024-07-12 16:11:47,560 DEBUG Response headers: {'x-amz-request-id': 'FN58BRKQR231AF75', 'x-amz-id-2': '22bz/7ZtpzS0wFFVfph+Eh9VC3qJZMYK1Pn6Wryc98w0SEQvzlxlTcOeegSyJb0jeImYrxCJQeYjstmIXnFYEu+FuUDzhOc8', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:11:47 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:11:47,561 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>FN58BRKQR231AF75</RequestId><HostId>22bz/7ZtpzS0wFFVfph+Eh9VC3qJZMYK1Pn6Wryc98w0SEQvzlxlTcOeegSyJb0jeImYrxCJQeYjstmIXnFYEu+FuUDzhOc8</HostId></Error>'
2024-07-12 16:11:47,565 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a9838a90>
2024-07-12 16:11:47,565 DEBUG No retry needed.
2024-07-12 16:11:47,566 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a984c5d0>>
2024-07-12 16:11:47,566 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:11:47,567 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:47,571 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a984c5d0>>
2024-07-12 16:11:47,573 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-002.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:47,575 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:11:47,576 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-002.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-002.dcm
2024-07-12 16:11:47,577 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:47,577 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:47,578 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:11:47,579 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f97b02b5850>
2024-07-12 16:11:47,579 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:47,580 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a987c150>>
2024-07-12 16:11:47,581 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a82a0710>>
2024-07-12 16:11:47,581 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:47,582 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:47,582 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9838850>>
2024-07-12 16:11:47,583 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:47,584 DEBUG CanonicalRequest:
PUT
/1-002.dcm

content-md5:G3/8anluLA09gcQ+8/fcPw==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161147Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:47,585 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161147Z
20240712/eu-north-1/s3/aws4_request
4e96e73745d39402e18b4ab01b0d87a3fe2f34323e1278b1db4440b6586ca48e
2024-07-12 16:11:47,586 DEBUG Signature:
3fa811db26693a0c2df93b9931895c8e06723cecebfa3a603f916fe9247829cf
2024-07-12 16:11:47,587 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:47,588 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:47,589 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-002.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'G3/8anluLA09gcQ+8/fcPw==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161147Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=3fa811db26693a0c2df93b9931895c8e06723cecebfa3a603f916fe9247829cf', 'amz-sdk-invocation-id': b'bb68c3a5-9c82-48cd-af7e-ef434edbcb25', 'amz-sdk-request': b'ttl=20240712T161247Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:11:47,590 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:47,591 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:11:47,817 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:47,961 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:11:48,722 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-002.dcm HTTP/11" 200 0
2024-07-12 16:11:48,722 DEBUG Response headers: {'x-amz-id-2': 'HXHFxk2Bp8VbKtX+gJpL561bScrcl8PgkEmUvBAVrUBwG7vUSxyo7rXrhgs/flmQ87SS1iA0TDg=', 'x-amz-request-id': 'FN56V8YT7NA55KME', 'Date': 'Fri, 12 Jul 2024 16:11:48 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"1b7ffc6a796e2c0d3d81c43ef3f7dc3f"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:11:48,723 DEBUG Response body:
b''
2024-07-12 16:11:48,723 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a9838a90>
2024-07-12 16:11:48,724 DEBUG No retry needed.
2024-07-12 16:11:48,725 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a984c5d0>>
2024-07-12 16:11:48,725 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:11:48,728 DEBUG Releasing acquire 0/None
2024-07-12 16:11:48,729 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x02\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:11:48,730 INFO Created new item on mongodb 
2024-07-12 16:11:48,731 INFO {'_id': ObjectId('669155c2a7ee35ee91810d83'), 'FileName': '1-003.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c2a7ee35ee91810d83'}
2024-07-12 16:11:48,752 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:11:48,756 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:11:48,758 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:11:48,762 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:11:48,763 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:11:48,766 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:11:48,768 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:11:48,774 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:11:48,774 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:11:48,775 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:11:48,776 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:11:48,801 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:11:48,805 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:11:48,849 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:11:48,850 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:11:48,882 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:11:48,956 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:11:48,962 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:11:48,965 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:11:48,966 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a9af4680>
2024-07-12 16:11:48,966 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:11:48,968 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:11:48,968 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:11:48,969 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:11:48,969 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:11:48,970 DEBUG No configured endpoint found.
2024-07-12 16:11:48,973 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:11:48,977 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:11:48,980 DEBUG Registering retry handlers for service: s3
2024-07-12 16:11:48,982 DEBUG Registering S3 region redirector handler
2024-07-12 16:11:48,985 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:11:48,987 DEBUG Loading s3:s3
2024-07-12 16:11:48,990 DEBUG Loading s3:Bucket
2024-07-12 16:11:48,991 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:48,996 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97b0b38f40>
2024-07-12 16:11:48,997 DEBUG Loading s3:Bucket
2024-07-12 16:11:48,998 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:49,000 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97b0b38f40>
2024-07-12 16:11:49,002 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:11:49,003 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:11:49,004 DEBUG Acquiring 0
2024-07-12 16:11:49,006 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792e29290>}) about to wait for the following futures []
2024-07-12 16:11:49,007 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792e29290>}) done waiting for dependent futures
2024-07-12 16:11:49,007 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792e29290>}) with kwargs {'client': <botocore.client.S3 object at 0x7f97a9dda650>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f9792e282d0>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f9792e28610>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f9792e28850>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792e29290>}
2024-07-12 16:11:49,013 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f9792e28850> for transfer request: 0.
2024-07-12 16:11:49,014 DEBUG Acquiring 0
2024-07-12 16:11:49,015 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:11:49,016 DEBUG Releasing acquire 0/None
2024-07-12 16:11:49,017 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:11:49,022 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f97a9dda650>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f9792e29ad0>, 'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}
2024-07-12 16:11:49,027 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:11:49,028 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:11:49,029 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:11:49,030 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:11:49,030 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:11:49,031 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9dc4d90>>
2024-07-12 16:11:49,032 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f97a9c22a90>>
2024-07-12 16:11:49,032 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:11:49,033 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:49,034 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9dc4d90>>
2024-07-12 16:11:49,035 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-003.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:49,036 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:11:49,037 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:49,038 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:49,040 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:11:49,053 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:11:49,054 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:11:49,055 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9dc4410>>
2024-07-12 16:11:49,057 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:11:49,060 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:11:49,061 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-003.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'w3mrfoDiHE1h9oIWOVMovQ==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f9792e29ad0>, 'auth_path': '/dicommetadata/1-003.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-003.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f97a9dd32d0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-003.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f9792e29ad0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-003.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:11:49,063 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:49,064 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a9dd3350>>
2024-07-12 16:11:49,065 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a9c22a90>>
2024-07-12 16:11:49,066 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:49,067 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:49,067 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9dc4410>>
2024-07-12 16:11:49,068 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:49,069 DEBUG CanonicalRequest:
PUT
/1-003.dcm

content-md5:w3mrfoDiHE1h9oIWOVMovQ==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161149Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:49,070 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161149Z
20240712/us-east-1/s3/aws4_request
270c10707531beddd11b81469e8bae644b3a077f2bb429f0e7270fe48bbf260b
2024-07-12 16:11:49,071 DEBUG Signature:
9227f66e97717685c2ca9745ea280697430f73d89e578d2981447dffdbb70aa6
2024-07-12 16:11:49,073 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:49,074 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:49,080 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-003.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'w3mrfoDiHE1h9oIWOVMovQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161149Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=9227f66e97717685c2ca9745ea280697430f73d89e578d2981447dffdbb70aa6', 'amz-sdk-invocation-id': b'3f88967b-6dc7-495b-9499-f28cc5362d7b', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:11:49,084 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:49,085 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:11:49,422 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:49,567 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:11:49,569 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:11:49,581 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-003.dcm HTTP/11" 400 None
2024-07-12 16:11:49,582 DEBUG Response headers: {'x-amz-request-id': 'G0ST3CMTD75E2XKA', 'x-amz-id-2': '0IdFVNet7rbSQLQ+wm1guCCGCsQx5DDmB+26ZuXhwmW9COkp5LPU+/kHSjr/Y93fskw6aVcy60Pxa/pGZSm2EmNxlpUweY+E', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:11:49 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:11:49,582 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>G0ST3CMTD75E2XKA</RequestId><HostId>0IdFVNet7rbSQLQ+wm1guCCGCsQx5DDmB+26ZuXhwmW9COkp5LPU+/kHSjr/Y93fskw6aVcy60Pxa/pGZSm2EmNxlpUweY+E</HostId></Error>'
2024-07-12 16:11:49,593 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a9dc4490>
2024-07-12 16:11:49,594 DEBUG No retry needed.
2024-07-12 16:11:49,595 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9dc4d90>>
2024-07-12 16:11:49,597 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:11:49,597 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:49,598 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9dc4d90>>
2024-07-12 16:11:49,598 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-003.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:49,600 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:11:49,601 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-003.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-003.dcm
2024-07-12 16:11:49,602 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:49,604 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:49,605 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:11:49,606 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f9792e29ad0>
2024-07-12 16:11:49,606 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:49,608 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a9dd3350>>
2024-07-12 16:11:49,610 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a9c22a90>>
2024-07-12 16:11:49,610 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:49,612 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:49,613 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9dc4410>>
2024-07-12 16:11:49,614 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:49,614 DEBUG CanonicalRequest:
PUT
/1-003.dcm

content-md5:w3mrfoDiHE1h9oIWOVMovQ==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161149Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:49,615 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161149Z
20240712/eu-north-1/s3/aws4_request
49ec6377fbbbebbc2319d0ad07db1d95fa7d00e48e5a64ef819cebaf2335130e
2024-07-12 16:11:49,615 DEBUG Signature:
efd7296490d265c69acbd0f5c9a06796bc90eff69cf2eda6c16d099d2995f1d8
2024-07-12 16:11:49,616 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:49,617 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:49,618 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-003.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'w3mrfoDiHE1h9oIWOVMovQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161149Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=efd7296490d265c69acbd0f5c9a06796bc90eff69cf2eda6c16d099d2995f1d8', 'amz-sdk-invocation-id': b'3f88967b-6dc7-495b-9499-f28cc5362d7b', 'amz-sdk-request': b'ttl=20240712T161249Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:11:49,619 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:49,620 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:11:49,856 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:50,010 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:11:50,585 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-003.dcm HTTP/11" 200 0
2024-07-12 16:11:50,586 DEBUG Response headers: {'x-amz-id-2': 'f5WuZsqqEx7UGm56EYZfUxTiQVLBaXKp6nv7I8gdeUfQe2OAX3xGRL9dxepkIrz0T942DKnLO5g=', 'x-amz-request-id': 'G0SPK66SAX21506K', 'Date': 'Fri, 12 Jul 2024 16:11:50 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"c379ab7e80e21c4d61f68216395328bd"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:11:50,586 DEBUG Response body:
b''
2024-07-12 16:11:50,588 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a9dc4490>
2024-07-12 16:11:50,588 DEBUG No retry needed.
2024-07-12 16:11:50,589 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9dc4d90>>
2024-07-12 16:11:50,589 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:11:50,591 DEBUG Releasing acquire 0/None
2024-07-12 16:11:50,592 INFO Created new item on mongodb 
2024-07-12 16:11:50,593 INFO {'_id': ObjectId('669155c2a7ee35ee91810d84'), 'FileName': '1-004.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c2a7ee35ee91810d84'}
2024-07-12 16:11:50,616 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:11:50,622 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:11:50,625 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:11:50,628 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:11:50,629 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:11:50,631 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:11:50,633 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:11:50,640 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:11:50,641 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:11:50,641 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:11:50,642 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:11:50,663 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:11:50,668 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:11:50,696 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:11:50,698 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:11:50,720 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:11:50,750 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:11:50,761 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:11:50,764 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:11:50,765 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ae4680>
2024-07-12 16:11:50,765 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:11:50,767 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:11:50,767 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:11:50,768 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:11:50,768 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:11:50,769 DEBUG No configured endpoint found.
2024-07-12 16:11:50,771 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:11:50,775 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:11:50,776 DEBUG Registering retry handlers for service: s3
2024-07-12 16:11:50,778 DEBUG Registering S3 region redirector handler
2024-07-12 16:11:50,780 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:11:50,785 DEBUG Loading s3:s3
2024-07-12 16:11:50,787 DEBUG Loading s3:Bucket
2024-07-12 16:11:50,788 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:50,790 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f9792e0f100>
2024-07-12 16:11:50,791 DEBUG Loading s3:Bucket
2024-07-12 16:11:50,792 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:50,794 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f9792e0f100>
2024-07-12 16:11:50,795 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:11:50,796 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:11:50,798 DEBUG Acquiring 0
2024-07-12 16:11:50,801 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97926db790>}) about to wait for the following futures []
2024-07-12 16:11:50,801 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97926db790>}) done waiting for dependent futures
2024-07-12 16:11:50,802 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97926db790>}) with kwargs {'client': <botocore.client.S3 object at 0x7f97926807d0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f97a9763210>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97926daad0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97926da950>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97926db790>}
2024-07-12 16:11:50,806 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97926da950> for transfer request: 0.
2024-07-12 16:11:50,807 DEBUG Acquiring 0
2024-07-12 16:11:50,808 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:11:50,808 DEBUG Releasing acquire 0/None
2024-07-12 16:11:50,809 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:11:50,810 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f97926807d0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f97926dbfd0>, 'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}
2024-07-12 16:11:50,811 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:11:50,812 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:11:50,813 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:11:50,814 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:11:50,816 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:11:50,817 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97926a5d10>>
2024-07-12 16:11:50,818 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f9792979650>>
2024-07-12 16:11:50,819 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:11:50,821 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:50,823 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97926a5d10>>
2024-07-12 16:11:50,824 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-004.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:50,827 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:11:50,828 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:50,828 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:50,830 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:11:50,842 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:11:50,842 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:11:50,843 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97926b21d0>>
2024-07-12 16:11:50,844 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:11:50,844 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:11:50,845 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-004.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'F+F4/wBwHQFl2qhlmfDf8g==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f97926dbfd0>, 'auth_path': '/dicommetadata/1-004.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-004.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f979268eed0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-004.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f97926dbfd0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-004.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:11:50,849 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:50,850 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f979268ee90>>
2024-07-12 16:11:50,850 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9792979650>>
2024-07-12 16:11:50,851 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:50,852 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:50,852 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97926b21d0>>
2024-07-12 16:11:50,853 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:50,854 DEBUG CanonicalRequest:
PUT
/1-004.dcm

content-md5:F+F4/wBwHQFl2qhlmfDf8g==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161150Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:50,854 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161150Z
20240712/us-east-1/s3/aws4_request
6b2be49eac9db799c61e8c48ebf71d032410a866fa913c0e8eaca9bc6fa80dd4
2024-07-12 16:11:50,855 DEBUG Signature:
960dbeaa8d8aa5fb8a0e7f29484d10333bf95c64f5edef85bf7fd7c526d186be
2024-07-12 16:11:50,855 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:50,856 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:50,857 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-004.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'F+F4/wBwHQFl2qhlmfDf8g==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161150Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=960dbeaa8d8aa5fb8a0e7f29484d10333bf95c64f5edef85bf7fd7c526d186be', 'amz-sdk-invocation-id': b'4bd1a656-40d4-43bc-8739-2b560258eb22', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:11:50,864 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:50,865 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:11:51,172 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:51,287 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:11:51,288 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:11:51,296 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-004.dcm HTTP/11" 400 None
2024-07-12 16:11:51,297 DEBUG Response headers: {'x-amz-request-id': 'HKCZM2PEFX50F21N', 'x-amz-id-2': 'XxHBR6JjMiqD6Nj2mMhBvB6DZErIKH4y3NiqV7yZrhQJXfICXdEgtpsLI+js1aR3ZH3TE393RQQ=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:11:50 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:11:51,297 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>HKCZM2PEFX50F21N</RequestId><HostId>XxHBR6JjMiqD6Nj2mMhBvB6DZErIKH4y3NiqV7yZrhQJXfICXdEgtpsLI+js1aR3ZH3TE393RQQ=</HostId></Error>'
2024-07-12 16:11:51,302 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97926b1f50>
2024-07-12 16:11:51,303 DEBUG No retry needed.
2024-07-12 16:11:51,303 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97926a5d10>>
2024-07-12 16:11:51,304 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:11:51,305 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:51,306 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97926a5d10>>
2024-07-12 16:11:51,307 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-004.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:51,309 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:11:51,310 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-004.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-004.dcm
2024-07-12 16:11:51,311 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:51,312 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:51,313 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:11:51,314 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f97926dbfd0>
2024-07-12 16:11:51,315 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:51,315 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f979268ee90>>
2024-07-12 16:11:51,316 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9792979650>>
2024-07-12 16:11:51,316 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:51,318 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:51,318 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97926b21d0>>
2024-07-12 16:11:51,319 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:51,320 DEBUG CanonicalRequest:
PUT
/1-004.dcm

content-md5:F+F4/wBwHQFl2qhlmfDf8g==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161151Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:51,320 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161151Z
20240712/eu-north-1/s3/aws4_request
2515f6f94fab54404809bef0bbebfd28df95d87cd52c1afe249b78b52d9bfc57
2024-07-12 16:11:51,321 DEBUG Signature:
1c48c88c7b8758ea55004762472b8a62a39a7a5965481e7ceeffe6bc272a899e
2024-07-12 16:11:51,322 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:51,322 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:51,323 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-004.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'F+F4/wBwHQFl2qhlmfDf8g==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161151Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=1c48c88c7b8758ea55004762472b8a62a39a7a5965481e7ceeffe6bc272a899e', 'amz-sdk-invocation-id': b'4bd1a656-40d4-43bc-8739-2b560258eb22', 'amz-sdk-request': b'ttl=20240712T161250Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:11:51,324 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:51,325 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:11:51,762 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:51,894 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:11:52,733 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-004.dcm HTTP/11" 200 0
2024-07-12 16:11:52,734 DEBUG Response headers: {'x-amz-id-2': 'OpbhpsKXMnnuxc2gv0CuKt9ZaRk3bIxWHNwdShRAOC0u65VYV31x60Ywc/2qX9jlPAffVqHPEJg=', 'x-amz-request-id': 'HKCP5MMSZJT7719S', 'Date': 'Fri, 12 Jul 2024 16:11:52 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"17e178ff00701d0165daa86599f0dff2"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:11:52,735 DEBUG Response body:
b''
2024-07-12 16:11:52,736 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97926b1f50>
2024-07-12 16:11:52,736 DEBUG No retry needed.
2024-07-12 16:11:52,737 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97926a5d10>>
2024-07-12 16:11:52,737 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:11:52,739 DEBUG Releasing acquire 0/None
2024-07-12 16:11:52,742 DEBUG Received frame <Basic.Deliver object at 0x7f97a97ac170> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,743 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a988c090> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,744 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97a9b31250> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,744 DEBUG Received frame <Basic.Deliver object at 0x7f97a97ac110> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,745 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a988c210> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,746 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97a988c2d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,747 DEBUG Received frame <Basic.Deliver object at 0x7f97a97ac2f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,748 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a988c410> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,748 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97a988c690> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,749 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x03\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:11:52,750 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x04\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:11:52,759 DEBUG Received frame <Basic.Deliver object at 0x7f9792e1c170> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,760 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f9792e12cd0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,760 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97926b1ed0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,762 DEBUG Received frame <Basic.Deliver object at 0x7f9792e1da30> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,763 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97926b1c50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,767 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97926b1c10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,769 DEBUG Received frame <Basic.Deliver object at 0x7f9792e1ce90> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,770 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97926b2310> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,772 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97926b1510> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,773 DEBUG Received frame <Basic.Deliver object at 0x7f9792e1cef0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,774 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a9b74550> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,791 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,791 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,792 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,794 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0021006339993618894}
2024-07-12 16:11:52,797 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-005.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c8a7ee35ee91810d85\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,800 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.7520000000000002, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 2044897763, "operationId": 2044897763, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,803 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:52,812 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,813 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,814 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,815 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001423767000233056}
2024-07-12 16:11:52,817 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-006.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c8a7ee35ee91810d86\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,820 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 2.9250000000000003, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1967513926, "operationId": 1967513926, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,820 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:52,831 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97b18f4b10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,831 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,831 DEBUG Received frame <Basic.Deliver object at 0x7f9792e1d970> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,832 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,833 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a9dd2b10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,834 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,835 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97926b1d10> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:11:52,836 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0016183759998966707}
2024-07-12 16:11:52,838 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-007.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c8a7ee35ee91810d87\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,839 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,841 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,841 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,843 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,844 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,845 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 6.112, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1365180540, "operationId": 1365180540, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,846 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.0025732679996508523}
2024-07-12 16:11:52,848 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,849 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:52,852 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d85\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 3, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,852 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.004265251000106218}
2024-07-12 16:11:52,855 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.7520000000000002, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d85\"}, \"FileName\": \"1-005.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1540383426, "operationId": 1540383426, "driverConnectionId": 3, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,856 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d86\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,858 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 16:11:52,862 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 5.664, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d86\"}, \"FileName\": \"1-006.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 304089172, "operationId": 304089172, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,866 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 16:11:52,874 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,875 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,876 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,877 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0010268509995512431}
2024-07-12 16:11:52,879 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-008.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c8a7ee35ee91810d88\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,882 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.115, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1303455736, "operationId": 1303455736, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,884 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 16:11:52,899 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,900 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,901 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,902 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0009152909997283132}
2024-07-12 16:11:52,904 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-009.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c8a7ee35ee91810d89\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,907 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 2.8649999999999998, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 35005211, "operationId": 35005211, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,908 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 16:11:52,917 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,919 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,920 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,922 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0014548419994753203}
2024-07-12 16:11:52,925 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-010.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c8a7ee35ee91810d8a\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,928 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.311, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 521595368, "operationId": 521595368, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,931 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 16:11:52,940 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,940 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,941 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,942 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0007285669998964295}
2024-07-12 16:11:52,944 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-011.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c8a7ee35ee91810d8b\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,945 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 1.36, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 294702567, "operationId": 294702567, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,946 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 16:11:52,958 INFO Created new item on mongodb 
2024-07-12 16:11:52,958 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,958 INFO {'_id': ObjectId('669155c8a7ee35ee91810d85'), 'FileName': '1-005.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c8a7ee35ee91810d85'}
2024-07-12 16:11:52,959 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,959 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:52,962 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,963 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0016915000005610636>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,963 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0014291750003394554}
2024-07-12 16:11:52,965 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,965 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-012.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"669155c8a7ee35ee91810d8c\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,966 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.0017230590001418022}
2024-07-12 16:11:52,971 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d87\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 3, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,971 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 5.88, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1726956429, "operationId": 1726956429, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,977 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 16:11:52,978 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 7.276999999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d87\"}, \"FileName\": \"1-007.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 336465782, "operationId": 336465782, "driverConnectionId": 3, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:52,982 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 16:11:52,989 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:11:52,993 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:11:53,002 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:11:53,013 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:11:53,015 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:11:53,019 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:11:53,023 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:11:53,031 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:11:53,032 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:11:53,037 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:11:53,060 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:11:53,100 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:11:53,110 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:11:53,137 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:11:53,137 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:11:53,166 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:11:53,195 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:11:53,306 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:11:53,308 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:11:53,309 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97926e0220>
2024-07-12 16:11:53,309 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:11:53,310 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:11:53,310 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:11:53,311 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:11:53,311 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:11:53,312 DEBUG No configured endpoint found.
2024-07-12 16:11:53,314 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:11:53,316 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:11:53,317 DEBUG Registering retry handlers for service: s3
2024-07-12 16:11:53,318 DEBUG Registering S3 region redirector handler
2024-07-12 16:11:53,320 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:11:53,322 DEBUG Loading s3:s3
2024-07-12 16:11:53,324 DEBUG Loading s3:Bucket
2024-07-12 16:11:53,325 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:53,326 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97926c0ea0>
2024-07-12 16:11:53,327 DEBUG Loading s3:Bucket
2024-07-12 16:11:53,328 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:53,329 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97926c0ea0>
2024-07-12 16:11:53,330 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:11:53,330 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:11:53,331 DEBUG Acquiring 0
2024-07-12 16:11:53,332 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792633010>}) about to wait for the following futures []
2024-07-12 16:11:53,333 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792633010>}) done waiting for dependent futures
2024-07-12 16:11:53,333 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792633010>}) with kwargs {'client': <botocore.client.S3 object at 0x7f9792603910>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f9792630f50>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f9792630ed0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f9792630ad0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792633010>}
2024-07-12 16:11:53,337 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f9792630ad0> for transfer request: 0.
2024-07-12 16:11:53,337 DEBUG Acquiring 0
2024-07-12 16:11:53,338 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:11:53,338 DEBUG Releasing acquire 0/None
2024-07-12 16:11:53,339 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:11:53,340 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f9792603910>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f9792633150>, 'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}
2024-07-12 16:11:53,341 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:11:53,342 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:11:53,342 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:11:53,344 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:11:53,345 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:11:53,345 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979260d210>>
2024-07-12 16:11:53,346 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f97921ec090>>
2024-07-12 16:11:53,347 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:11:53,348 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:53,350 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979260d210>>
2024-07-12 16:11:53,352 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-005.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:53,353 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:11:53,354 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:53,355 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:53,356 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:11:53,363 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:11:53,363 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:11:53,364 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9792640950>>
2024-07-12 16:11:53,364 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:11:53,365 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:11:53,365 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-005.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': '9BlVC/xPz//R1oMP0ZgMjw==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f9792633150>, 'auth_path': '/dicommetadata/1-005.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-005.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f979260dbd0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-005.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f9792633150>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-005.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:11:53,367 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:53,367 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f979260db90>>
2024-07-12 16:11:53,368 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97921ec090>>
2024-07-12 16:11:53,368 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:53,369 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:53,370 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9792640950>>
2024-07-12 16:11:53,372 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:53,372 DEBUG CanonicalRequest:
PUT
/1-005.dcm

content-md5:9BlVC/xPz//R1oMP0ZgMjw==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161153Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:53,373 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161153Z
20240712/us-east-1/s3/aws4_request
1046c9f5cb5ad367d86f68fff4608ec96761d2ccac913763899e6ba41ddd45e5
2024-07-12 16:11:53,374 DEBUG Signature:
7e234b4451a8a3a1c9be524776696485af4f65f2cdf0bc8777f19559d30e4bd4
2024-07-12 16:11:53,375 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:53,375 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:53,376 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-005.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'9BlVC/xPz//R1oMP0ZgMjw==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161153Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=7e234b4451a8a3a1c9be524776696485af4f65f2cdf0bc8777f19559d30e4bd4', 'amz-sdk-invocation-id': b'3e7e4f38-531f-46db-abe5-6f97957d6c88', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:11:53,378 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:53,379 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:11:53,577 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:53,689 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:11:53,690 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:11:53,699 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-005.dcm HTTP/11" 400 None
2024-07-12 16:11:53,700 DEBUG Response headers: {'x-amz-request-id': 'N5E27T5PFAPQQ2FA', 'x-amz-id-2': 'ghlRLbpIBJbVnty/Ylbqw+FqrOESjZHijyaHLzJ4OFL9mt9t7V6C1gTB1k6P1cVdfz6BRHCLHVw=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:11:53 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:11:53,700 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>N5E27T5PFAPQQ2FA</RequestId><HostId>ghlRLbpIBJbVnty/Ylbqw+FqrOESjZHijyaHLzJ4OFL9mt9t7V6C1gTB1k6P1cVdfz6BRHCLHVw=</HostId></Error>'
2024-07-12 16:11:53,704 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f9792640990>
2024-07-12 16:11:53,704 DEBUG No retry needed.
2024-07-12 16:11:53,705 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979260d210>>
2024-07-12 16:11:53,705 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:11:53,706 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:53,707 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979260d210>>
2024-07-12 16:11:53,707 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-005.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:53,709 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:11:53,709 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-005.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-005.dcm
2024-07-12 16:11:53,710 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:53,710 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:53,711 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:11:53,712 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f9792633150>
2024-07-12 16:11:53,713 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:53,713 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f979260db90>>
2024-07-12 16:11:53,714 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97921ec090>>
2024-07-12 16:11:53,714 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:53,715 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:53,715 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9792640950>>
2024-07-12 16:11:53,716 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:53,717 DEBUG CanonicalRequest:
PUT
/1-005.dcm

content-md5:9BlVC/xPz//R1oMP0ZgMjw==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161153Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:53,717 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161153Z
20240712/eu-north-1/s3/aws4_request
15f092a706e755dd8d017fcc2de84fbfb427f885c4b9a4149851611230ada127
2024-07-12 16:11:53,718 DEBUG Signature:
3267a8a64021873443292974784ca7f908d62704f99e1902679cb29ba89a1503
2024-07-12 16:11:53,718 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:53,719 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:53,720 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-005.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'9BlVC/xPz//R1oMP0ZgMjw==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161153Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=3267a8a64021873443292974784ca7f908d62704f99e1902679cb29ba89a1503', 'amz-sdk-invocation-id': b'3e7e4f38-531f-46db-abe5-6f97957d6c88', 'amz-sdk-request': b'ttl=20240712T161253Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:11:53,720 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:53,721 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:11:53,910 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:54,031 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:11:54,793 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-005.dcm HTTP/11" 200 0
2024-07-12 16:11:54,795 DEBUG Response headers: {'x-amz-id-2': 'lvXDoIeD2JbFDLDeXq8mm77i5dz2vd+NZx/twRoEC5p13xfZlle9rM2fSbbx41cDy7Ph6NnNpHY=', 'x-amz-request-id': '7VJZ4WEMESDVTXP0', 'Date': 'Fri, 12 Jul 2024 16:11:55 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"f419550bfc4fcfffd1d6830fd1980c8f"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:11:54,796 DEBUG Response body:
b''
2024-07-12 16:11:54,797 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f9792640990>
2024-07-12 16:11:54,799 DEBUG No retry needed.
2024-07-12 16:11:54,800 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979260d210>>
2024-07-12 16:11:54,801 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:11:54,805 DEBUG Releasing acquire 0/None
2024-07-12 16:11:54,807 INFO Created new item on mongodb 
2024-07-12 16:11:54,808 INFO {'_id': ObjectId('669155c8a7ee35ee91810d86'), 'FileName': '1-006.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c8a7ee35ee91810d86'}
2024-07-12 16:11:54,837 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:11:54,840 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:11:54,842 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:11:54,845 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:11:54,846 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:11:54,847 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:11:54,849 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:11:54,853 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:11:54,853 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:11:54,854 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:11:54,855 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:11:54,870 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:11:54,872 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:11:54,901 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:11:54,901 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:11:54,921 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:11:54,947 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:11:54,952 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:11:54,957 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:11:54,958 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97926e04a0>
2024-07-12 16:11:54,958 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:11:54,959 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:11:54,960 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:11:54,960 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:11:54,961 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:11:54,961 DEBUG No configured endpoint found.
2024-07-12 16:11:54,963 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:11:54,967 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:11:54,968 DEBUG Registering retry handlers for service: s3
2024-07-12 16:11:54,970 DEBUG Registering S3 region redirector handler
2024-07-12 16:11:54,971 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:11:54,972 DEBUG Loading s3:s3
2024-07-12 16:11:54,974 DEBUG Loading s3:Bucket
2024-07-12 16:11:54,975 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:54,977 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ae6160>
2024-07-12 16:11:54,977 DEBUG Loading s3:Bucket
2024-07-12 16:11:54,978 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:54,979 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ae6160>
2024-07-12 16:11:54,980 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:11:54,980 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:11:54,981 DEBUG Acquiring 0
2024-07-12 16:11:54,982 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9793f42290>}) about to wait for the following futures []
2024-07-12 16:11:54,983 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9793f42290>}) done waiting for dependent futures
2024-07-12 16:11:54,983 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9793f42290>}) with kwargs {'client': <botocore.client.S3 object at 0x7f97a80d6750>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f9793f41650>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f9793f415d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f9793f41910>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9793f42290>}
2024-07-12 16:11:54,986 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f9793f41910> for transfer request: 0.
2024-07-12 16:11:54,986 DEBUG Acquiring 0
2024-07-12 16:11:54,987 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:11:54,988 DEBUG Releasing acquire 0/None
2024-07-12 16:11:54,988 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:11:54,991 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f97a80d6750>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f9793f42090>, 'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}
2024-07-12 16:11:54,993 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:11:54,994 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:11:54,995 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:11:54,996 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:11:54,997 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:11:54,998 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a81ee550>>
2024-07-12 16:11:55,000 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f97b0b70510>>
2024-07-12 16:11:55,000 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:11:55,001 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:55,002 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a81ee550>>
2024-07-12 16:11:55,003 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-006.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:55,005 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:11:55,005 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:55,006 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:55,007 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:11:55,013 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:11:55,014 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:11:55,014 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a8080810>>
2024-07-12 16:11:55,016 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:11:55,017 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:11:55,018 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-006.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'iGEOG6jR5dRN245L5QXhuQ==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f9793f42090>, 'auth_path': '/dicommetadata/1-006.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-006.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f9793f11810>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-006.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f9793f42090>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-006.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:11:55,019 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:55,020 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9793f11750>>
2024-07-12 16:11:55,021 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97b0b70510>>
2024-07-12 16:11:55,021 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:55,023 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:55,025 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a8080810>>
2024-07-12 16:11:55,026 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:55,026 DEBUG CanonicalRequest:
PUT
/1-006.dcm

content-md5:iGEOG6jR5dRN245L5QXhuQ==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161155Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:55,027 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161155Z
20240712/us-east-1/s3/aws4_request
1d7d8936e9595308a7eb30660fb5112366ade45424f1709043b9b7ce327f74b4
2024-07-12 16:11:55,028 DEBUG Signature:
19134c61fcb5464cab334078020c3560e4003b09bba139a8fe1cf635d65cb17d
2024-07-12 16:11:55,028 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:55,029 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:55,030 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-006.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'iGEOG6jR5dRN245L5QXhuQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161155Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=19134c61fcb5464cab334078020c3560e4003b09bba139a8fe1cf635d65cb17d', 'amz-sdk-invocation-id': b'a16fd0f6-e05a-4270-9c04-1a4573b298da', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:11:55,032 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:55,032 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:11:55,389 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:55,506 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:11:55,507 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:11:55,516 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-006.dcm HTTP/11" 400 None
2024-07-12 16:11:55,517 DEBUG Response headers: {'x-amz-request-id': 'KS3AH2HAMH8KCC3Q', 'x-amz-id-2': 'NNeNT2E9a7qEZEPyT/PyqlEi32XROYBodVPYkQ7ti6+fKcPaL/rPocj+XmMc8r31A4hTj6Mnofg=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:11:55 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:11:55,518 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>KS3AH2HAMH8KCC3Q</RequestId><HostId>NNeNT2E9a7qEZEPyT/PyqlEi32XROYBodVPYkQ7ti6+fKcPaL/rPocj+XmMc8r31A4hTj6Mnofg=</HostId></Error>'
2024-07-12 16:11:55,521 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f979265b0d0>
2024-07-12 16:11:55,521 DEBUG No retry needed.
2024-07-12 16:11:55,522 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a81ee550>>
2024-07-12 16:11:55,522 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:11:55,523 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:55,523 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a81ee550>>
2024-07-12 16:11:55,524 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-006.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:55,526 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:11:55,526 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-006.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-006.dcm
2024-07-12 16:11:55,526 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:55,527 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:55,528 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:11:55,529 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f9793f42090>
2024-07-12 16:11:55,530 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:55,531 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9793f11750>>
2024-07-12 16:11:55,531 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97b0b70510>>
2024-07-12 16:11:55,532 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:55,532 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:55,533 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a8080810>>
2024-07-12 16:11:55,534 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:55,535 DEBUG CanonicalRequest:
PUT
/1-006.dcm

content-md5:iGEOG6jR5dRN245L5QXhuQ==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161155Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:55,535 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161155Z
20240712/eu-north-1/s3/aws4_request
7f1f3e6eb4ccd900d1cb8d08ac5b126374b93c00751de40d99718754d6318c12
2024-07-12 16:11:55,536 DEBUG Signature:
b8d5b3f75c2510fc2b2f298b4e228da0c8468fd7808a48b44e734fc4db3b89e1
2024-07-12 16:11:55,537 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:55,538 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:55,538 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-006.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'iGEOG6jR5dRN245L5QXhuQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161155Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=b8d5b3f75c2510fc2b2f298b4e228da0c8468fd7808a48b44e734fc4db3b89e1', 'amz-sdk-invocation-id': b'a16fd0f6-e05a-4270-9c04-1a4573b298da', 'amz-sdk-request': b'ttl=20240712T161255Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:11:55,540 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:55,540 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:11:55,729 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:55,848 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:11:57,086 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-006.dcm HTTP/11" 200 0
2024-07-12 16:11:57,087 DEBUG Response headers: {'x-amz-id-2': '3d6dqb9CkJwE2zrvFLXNARIM+xXAFI/UpetDbR+eGJyXCIEbYWOqhy3Y6s6d6P7eBGuhB6uaL7Y=', 'x-amz-request-id': 'XJX3HXZ7877E5YXW', 'Date': 'Fri, 12 Jul 2024 16:11:57 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"88610e1ba8d1e5d44ddb8e4be505e1b9"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:11:57,087 DEBUG Response body:
b''
2024-07-12 16:11:57,088 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f979265b0d0>
2024-07-12 16:11:57,089 DEBUG No retry needed.
2024-07-12 16:11:57,090 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a81ee550>>
2024-07-12 16:11:57,090 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:11:57,093 DEBUG Releasing acquire 0/None
2024-07-12 16:11:57,094 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x05\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:11:57,095 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014189830004761464>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:57,096 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x06\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:11:57,097 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014189830004761464>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,097 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014189830004761464>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:57,100 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,102 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014189830004761464>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,103 INFO Created new item on mongodb 
2024-07-12 16:11:57,103 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014189830004761464>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:57,104 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "durationMS": 0.0031006259996502195}
2024-07-12 16:11:57,104 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,105 INFO {'_id': ObjectId('669155c8a7ee35ee91810d87'), 'FileName': '1-007.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c8a7ee35ee91810d87'}
2024-07-12 16:11:57,106 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014189830004761464>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,106 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014189830004761464>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:57,107 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d88\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 3, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,107 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.0030098750003162422}
2024-07-12 16:11:57,110 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,111 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014189830004761464>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,111 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014189830004761464>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:11:57,113 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d89\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,117 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.006828251000115415}
2024-07-12 16:11:57,119 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,123 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0014189830004761464>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,124 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 17.102, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d88\"}, \"FileName\": \"1-008.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 278722862, "operationId": 278722862, "driverConnectionId": 3, "serverConnectionId": 10, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,127 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d8a\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NUyFZOZWRPOnwvphWKefEQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 2145174067, "operationId": 2145174067, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,128 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 14.802, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d89\"}, \"FileName\": \"1-009.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 233665123, "operationId": 233665123, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,129 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 16:11:57,131 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,133 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3}
2024-07-12 16:11:57,134 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 7.178999999999999, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d8a\"}, \"FileName\": \"1-010.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 2145174067, "operationId": 2145174067, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,136 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 16:11:57,138 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection created", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:11:57,140 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.0007086759997037007}
2024-07-12 16:11:57,141 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:11:57,143 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:11:57,146 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection ready", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0011336420002407976}
2024-07-12 16:11:57,147 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.028358738999486377}
2024-07-12 16:11:57,154 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:11:57,155 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.023551553999823227}
2024-07-12 16:11:57,156 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d8b\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NUyFZOZWRPOnwvphWKefEQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1801979802, "operationId": 1801979802, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,158 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:11:57,159 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d8c\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1315634022, "operationId": 1315634022, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,163 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:11:57,163 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 7.481, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d8b\"}, \"FileName\": \"1-011.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1801979802, "operationId": 1801979802, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,164 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:11:57,165 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 6.396, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"669155c8a7ee35ee91810d8c\"}, \"FileName\": \"1-012.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1315634022, "operationId": 1315634022, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:11:57,165 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 16:11:57,167 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:11:57,168 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:11:57,171 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:11:57,176 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:11:57,177 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:11:57,177 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:11:57,179 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:11:57,194 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:11:57,197 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:11:57,220 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:11:57,221 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:11:57,241 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:11:57,270 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:11:57,276 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:11:57,279 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:11:57,279 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a9af6d40>
2024-07-12 16:11:57,280 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:11:57,280 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:11:57,281 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:11:57,282 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:11:57,282 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:11:57,282 DEBUG No configured endpoint found.
2024-07-12 16:11:57,285 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:11:57,287 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:11:57,288 DEBUG Registering retry handlers for service: s3
2024-07-12 16:11:57,289 DEBUG Registering S3 region redirector handler
2024-07-12 16:11:57,290 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:11:57,291 DEBUG Loading s3:s3
2024-07-12 16:11:57,293 DEBUG Loading s3:Bucket
2024-07-12 16:11:57,293 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:57,295 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9af5e40>
2024-07-12 16:11:57,295 DEBUG Loading s3:Bucket
2024-07-12 16:11:57,296 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:57,299 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9af5e40>
2024-07-12 16:11:57,299 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:11:57,300 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:11:57,301 DEBUG Acquiring 0
2024-07-12 16:11:57,302 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a84de910>}) about to wait for the following futures []
2024-07-12 16:11:57,302 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a84de910>}) done waiting for dependent futures
2024-07-12 16:11:57,303 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a84de910>}) with kwargs {'client': <botocore.client.S3 object at 0x7f979290bd50>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f97a84ddb50>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97a84ddc10>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97a84ddad0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a84de910>}
2024-07-12 16:11:57,306 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97a84ddad0> for transfer request: 0.
2024-07-12 16:11:57,306 DEBUG Acquiring 0
2024-07-12 16:11:57,307 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:11:57,307 DEBUG Releasing acquire 0/None
2024-07-12 16:11:57,309 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:11:57,311 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f979290bd50>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f97a84df110>, 'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}
2024-07-12 16:11:57,313 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:11:57,313 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:11:57,314 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:11:57,314 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:11:57,315 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:11:57,315 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a8504e90>>
2024-07-12 16:11:57,316 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f97a8170cd0>>
2024-07-12 16:11:57,316 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:11:57,318 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:57,318 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a8504e90>>
2024-07-12 16:11:57,319 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-007.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:57,320 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:11:57,321 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:57,321 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:57,323 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:11:57,329 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:11:57,329 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:11:57,329 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a8509050>>
2024-07-12 16:11:57,330 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:11:57,330 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:11:57,331 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-007.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'i/0M7Fuz5lKie1nbwQpoKg==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f97a84df110>, 'auth_path': '/dicommetadata/1-007.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-007.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f97929424d0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-007.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f97a84df110>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-007.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:11:57,333 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:57,333 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9792942490>>
2024-07-12 16:11:57,334 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a8170cd0>>
2024-07-12 16:11:57,335 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:57,336 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:57,337 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a8509050>>
2024-07-12 16:11:57,338 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:57,339 DEBUG CanonicalRequest:
PUT
/1-007.dcm

content-md5:i/0M7Fuz5lKie1nbwQpoKg==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161157Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:57,340 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161157Z
20240712/us-east-1/s3/aws4_request
e69a2bd89dc13210bdffb0399545a1dd421f1274af67cc2346ec68f927a2cafa
2024-07-12 16:11:57,340 DEBUG Signature:
a81ee47143a150a9892453f4a755064a29093f163b723ba610a7b8804a4bedef
2024-07-12 16:11:57,341 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:57,342 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:57,343 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-007.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'i/0M7Fuz5lKie1nbwQpoKg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161157Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=a81ee47143a150a9892453f4a755064a29093f163b723ba610a7b8804a4bedef', 'amz-sdk-invocation-id': b'35191031-0005-4f50-b496-cba893048a60', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:11:57,344 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:57,345 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:11:57,641 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:57,746 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:11:57,747 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:11:57,756 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-007.dcm HTTP/11" 400 None
2024-07-12 16:11:57,756 DEBUG Response headers: {'x-amz-request-id': 'KAH5WPTBW66Z4YND', 'x-amz-id-2': 'ZuAxyWaX+X5YuMdwTudl8NtyfVzRSZIma9uOYq6zafOsaTfsozF1fFb1Uc/pP5HVk8G4POOugGg=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:11:57 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:11:57,757 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>KAH5WPTBW66Z4YND</RequestId><HostId>ZuAxyWaX+X5YuMdwTudl8NtyfVzRSZIma9uOYq6zafOsaTfsozF1fFb1Uc/pP5HVk8G4POOugGg=</HostId></Error>'
2024-07-12 16:11:57,761 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a8508f50>
2024-07-12 16:11:57,761 DEBUG No retry needed.
2024-07-12 16:11:57,761 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a8504e90>>
2024-07-12 16:11:57,762 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:11:57,762 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:57,763 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a8504e90>>
2024-07-12 16:11:57,764 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-007.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:57,765 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:11:57,766 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-007.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-007.dcm
2024-07-12 16:11:57,766 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:57,767 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:57,767 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:11:57,768 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f97a84df110>
2024-07-12 16:11:57,769 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:57,770 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9792942490>>
2024-07-12 16:11:57,770 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a8170cd0>>
2024-07-12 16:11:57,771 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:57,775 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:57,775 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a8509050>>
2024-07-12 16:11:57,776 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:57,777 DEBUG CanonicalRequest:
PUT
/1-007.dcm

content-md5:i/0M7Fuz5lKie1nbwQpoKg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161157Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:57,777 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161157Z
20240712/eu-north-1/s3/aws4_request
6d5eaaf9f63e8af098e26f6a2704c397a568219c4b8d39a65664f4600e347784
2024-07-12 16:11:57,778 DEBUG Signature:
b64c9d19f1ee9d2975f1d99d8e58cfcdb1d1c4480d53af1f60c7fff715d3c93b
2024-07-12 16:11:57,778 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:57,779 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:57,780 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-007.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'i/0M7Fuz5lKie1nbwQpoKg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161157Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=b64c9d19f1ee9d2975f1d99d8e58cfcdb1d1c4480d53af1f60c7fff715d3c93b', 'amz-sdk-invocation-id': b'35191031-0005-4f50-b496-cba893048a60', 'amz-sdk-request': b'ttl=20240712T161257Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:11:57,781 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:57,781 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:11:58,070 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:58,208 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:11:58,902 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-007.dcm HTTP/11" 200 0
2024-07-12 16:11:58,902 DEBUG Response headers: {'x-amz-id-2': 'uSBO6WoEWKtta3OLiFS/hBdSbe/rS7Akqp6xW4lGvbN8I8nDfTe8KxkHvdEeZ+SkxytnC8SXXgRfUOg7UsvHgYN+X1r2Bj7F', 'x-amz-request-id': 'AZAQC0NFM8HW762D', 'Date': 'Fri, 12 Jul 2024 16:11:59 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"8bfd0cec5bb3e652a27b59dbc10a682a"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:11:58,903 DEBUG Response body:
b''
2024-07-12 16:11:58,904 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a8508f50>
2024-07-12 16:11:58,904 DEBUG No retry needed.
2024-07-12 16:11:58,905 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a8504e90>>
2024-07-12 16:11:58,905 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:11:58,907 DEBUG Releasing acquire 0/None
2024-07-12 16:11:58,912 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x07\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:11:58,912 INFO Created new item on mongodb 
2024-07-12 16:11:58,913 INFO {'_id': ObjectId('669155c8a7ee35ee91810d88'), 'FileName': '1-008.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c8a7ee35ee91810d88'}
2024-07-12 16:11:58,934 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:11:58,938 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:11:58,940 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:11:58,944 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:11:58,944 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:11:58,946 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:11:58,948 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:11:58,953 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:11:58,954 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:11:58,954 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:11:58,956 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:11:58,976 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:11:58,979 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:11:59,003 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:11:59,004 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:11:59,024 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:11:59,055 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:11:59,183 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:11:59,185 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:11:59,186 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97926e1a80>
2024-07-12 16:11:59,186 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:11:59,188 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:11:59,188 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:11:59,189 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:11:59,189 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:11:59,191 DEBUG No configured endpoint found.
2024-07-12 16:11:59,195 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:11:59,200 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:11:59,201 DEBUG Registering retry handlers for service: s3
2024-07-12 16:11:59,202 DEBUG Registering S3 region redirector handler
2024-07-12 16:11:59,204 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:11:59,205 DEBUG Loading s3:s3
2024-07-12 16:11:59,207 DEBUG Loading s3:Bucket
2024-07-12 16:11:59,207 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:59,210 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9af5260>
2024-07-12 16:11:59,210 DEBUG Loading s3:Bucket
2024-07-12 16:11:59,211 DEBUG Renaming Bucket attribute name
2024-07-12 16:11:59,213 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9af5260>
2024-07-12 16:11:59,214 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:11:59,215 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:11:59,216 DEBUG Acquiring 0
2024-07-12 16:11:59,217 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9d37510>}) about to wait for the following futures []
2024-07-12 16:11:59,218 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9d37510>}) done waiting for dependent futures
2024-07-12 16:11:59,218 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9d37510>}) with kwargs {'client': <botocore.client.S3 object at 0x7f97a9eca890>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f97a9da8350>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97a9d35ed0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97a9d34610>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9d37510>}
2024-07-12 16:11:59,222 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97a9d34610> for transfer request: 0.
2024-07-12 16:11:59,223 DEBUG Acquiring 0
2024-07-12 16:11:59,223 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:11:59,224 DEBUG Releasing acquire 0/None
2024-07-12 16:11:59,224 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:11:59,227 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f97a9eca890>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f97a84ab090>, 'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}
2024-07-12 16:11:59,228 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:11:59,229 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:11:59,229 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:11:59,230 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:11:59,230 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:11:59,231 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9f65190>>
2024-07-12 16:11:59,232 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f9792d64b10>>
2024-07-12 16:11:59,233 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:11:59,234 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:59,234 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9f65190>>
2024-07-12 16:11:59,235 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-008.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:59,237 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:11:59,237 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:59,238 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:59,239 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:11:59,246 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:11:59,247 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:11:59,247 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9da6710>>
2024-07-12 16:11:59,248 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:11:59,248 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:11:59,249 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-008.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': '4ZtbY+KAbBbziGgHq3N7vg==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f97a84ab090>, 'auth_path': '/dicommetadata/1-008.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-008.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f97a9f76990>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-008.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f97a84ab090>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-008.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:11:59,250 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:59,251 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a9ecbfd0>>
2024-07-12 16:11:59,252 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9792d64b10>>
2024-07-12 16:11:59,253 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:59,254 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:59,255 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9da6710>>
2024-07-12 16:11:59,255 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:59,258 DEBUG CanonicalRequest:
PUT
/1-008.dcm

content-md5:4ZtbY+KAbBbziGgHq3N7vg==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161159Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:59,258 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161159Z
20240712/us-east-1/s3/aws4_request
d4b48568d4ee8b8a14c607908b6e34db38cc50df165ada8320efdb1a589996a9
2024-07-12 16:11:59,259 DEBUG Signature:
e0ef9830efa1c33c37c3c02cb06da97c76e3e311b2728f81a1a58b02908685f2
2024-07-12 16:11:59,260 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:59,262 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:59,263 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-008.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'4ZtbY+KAbBbziGgHq3N7vg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161159Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=e0ef9830efa1c33c37c3c02cb06da97c76e3e311b2728f81a1a58b02908685f2', 'amz-sdk-invocation-id': b'4ba21f0f-cec5-46e7-8717-34581f8e6f21', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:11:59,264 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:59,264 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:11:59,570 DEBUG Waiting for 100 Continue response.
2024-07-12 16:11:59,675 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:11:59,676 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:11:59,684 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-008.dcm HTTP/11" 400 None
2024-07-12 16:11:59,685 DEBUG Response headers: {'x-amz-request-id': '753Y5PDPN253S2TG', 'x-amz-id-2': 'rduQuyp4v/KHwHc2W6FfoctAVY/CToH2YpOrqsfGjC0ax74ofHqP1jsbq+JM88iZ2dBt/JiDzUs=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:11:59 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:11:59,686 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>753Y5PDPN253S2TG</RequestId><HostId>rduQuyp4v/KHwHc2W6FfoctAVY/CToH2YpOrqsfGjC0ax74ofHqP1jsbq+JM88iZ2dBt/JiDzUs=</HostId></Error>'
2024-07-12 16:11:59,691 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a9da6b50>
2024-07-12 16:11:59,691 DEBUG No retry needed.
2024-07-12 16:11:59,692 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9f65190>>
2024-07-12 16:11:59,693 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:11:59,693 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:11:59,694 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9f65190>>
2024-07-12 16:11:59,695 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-008.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:11:59,696 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:11:59,697 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-008.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-008.dcm
2024-07-12 16:11:59,698 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:11:59,698 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:11:59,699 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:11:59,700 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f97a84ab090>
2024-07-12 16:11:59,701 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:11:59,701 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a9ecbfd0>>
2024-07-12 16:11:59,702 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9792d64b10>>
2024-07-12 16:11:59,703 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:11:59,704 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:11:59,704 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97a9da6710>>
2024-07-12 16:11:59,707 DEBUG Calculating signature using v4 auth.
2024-07-12 16:11:59,708 DEBUG CanonicalRequest:
PUT
/1-008.dcm

content-md5:4ZtbY+KAbBbziGgHq3N7vg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161159Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:11:59,708 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161159Z
20240712/eu-north-1/s3/aws4_request
59b9df031f4e820d2106daafcd6dedc5f28651a9dba7f9410cd8525e3679ea8e
2024-07-12 16:11:59,710 DEBUG Signature:
9e3b00211abfb49e39189c88f87515e1ba6c66fbdfd55cb99bc31757b2b30074
2024-07-12 16:11:59,710 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:11:59,711 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:11:59,712 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-008.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'4ZtbY+KAbBbziGgHq3N7vg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161159Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=9e3b00211abfb49e39189c88f87515e1ba6c66fbdfd55cb99bc31757b2b30074', 'amz-sdk-invocation-id': b'4ba21f0f-cec5-46e7-8717-34581f8e6f21', 'amz-sdk-request': b'ttl=20240712T161259Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:11:59,713 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:11:59,714 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:11:59,894 DEBUG Waiting for 100 Continue response.
2024-07-12 16:12:00,024 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:12:01,044 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-008.dcm HTTP/11" 200 0
2024-07-12 16:12:01,045 DEBUG Response headers: {'x-amz-id-2': 'WMx0pwUbcisJrM7T041Ttwi9ZZRuKi7qtHBcsbVOs82zwhEOm6s8+rrFiD69XK7s6WAcqwKn1Vku9+4FmwZ1GxqI/EfO6Ed+', 'x-amz-request-id': '1XYEJ0AM7PK3F5HA', 'Date': 'Fri, 12 Jul 2024 16:12:01 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"e19b5b63e2806c16f3886807ab737bbe"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:12:01,046 DEBUG Response body:
b''
2024-07-12 16:12:01,046 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a9da6b50>
2024-07-12 16:12:01,047 DEBUG No retry needed.
2024-07-12 16:12:01,047 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9f65190>>
2024-07-12 16:12:01,048 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:12:01,050 DEBUG Releasing acquire 0/None
2024-07-12 16:12:01,051 INFO Created new item on mongodb 
2024-07-12 16:12:01,051 INFO {'_id': ObjectId('669155c8a7ee35ee91810d89'), 'FileName': '1-009.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c8a7ee35ee91810d89'}
2024-07-12 16:12:01,070 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:12:01,074 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:12:01,076 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:12:01,080 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:12:01,080 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:12:01,082 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:12:01,084 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:12:01,089 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:12:01,090 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:12:01,090 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:12:01,091 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:12:01,111 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:12:01,114 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:12:01,140 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:12:01,141 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:12:01,164 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:12:01,194 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:12:01,199 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:12:01,204 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:12:01,204 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97b0b39940>
2024-07-12 16:12:01,205 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:12:01,207 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:12:01,207 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:12:01,208 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:12:01,208 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:12:01,209 DEBUG No configured endpoint found.
2024-07-12 16:12:01,215 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:12:01,220 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:12:01,221 DEBUG Registering retry handlers for service: s3
2024-07-12 16:12:01,222 DEBUG Registering S3 region redirector handler
2024-07-12 16:12:01,225 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:12:01,226 DEBUG Loading s3:s3
2024-07-12 16:12:01,228 DEBUG Loading s3:Bucket
2024-07-12 16:12:01,228 DEBUG Renaming Bucket attribute name
2024-07-12 16:12:01,230 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ae62a0>
2024-07-12 16:12:01,230 DEBUG Loading s3:Bucket
2024-07-12 16:12:01,231 DEBUG Renaming Bucket attribute name
2024-07-12 16:12:01,233 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ae62a0>
2024-07-12 16:12:01,234 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:12:01,234 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:12:01,236 DEBUG Acquiring 0
2024-07-12 16:12:01,237 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97927ef350>}) about to wait for the following futures []
2024-07-12 16:12:01,238 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97927ef350>}) done waiting for dependent futures
2024-07-12 16:12:01,239 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97927ef350>}) with kwargs {'client': <botocore.client.S3 object at 0x7f97927b6b50>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f9791febf10>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97927ee750>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97927eec50>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97927ef350>}
2024-07-12 16:12:01,243 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97927eec50> for transfer request: 0.
2024-07-12 16:12:01,244 DEBUG Acquiring 0
2024-07-12 16:12:01,245 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:12:01,245 DEBUG Releasing acquire 0/None
2024-07-12 16:12:01,246 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:12:01,248 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f97927b6b50>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f9791fe2f10>, 'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}
2024-07-12 16:12:01,250 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:12:01,250 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:12:01,251 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:12:01,251 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:12:01,252 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:12:01,253 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97927c9810>>
2024-07-12 16:12:01,254 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f97a80afa90>>
2024-07-12 16:12:01,255 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:12:01,256 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:12:01,257 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97927c9810>>
2024-07-12 16:12:01,257 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-009.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:12:01,259 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:12:01,259 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:12:01,260 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:12:01,261 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:12:01,270 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:12:01,271 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:12:01,271 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97927c05d0>>
2024-07-12 16:12:01,272 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:12:01,273 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:12:01,274 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-009.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'StO71PKSrNjWWpeYC4PYKQ==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f9791fe2f10>, 'auth_path': '/dicommetadata/1-009.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-009.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f9792785f10>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-009.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f9791fe2f10>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-009.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:12:01,276 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:12:01,277 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9792785fd0>>
2024-07-12 16:12:01,277 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a80afa90>>
2024-07-12 16:12:01,278 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:12:01,278 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:12:01,285 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97927c05d0>>
2024-07-12 16:12:01,289 DEBUG Calculating signature using v4 auth.
2024-07-12 16:12:01,291 DEBUG CanonicalRequest:
PUT
/1-009.dcm

content-md5:StO71PKSrNjWWpeYC4PYKQ==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161201Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:12:01,293 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161201Z
20240712/us-east-1/s3/aws4_request
9875f20846c3d7ade1822db8db87e6c53b79d5ad5959b30fbaf52e77f3294f0a
2024-07-12 16:12:01,295 DEBUG Signature:
f33af0dff78816eeb00aa8219d96ab7b0d64d3547b769af0c8d90a110a0343a5
2024-07-12 16:12:01,296 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:12:01,297 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:12:01,298 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-009.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'StO71PKSrNjWWpeYC4PYKQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161201Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=f33af0dff78816eeb00aa8219d96ab7b0d64d3547b769af0c8d90a110a0343a5', 'amz-sdk-invocation-id': b'12fc2c65-8e93-4f48-8895-cc455a61da00', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:12:01,302 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:12:01,303 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:12:01,679 DEBUG Waiting for 100 Continue response.
2024-07-12 16:12:01,787 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:12:01,787 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:12:01,795 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-009.dcm HTTP/11" 400 None
2024-07-12 16:12:01,796 DEBUG Response headers: {'x-amz-request-id': 'MS1BKS870HNF642B', 'x-amz-id-2': 'k8xQazjFUkEjhvjnY+R7gLOLcEz5gYrxL6P7K5aIMgd3ofJ0ZmMouiXMIBkzxIfOucNtIUjMrgg=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:12:01 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:12:01,796 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>MS1BKS870HNF642B</RequestId><HostId>k8xQazjFUkEjhvjnY+R7gLOLcEz5gYrxL6P7K5aIMgd3ofJ0ZmMouiXMIBkzxIfOucNtIUjMrgg=</HostId></Error>'
2024-07-12 16:12:01,801 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97927c1790>
2024-07-12 16:12:01,802 DEBUG No retry needed.
2024-07-12 16:12:01,803 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97927c9810>>
2024-07-12 16:12:01,803 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:12:01,804 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:12:01,805 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97927c9810>>
2024-07-12 16:12:01,806 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-009.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:12:01,808 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:12:01,808 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-009.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-009.dcm
2024-07-12 16:12:01,809 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:12:01,809 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:12:01,810 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:12:01,811 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f9791fe2f10>
2024-07-12 16:12:01,811 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:12:01,812 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9792785fd0>>
2024-07-12 16:12:01,813 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a80afa90>>
2024-07-12 16:12:01,814 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:12:01,815 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:12:01,815 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97927c05d0>>
2024-07-12 16:12:01,817 DEBUG Calculating signature using v4 auth.
2024-07-12 16:12:01,817 DEBUG CanonicalRequest:
PUT
/1-009.dcm

content-md5:StO71PKSrNjWWpeYC4PYKQ==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161201Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:12:01,818 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161201Z
20240712/eu-north-1/s3/aws4_request
22ed191ccd71907dd7cfeb6f3ae98b7d91d4db4c940f64219ea5ce65c3375a2d
2024-07-12 16:12:01,821 DEBUG Signature:
7030b2169be7bef67bf5de4b3b9bf20573d531b3caaea005bddded7fb2b9f6e4
2024-07-12 16:12:01,823 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:12:01,824 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:12:01,826 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-009.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'StO71PKSrNjWWpeYC4PYKQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161201Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=7030b2169be7bef67bf5de4b3b9bf20573d531b3caaea005bddded7fb2b9f6e4', 'amz-sdk-invocation-id': b'12fc2c65-8e93-4f48-8895-cc455a61da00', 'amz-sdk-request': b'ttl=20240712T161301Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:12:01,827 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:12:01,828 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:12:02,040 DEBUG Waiting for 100 Continue response.
2024-07-12 16:12:02,172 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:12:02,929 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-009.dcm HTTP/11" 200 0
2024-07-12 16:12:02,929 DEBUG Response headers: {'x-amz-id-2': 'gvDrpoGzuVmvakH79UXo6sh3btVtr8BdBnIYX4IkfOPk+rQWQsaUjoL09qhkvQZXUh8093p0PYG8rEIHG10qhBuR+rhfFPuv', 'x-amz-request-id': 'MS185F1N9KXPJZFS', 'Date': 'Fri, 12 Jul 2024 16:12:03 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"4ad3bbd4f292acd8d65a97980b83d829"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:12:02,930 DEBUG Response body:
b''
2024-07-12 16:12:02,931 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97927c1790>
2024-07-12 16:12:02,932 DEBUG No retry needed.
2024-07-12 16:12:02,932 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97927c9810>>
2024-07-12 16:12:02,933 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:12:02,935 DEBUG Releasing acquire 0/None
2024-07-12 16:12:02,935 INFO Created new item on mongodb 
2024-07-12 16:12:02,936 INFO {'_id': ObjectId('669155c8a7ee35ee91810d8a'), 'FileName': '1-010.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c8a7ee35ee91810d8a'}
2024-07-12 16:12:02,957 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:12:02,960 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:12:02,961 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:12:02,964 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:12:02,965 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:12:02,967 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:12:02,968 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:12:02,972 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:12:02,974 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:12:02,975 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:12:02,975 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:12:02,992 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:12:02,994 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:12:03,016 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:12:03,017 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:12:03,037 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:12:03,067 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:12:03,072 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:12:03,075 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:12:03,076 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a9af5300>
2024-07-12 16:12:03,076 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:12:03,077 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:12:03,077 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:12:03,078 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:12:03,079 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:12:03,079 DEBUG No configured endpoint found.
2024-07-12 16:12:03,082 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:12:03,085 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:12:03,085 DEBUG Registering retry handlers for service: s3
2024-07-12 16:12:03,086 DEBUG Registering S3 region redirector handler
2024-07-12 16:12:03,087 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:12:03,088 DEBUG Loading s3:s3
2024-07-12 16:12:03,090 DEBUG Loading s3:Bucket
2024-07-12 16:12:03,090 DEBUG Renaming Bucket attribute name
2024-07-12 16:12:03,092 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97926c14e0>
2024-07-12 16:12:03,092 DEBUG Loading s3:Bucket
2024-07-12 16:12:03,093 DEBUG Renaming Bucket attribute name
2024-07-12 16:12:03,094 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97926c14e0>
2024-07-12 16:12:03,095 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:12:03,096 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:12:03,097 DEBUG Acquiring 0
2024-07-12 16:12:03,099 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9790ddee10>}) about to wait for the following futures []
2024-07-12 16:12:03,100 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9790ddee10>}) done waiting for dependent futures
2024-07-12 16:12:03,101 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9790ddee10>}) with kwargs {'client': <botocore.client.S3 object at 0x7f9790d77dd0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f97926daf50>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f9790dc6f50>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f9790dde390>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9790ddee10>}
2024-07-12 16:12:03,104 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f9790dde390> for transfer request: 0.
2024-07-12 16:12:03,104 DEBUG Acquiring 0
2024-07-12 16:12:03,105 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:12:03,105 DEBUG Releasing acquire 0/None
2024-07-12 16:12:03,106 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:12:03,107 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f9790d77dd0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f9790ddf610>, 'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}
2024-07-12 16:12:03,108 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:12:03,109 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:12:03,109 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:12:03,110 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:12:03,110 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:12:03,110 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9790db1350>>
2024-07-12 16:12:03,111 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f9792028e10>>
2024-07-12 16:12:03,111 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:12:03,112 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:12:03,113 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9790db1350>>
2024-07-12 16:12:03,114 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-010.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:12:03,115 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:12:03,115 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:12:03,116 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:12:03,117 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:12:03,123 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:12:03,123 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:12:03,123 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9790dbd590>>
2024-07-12 16:12:03,124 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:12:03,125 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:12:03,127 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-010.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'qBwz0iUuuRh2bjNkLBVmSw==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f9790ddf610>, 'auth_path': '/dicommetadata/1-010.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-010.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f9790d9e490>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-010.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f9790ddf610>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-010.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:12:03,129 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:12:03,130 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9790d9e450>>
2024-07-12 16:12:03,131 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9792028e10>>
2024-07-12 16:12:03,131 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:12:03,133 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:12:03,134 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9790dbd590>>
2024-07-12 16:12:03,135 DEBUG Calculating signature using v4 auth.
2024-07-12 16:12:03,136 DEBUG CanonicalRequest:
PUT
/1-010.dcm

content-md5:qBwz0iUuuRh2bjNkLBVmSw==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161203Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:12:03,137 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161203Z
20240712/us-east-1/s3/aws4_request
7b25799d585a9387e9b9616f72c20f0eb56a396c70a9a1462049ac03c8527c89
2024-07-12 16:12:03,137 DEBUG Signature:
5d7b305c31e2557096566ff4a769df200480014fe9da9ee361b7a2dbdc8e44eb
2024-07-12 16:12:03,138 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:12:03,139 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:12:03,139 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-010.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'qBwz0iUuuRh2bjNkLBVmSw==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161203Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=5d7b305c31e2557096566ff4a769df200480014fe9da9ee361b7a2dbdc8e44eb', 'amz-sdk-invocation-id': b'cfd13df8-b9bc-4ecc-aad1-47ebadacd755', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:12:03,140 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:12:03,141 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:12:03,426 DEBUG Waiting for 100 Continue response.
2024-07-12 16:12:03,528 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:12:03,529 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:12:03,538 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-010.dcm HTTP/11" 400 None
2024-07-12 16:12:03,539 DEBUG Response headers: {'x-amz-request-id': 'D1HNKGR4720WYTP8', 'x-amz-id-2': '3bb77SKAibFeirxDu61dDQwtlgDrfwS6ArKpjkfgkD6GyGySmRE2B7ByU2LYjd0Pi3mBBdiS5Fk=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:12:03 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:12:03,540 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>D1HNKGR4720WYTP8</RequestId><HostId>3bb77SKAibFeirxDu61dDQwtlgDrfwS6ArKpjkfgkD6GyGySmRE2B7ByU2LYjd0Pi3mBBdiS5Fk=</HostId></Error>'
2024-07-12 16:12:03,543 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f9790dbd310>
2024-07-12 16:12:03,544 DEBUG No retry needed.
2024-07-12 16:12:03,544 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9790db1350>>
2024-07-12 16:12:03,545 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:12:03,545 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:12:03,546 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9790db1350>>
2024-07-12 16:12:03,547 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-010.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:12:03,548 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:12:03,548 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-010.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-010.dcm
2024-07-12 16:12:03,549 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:12:03,549 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:12:03,550 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:12:03,551 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f9790ddf610>
2024-07-12 16:12:03,552 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:12:03,553 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9790d9e450>>
2024-07-12 16:12:03,553 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9792028e10>>
2024-07-12 16:12:03,554 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:12:03,554 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:12:03,555 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9790dbd590>>
2024-07-12 16:12:03,556 DEBUG Calculating signature using v4 auth.
2024-07-12 16:12:03,556 DEBUG CanonicalRequest:
PUT
/1-010.dcm

content-md5:qBwz0iUuuRh2bjNkLBVmSw==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161203Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:12:03,557 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161203Z
20240712/eu-north-1/s3/aws4_request
a411550aa66bc8af185c31bcbc2e1c62032052c4d4972baf33411da572641a83
2024-07-12 16:12:03,558 DEBUG Signature:
18b52c8650724c32e46da32de24d05bae8add596335cdc56016fd38dec600908
2024-07-12 16:12:03,558 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:12:03,559 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:12:03,559 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-010.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'qBwz0iUuuRh2bjNkLBVmSw==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161203Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=18b52c8650724c32e46da32de24d05bae8add596335cdc56016fd38dec600908', 'amz-sdk-invocation-id': b'cfd13df8-b9bc-4ecc-aad1-47ebadacd755', 'amz-sdk-request': b'ttl=20240712T161303Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:12:03,560 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:12:03,561 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:12:03,849 DEBUG Waiting for 100 Continue response.
2024-07-12 16:12:03,998 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:12:04,854 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-010.dcm HTTP/11" 200 0
2024-07-12 16:12:04,855 DEBUG Response headers: {'x-amz-id-2': 'CCM2wqQxVm9uc6HO0GTktXb9tvYvQ1BCz9+x+iceVe4s6x+ZE8Br0ylW4RChvRGYah4jafNQtZ8GsyVJp75KrYnpVwkNWzhx', 'x-amz-request-id': 'D1HJ6SFCFN2DJFMP', 'Date': 'Fri, 12 Jul 2024 16:12:05 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"a81c33d2252eb918766e33642c15664b"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:12:04,856 DEBUG Response body:
b''
2024-07-12 16:12:04,857 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f9790dbd310>
2024-07-12 16:12:04,857 DEBUG No retry needed.
2024-07-12 16:12:04,858 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9790db1350>>
2024-07-12 16:12:04,859 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:12:04,861 DEBUG Releasing acquire 0/None
2024-07-12 16:12:04,862 INFO Created new item on mongodb 
2024-07-12 16:12:04,862 INFO {'_id': ObjectId('669155c8a7ee35ee91810d8b'), 'FileName': '1-011.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c8a7ee35ee91810d8b'}
2024-07-12 16:12:04,889 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:12:04,892 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:12:04,894 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:12:04,899 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:12:04,900 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:12:04,902 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:12:04,904 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:12:04,908 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:12:04,909 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:12:04,909 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:12:04,910 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:12:04,928 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:12:04,931 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:12:04,953 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:12:04,953 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:12:04,973 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:12:05,000 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:12:05,091 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:12:05,094 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:12:05,094 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a9af62a0>
2024-07-12 16:12:05,094 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:12:05,095 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:12:05,096 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:12:05,096 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:12:05,096 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:12:05,097 DEBUG No configured endpoint found.
2024-07-12 16:12:05,099 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:12:05,102 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:12:05,103 DEBUG Registering retry handlers for service: s3
2024-07-12 16:12:05,104 DEBUG Registering S3 region redirector handler
2024-07-12 16:12:05,105 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:12:05,106 DEBUG Loading s3:s3
2024-07-12 16:12:05,108 DEBUG Loading s3:Bucket
2024-07-12 16:12:05,108 DEBUG Renaming Bucket attribute name
2024-07-12 16:12:05,110 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f9790dd6520>
2024-07-12 16:12:05,110 DEBUG Loading s3:Bucket
2024-07-12 16:12:05,110 DEBUG Renaming Bucket attribute name
2024-07-12 16:12:05,112 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f9790dd6520>
2024-07-12 16:12:05,112 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:12:05,113 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:12:05,114 DEBUG Acquiring 0
2024-07-12 16:12:05,115 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9790472410>}) about to wait for the following futures []
2024-07-12 16:12:05,116 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9790472410>}) done waiting for dependent futures
2024-07-12 16:12:05,117 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9790472410>}) with kwargs {'client': <botocore.client.S3 object at 0x7f97903fec10>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f9790471650>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f9790471710>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97904715d0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9790472410>}
2024-07-12 16:12:05,121 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97904715d0> for transfer request: 0.
2024-07-12 16:12:05,121 DEBUG Acquiring 0
2024-07-12 16:12:05,123 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:12:05,123 DEBUG Releasing acquire 0/None
2024-07-12 16:12:05,123 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:12:05,125 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f97903fec10>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f9790472bd0>, 'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}
2024-07-12 16:12:05,126 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:12:05,127 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:12:05,127 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:12:05,128 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:12:05,128 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:12:05,129 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979043bfd0>>
2024-07-12 16:12:05,129 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f9790729690>>
2024-07-12 16:12:05,130 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:12:05,131 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:12:05,131 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979043bfd0>>
2024-07-12 16:12:05,132 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-011.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:12:05,134 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:12:05,134 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:12:05,135 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:12:05,136 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:12:05,142 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:12:05,142 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:12:05,142 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9790448cd0>>
2024-07-12 16:12:05,143 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:12:05,144 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:12:05,145 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-011.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'tNTYWwA2CbSYpx8/e/z8Nw==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f9790472bd0>, 'auth_path': '/dicommetadata/1-011.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-011.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f9790421650>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-011.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f9790472bd0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-011.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:12:05,147 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:12:05,147 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9790421610>>
2024-07-12 16:12:05,148 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9790729690>>
2024-07-12 16:12:05,149 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:12:05,150 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:12:05,150 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9790448cd0>>
2024-07-12 16:12:05,151 DEBUG Calculating signature using v4 auth.
2024-07-12 16:12:05,152 DEBUG CanonicalRequest:
PUT
/1-011.dcm

content-md5:tNTYWwA2CbSYpx8/e/z8Nw==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161205Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:12:05,153 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161205Z
20240712/us-east-1/s3/aws4_request
7fd6389d8f855c5e2fe86138ea1c03931c2fa3601816fe5fab291b1b1508f2e0
2024-07-12 16:12:05,153 DEBUG Signature:
99963faa330fc76bbfbcd0444aa9f83a4bd885dd8b9d7cc88b5b58751f1ed8d8
2024-07-12 16:12:05,154 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:12:05,155 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:12:05,156 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-011.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'tNTYWwA2CbSYpx8/e/z8Nw==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161205Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=99963faa330fc76bbfbcd0444aa9f83a4bd885dd8b9d7cc88b5b58751f1ed8d8', 'amz-sdk-invocation-id': b'd64c8e15-6a8a-41a7-bd02-4b3d35c146c3', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:12:05,157 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:12:05,158 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:12:05,456 DEBUG Waiting for 100 Continue response.
2024-07-12 16:12:05,566 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:12:05,567 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:12:05,577 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-011.dcm HTTP/11" 400 None
2024-07-12 16:12:05,578 DEBUG Response headers: {'x-amz-request-id': 'A6SJ2PM6WVDS8YX0', 'x-amz-id-2': 'GQqIevJlFBl9sH0T+W5fXqnDAEwm/j3wAM4e8HwbgSGVxBWtOVv5PkjfUxiDQ81gc2+UHT/4Dyg=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:12:05 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:12:05,578 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>A6SJ2PM6WVDS8YX0</RequestId><HostId>GQqIevJlFBl9sH0T+W5fXqnDAEwm/j3wAM4e8HwbgSGVxBWtOVv5PkjfUxiDQ81gc2+UHT/4Dyg=</HostId></Error>'
2024-07-12 16:12:05,582 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f9790448a50>
2024-07-12 16:12:05,582 DEBUG No retry needed.
2024-07-12 16:12:05,583 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979043bfd0>>
2024-07-12 16:12:05,583 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:12:05,584 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:12:05,585 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979043bfd0>>
2024-07-12 16:12:05,586 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-011.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:12:05,587 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:12:05,588 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-011.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-011.dcm
2024-07-12 16:12:05,588 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:12:05,591 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:12:05,591 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:12:05,592 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f9790472bd0>
2024-07-12 16:12:05,593 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:12:05,594 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9790421610>>
2024-07-12 16:12:05,594 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9790729690>>
2024-07-12 16:12:05,595 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:12:05,596 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:12:05,596 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9790448cd0>>
2024-07-12 16:12:05,597 DEBUG Calculating signature using v4 auth.
2024-07-12 16:12:05,598 DEBUG CanonicalRequest:
PUT
/1-011.dcm

content-md5:tNTYWwA2CbSYpx8/e/z8Nw==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161205Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:12:05,599 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161205Z
20240712/eu-north-1/s3/aws4_request
767c815f05e223c5fc29312c343b1bc5822dea06f355594ccda3e33edda893c0
2024-07-12 16:12:05,600 DEBUG Signature:
50ed681cd41a3cb8ad29c920e078dfa07225810b05ced0df5948f1c224f5d2a2
2024-07-12 16:12:05,601 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:12:05,602 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:12:05,602 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-011.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'tNTYWwA2CbSYpx8/e/z8Nw==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161205Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=50ed681cd41a3cb8ad29c920e078dfa07225810b05ced0df5948f1c224f5d2a2', 'amz-sdk-invocation-id': b'd64c8e15-6a8a-41a7-bd02-4b3d35c146c3', 'amz-sdk-request': b'ttl=20240712T161305Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:12:05,603 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:12:05,604 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:12:05,798 DEBUG Waiting for 100 Continue response.
2024-07-12 16:12:05,927 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:12:06,631 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-011.dcm HTTP/11" 200 0
2024-07-12 16:12:06,631 DEBUG Response headers: {'x-amz-id-2': 'Rx9IP4da3AiknFrUtoGffJe1DrtTWdnYF577tj/pkcV0tstYHvsFsmhmCG0A8lHRi4TpV7MPGhy2vMKiePjLgkGjX1rvta0J', 'x-amz-request-id': 'A6SJBQ8NV1473MEJ', 'Date': 'Fri, 12 Jul 2024 16:12:07 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"b4d4d85b003609b498a71f3f7bfcfc37"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:12:06,632 DEBUG Response body:
b''
2024-07-12 16:12:06,633 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f9790448a50>
2024-07-12 16:12:06,633 DEBUG No retry needed.
2024-07-12 16:12:06,634 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979043bfd0>>
2024-07-12 16:12:06,634 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:12:06,636 DEBUG Releasing acquire 0/None
2024-07-12 16:12:06,636 INFO Created new item on mongodb 
2024-07-12 16:12:06,637 INFO {'_id': ObjectId('669155c8a7ee35ee91810d8c'), 'FileName': '1-012.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '669155c8a7ee35ee91810d8c'}
2024-07-12 16:12:06,659 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:12:06,663 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:12:06,666 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:12:06,668 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:12:06,669 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:12:06,671 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:12:06,673 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:12:06,679 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:12:06,680 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:12:06,680 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:12:06,681 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:12:06,698 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:12:06,704 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:12:06,728 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:12:06,729 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:12:06,749 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:12:06,776 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:12:06,782 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:12:06,785 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:12:06,785 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a9af6de0>
2024-07-12 16:12:06,786 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:12:06,788 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:12:06,788 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:12:06,789 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:12:06,790 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:12:06,790 DEBUG No configured endpoint found.
2024-07-12 16:12:06,795 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:12:06,798 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:12:06,799 DEBUG Registering retry handlers for service: s3
2024-07-12 16:12:06,800 DEBUG Registering S3 region redirector handler
2024-07-12 16:12:06,802 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:12:06,804 DEBUG Loading s3:s3
2024-07-12 16:12:06,806 DEBUG Loading s3:Bucket
2024-07-12 16:12:06,807 DEBUG Renaming Bucket attribute name
2024-07-12 16:12:06,808 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f9790474680>
2024-07-12 16:12:06,809 DEBUG Loading s3:Bucket
2024-07-12 16:12:06,809 DEBUG Renaming Bucket attribute name
2024-07-12 16:12:06,811 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f9790474680>
2024-07-12 16:12:06,812 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:12:06,813 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:12:06,813 DEBUG Acquiring 0
2024-07-12 16:12:06,814 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977fa07dd0>}) about to wait for the following futures []
2024-07-12 16:12:06,814 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977fa07dd0>}) done waiting for dependent futures
2024-07-12 16:12:06,815 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977fa07dd0>}) with kwargs {'client': <botocore.client.S3 object at 0x7f977fbb4590>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f977fa07010>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f977fa070d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f977fa06f90>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977fa07dd0>}
2024-07-12 16:12:06,818 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f977fa06f90> for transfer request: 0.
2024-07-12 16:12:06,818 DEBUG Acquiring 0
2024-07-12 16:12:06,819 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:12:06,819 DEBUG Releasing acquire 0/None
2024-07-12 16:12:06,819 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:12:06,820 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f977fbb4590>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f977fa1c610>, 'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}
2024-07-12 16:12:06,821 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:12:06,822 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:12:06,822 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:12:06,822 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:12:06,823 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:12:06,824 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977fbde190>>
2024-07-12 16:12:06,824 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f977fec0950>>
2024-07-12 16:12:06,825 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:12:06,825 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:12:06,826 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977fbde190>>
2024-07-12 16:12:06,827 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-012.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:12:06,828 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:12:06,829 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:12:06,829 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:12:06,830 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:12:06,837 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:12:06,838 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:12:06,838 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977fbea490>>
2024-07-12 16:12:06,838 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:12:06,839 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:12:06,840 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-012.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'PG1velYVPu7gKLMmLEiOSg==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f977fa1c610>, 'auth_path': '/dicommetadata/1-012.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-012.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f977fbcad10>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-012.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f977fa1c610>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-012.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:12:06,841 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:12:06,842 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977fbcacd0>>
2024-07-12 16:12:06,843 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977fec0950>>
2024-07-12 16:12:06,843 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:12:06,844 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:12:06,844 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977fbea490>>
2024-07-12 16:12:06,845 DEBUG Calculating signature using v4 auth.
2024-07-12 16:12:06,846 DEBUG CanonicalRequest:
PUT
/1-012.dcm

content-md5:PG1velYVPu7gKLMmLEiOSg==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161206Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:12:06,846 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161206Z
20240712/us-east-1/s3/aws4_request
c5429b57b94b9364d343740c4a1190a544c61ce17c564928f351366cfc9ad1b1
2024-07-12 16:12:06,847 DEBUG Signature:
6f548ac3352224b06584e076438dc7efbe5e920f9e7279fd7a506a340507e3e8
2024-07-12 16:12:06,848 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:12:06,848 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:12:06,849 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-012.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'PG1velYVPu7gKLMmLEiOSg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161206Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=6f548ac3352224b06584e076438dc7efbe5e920f9e7279fd7a506a340507e3e8', 'amz-sdk-invocation-id': b'8e55670c-a813-425e-bdc1-855fb0762476', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:12:06,850 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:12:06,850 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:12:07,104 DEBUG Waiting for 100 Continue response.
2024-07-12 16:12:07,219 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:12:07,221 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:12:07,231 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-012.dcm HTTP/11" 400 None
2024-07-12 16:12:07,232 DEBUG Response headers: {'x-amz-request-id': '76KC13C59673BYHM', 'x-amz-id-2': 'BB3Z+nTLNJpoIEMVqq4TCGefBSYxhNmMWoKvzH1p07q758rdmKXQ2BuqiEelyBA45NL6QBHEdYc=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:12:07 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:12:07,232 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>76KC13C59673BYHM</RequestId><HostId>BB3Z+nTLNJpoIEMVqq4TCGefBSYxhNmMWoKvzH1p07q758rdmKXQ2BuqiEelyBA45NL6QBHEdYc=</HostId></Error>'
2024-07-12 16:12:07,236 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977fbea210>
2024-07-12 16:12:07,237 DEBUG No retry needed.
2024-07-12 16:12:07,237 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977fbde190>>
2024-07-12 16:12:07,238 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:12:07,238 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:12:07,239 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977fbde190>>
2024-07-12 16:12:07,240 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-012.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:12:07,241 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:12:07,242 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-012.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-012.dcm
2024-07-12 16:12:07,242 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:12:07,243 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:12:07,244 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:12:07,245 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f977fa1c610>
2024-07-12 16:12:07,246 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:12:07,247 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977fbcacd0>>
2024-07-12 16:12:07,247 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977fec0950>>
2024-07-12 16:12:07,248 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:12:07,249 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:12:07,249 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977fbea490>>
2024-07-12 16:12:07,250 DEBUG Calculating signature using v4 auth.
2024-07-12 16:12:07,251 DEBUG CanonicalRequest:
PUT
/1-012.dcm

content-md5:PG1velYVPu7gKLMmLEiOSg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161207Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:12:07,251 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161207Z
20240712/eu-north-1/s3/aws4_request
bc15e32f83e4c575ff7776f10215dc2d2072905f92abb5a810914b51d5a56c46
2024-07-12 16:12:07,252 DEBUG Signature:
d22e705caad5bb94d500704c9ff9642de4c745efb83fc28e1c1de93e38c2698b
2024-07-12 16:12:07,253 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:12:07,254 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:12:07,255 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-012.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'PG1velYVPu7gKLMmLEiOSg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161207Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=d22e705caad5bb94d500704c9ff9642de4c745efb83fc28e1c1de93e38c2698b', 'amz-sdk-invocation-id': b'8e55670c-a813-425e-bdc1-855fb0762476', 'amz-sdk-request': b'ttl=20240712T161307Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:12:07,256 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:12:07,256 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:12:07,447 DEBUG Waiting for 100 Continue response.
2024-07-12 16:12:07,579 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:12:08,270 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-012.dcm HTTP/11" 503 None
2024-07-12 16:12:08,271 DEBUG Response headers: {'x-amz-request-id': '76K28KH1SAFGVKP1', 'x-amz-id-2': 'gQ5aiy1pRMor8mNWvxAAd7jxveAK+7wLrRRVYuKVM0qE/sHQghosRuguetLlMvPp8VeQ/UvKR8ZOanl17OdSrDQPSfTHj2ag', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:12:08 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:12:08,272 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>SlowDown</Code><Message>Please reduce your request rate.</Message><RequestId>76K28KH1SAFGVKP1</RequestId><HostId>gQ5aiy1pRMor8mNWvxAAd7jxveAK+7wLrRRVYuKVM0qE/sHQghosRuguetLlMvPp8VeQ/UvKR8ZOanl17OdSrDQPSfTHj2ag</HostId></Error>'
2024-07-12 16:12:08,273 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977fbea210>
2024-07-12 16:12:08,274 DEBUG retry needed: retryable HTTP status code received: 503
2024-07-12 16:12:08,274 DEBUG Retry needed, action of: 1.599453654600196
2024-07-12 16:12:08,275 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977fbde190>>
2024-07-12 16:12:08,276 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:12:08,277 DEBUG Response received to retry, sleeping for 1.599453654600196 seconds
2024-07-12 16:12:09,877 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f977fa1c610>
2024-07-12 16:12:09,878 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:12:09,878 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977fbcacd0>>
2024-07-12 16:12:09,879 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977fec0950>>
2024-07-12 16:12:09,881 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:12:09,881 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:12:09,883 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977fbea490>>
2024-07-12 16:12:09,884 DEBUG Calculating signature using v4 auth.
2024-07-12 16:12:09,885 DEBUG CanonicalRequest:
PUT
/1-012.dcm

content-md5:PG1velYVPu7gKLMmLEiOSg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161209Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:12:09,885 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161209Z
20240712/eu-north-1/s3/aws4_request
ba80d1d4faf50bec400d94fb78f3c2445d3346ef309257cef0d9a9c7c305a45a
2024-07-12 16:12:09,886 DEBUG Signature:
5fadbc7e596ab59750cbb26658408b181c0d20d7d8c860891c2183426c02370b
2024-07-12 16:12:09,887 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:12:09,888 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:12:09,889 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-012.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'PG1velYVPu7gKLMmLEiOSg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161209Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=5fadbc7e596ab59750cbb26658408b181c0d20d7d8c860891c2183426c02370b', 'amz-sdk-invocation-id': b'8e55670c-a813-425e-bdc1-855fb0762476', 'amz-sdk-request': b'ttl=20240712T161308Z; attempt=3; max=5', 'Content-Length': '527952'}>
2024-07-12 16:12:09,890 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:12:09,891 DEBUG Resetting dropped connection: dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:12:10,181 DEBUG Waiting for 100 Continue response.
2024-07-12 16:12:10,315 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:12:10,817 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-012.dcm HTTP/11" 200 0
2024-07-12 16:12:10,817 DEBUG Response headers: {'x-amz-id-2': 'z6DoJRD0sx4i+Cp1IravJYMil8whk1ByMjGtimq6wrJdnaiZIwWsylNi2WmZ5k5nJdsKlpD8j9E=', 'x-amz-request-id': 'GHKK2MT136AVX4TA', 'Date': 'Fri, 12 Jul 2024 16:12:12 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"3c6d6f7a56153eeee028b3262c488e4a"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:12:10,818 DEBUG Response body:
b''
2024-07-12 16:12:10,819 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977fbea210>
2024-07-12 16:12:10,819 DEBUG No retry needed.
2024-07-12 16:12:10,820 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977fbde190>>
2024-07-12 16:12:10,821 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:12:10,824 DEBUG Releasing acquire 0/None
2024-07-12 16:12:10,827 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x08\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:12:10,828 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\t\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:12:10,829 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\n\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:12:10,830 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0b\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:12:10,831 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0c\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:12:13,192 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:12:44,440 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f97b0ae7710> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:12:45,897 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:13:16,897 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f977feb3f90> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:18,645 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:13:46,748 DEBUG Received frame <Basic.Deliver object at 0x7f9790d80fb0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:46,749 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f977fbea3d0> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:46,750 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f977feb3f90> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:46,775 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:46,777 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:46,778 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:46,779 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0010169500001211418}
2024-07-12 16:13:46,780 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-001.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"6691563aa7ee35ee91810d8d\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1914544919, "operationId": 1914544919, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:46,790 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 10.39, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1914544919, "operationId": 1914544919, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:46,791 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:13:46,793 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:46,793 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:46,795 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:46,796 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0012706829993476276}
2024-07-12 16:13:46,797 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"6691563aa7ee35ee91810d8d\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 608413784, "operationId": 608413784, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:46,799 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 1.966, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"6691563aa7ee35ee91810d8d\"}, \"FileName\": \"1-001.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 608413784, "operationId": 608413784, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:46,800 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:13:46,801 INFO Created new item on mongodb 
2024-07-12 16:13:46,802 INFO {'_id': ObjectId('6691563aa7ee35ee91810d8d'), 'FileName': '1-001.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '6691563aa7ee35ee91810d8d'}
2024-07-12 16:13:46,823 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:13:46,827 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:13:46,829 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:13:46,831 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:13:46,831 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:13:46,834 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:13:46,836 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:13:46,839 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:13:46,840 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:13:46,840 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:13:46,841 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:13:46,857 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:13:46,861 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:13:46,887 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:13:46,888 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:13:46,907 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:13:46,967 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:13:46,978 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:13:46,981 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:13:46,981 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97926c18a0>
2024-07-12 16:13:46,981 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:13:46,982 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:13:46,983 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:13:46,983 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:13:46,984 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:13:46,985 DEBUG No configured endpoint found.
2024-07-12 16:13:46,987 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:13:46,991 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:13:46,992 DEBUG Registering retry handlers for service: s3
2024-07-12 16:13:46,993 DEBUG Registering S3 region redirector handler
2024-07-12 16:13:46,994 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:13:47,000 DEBUG Loading s3:s3
2024-07-12 16:13:47,002 DEBUG Loading s3:Bucket
2024-07-12 16:13:47,003 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:47,005 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97926e0400>
2024-07-12 16:13:47,006 DEBUG Loading s3:Bucket
2024-07-12 16:13:47,006 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:47,008 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97926e0400>
2024-07-12 16:13:47,009 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:13:47,009 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:13:47,011 DEBUG Acquiring 0
2024-07-12 16:13:47,012 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f3608d0>}) about to wait for the following futures []
2024-07-12 16:13:47,012 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f3608d0>}) done waiting for dependent futures
2024-07-12 16:13:47,013 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f3608d0>}) with kwargs {'client': <botocore.client.S3 object at 0x7f977f30d450>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f9792787d90>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f977fa2aad0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f977f357d10>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f3608d0>}
2024-07-12 16:13:47,016 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f977f357d10> for transfer request: 0.
2024-07-12 16:13:47,016 DEBUG Acquiring 0
2024-07-12 16:13:47,017 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:13:47,017 DEBUG Releasing acquire 0/None
2024-07-12 16:13:47,018 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:13:47,019 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f977f30d450>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f977f3610d0>, 'bucket': 'dicommetadata', 'key': '1-001.dcm', 'extra_args': {}}
2024-07-12 16:13:47,020 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:13:47,021 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:13:47,022 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:13:47,023 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:13:47,024 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:13:47,025 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f32f510>>
2024-07-12 16:13:47,025 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f977f623e90>>
2024-07-12 16:13:47,026 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:13:47,028 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:47,028 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f32f510>>
2024-07-12 16:13:47,029 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-001.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:47,031 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:13:47,031 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:47,032 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:47,033 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:13:47,039 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:13:47,040 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:13:47,040 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f337050>>
2024-07-12 16:13:47,041 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:13:47,041 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:13:47,042 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-001.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'IqzV2+YaDNEmllg4cWhtlw==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f977f3610d0>, 'auth_path': '/dicommetadata/1-001.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-001.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f977f31fb50>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-001.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f977f3610d0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-001.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:13:47,043 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:47,044 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f31fb10>>
2024-07-12 16:13:47,045 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977f623e90>>
2024-07-12 16:13:47,045 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:47,046 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:47,047 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f337050>>
2024-07-12 16:13:47,048 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:47,049 DEBUG CanonicalRequest:
PUT
/1-001.dcm

content-md5:IqzV2+YaDNEmllg4cWhtlw==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161347Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:47,050 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161347Z
20240712/us-east-1/s3/aws4_request
52b63095fdfc4d642f9f1d1fb6f2e72b9eac0cae2130b368d6556c27a9e16a82
2024-07-12 16:13:47,051 DEBUG Signature:
a8853a3f54d7644b4298008b7f8ee1d924f39f8119447c82243cea80c9867278
2024-07-12 16:13:47,052 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:47,053 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:47,054 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-001.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'IqzV2+YaDNEmllg4cWhtlw==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161347Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=a8853a3f54d7644b4298008b7f8ee1d924f39f8119447c82243cea80c9867278', 'amz-sdk-invocation-id': b'1146ccc5-b634-409b-828c-5a218a28ee3a', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527938'}>
2024-07-12 16:13:47,056 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:47,057 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:13:47,412 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:47,518 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:13:47,518 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:13:47,525 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-001.dcm HTTP/11" 400 None
2024-07-12 16:13:47,526 DEBUG Response headers: {'x-amz-request-id': 'TXSG45DXZTKA16KQ', 'x-amz-id-2': 'F5JHWVFIa5D6/+PMypTz3SyDKlYfvkk3AvLgb5+Y9XgEoHuWaG9lsugE384Ycd5JBZsQRLfJ6oQ=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:13:48 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:13:47,526 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>TXSG45DXZTKA16KQ</RequestId><HostId>F5JHWVFIa5D6/+PMypTz3SyDKlYfvkk3AvLgb5+Y9XgEoHuWaG9lsugE384Ycd5JBZsQRLfJ6oQ=</HostId></Error>'
2024-07-12 16:13:47,533 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977f336dd0>
2024-07-12 16:13:47,534 DEBUG No retry needed.
2024-07-12 16:13:47,534 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f32f510>>
2024-07-12 16:13:47,535 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:13:47,535 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:47,536 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f32f510>>
2024-07-12 16:13:47,537 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-001.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:47,538 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:13:47,539 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-001.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-001.dcm
2024-07-12 16:13:47,539 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:47,540 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:47,541 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:13:47,542 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f977f3610d0>
2024-07-12 16:13:47,542 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:47,544 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f31fb10>>
2024-07-12 16:13:47,544 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977f623e90>>
2024-07-12 16:13:47,545 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:47,546 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:47,547 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f337050>>
2024-07-12 16:13:47,548 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:47,548 DEBUG CanonicalRequest:
PUT
/1-001.dcm

content-md5:IqzV2+YaDNEmllg4cWhtlw==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161347Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:47,549 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161347Z
20240712/eu-north-1/s3/aws4_request
2cadbd46e59cb7c9fbedd1eb41553703ef7ce9415591166f7a35e67ebaab8b88
2024-07-12 16:13:47,549 DEBUG Signature:
a5334dca7b7e56224c66c2e2e7200837265039c5d669408ec3d49eadaa017478
2024-07-12 16:13:47,550 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:47,551 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:47,552 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-001.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'IqzV2+YaDNEmllg4cWhtlw==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161347Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=a5334dca7b7e56224c66c2e2e7200837265039c5d669408ec3d49eadaa017478', 'amz-sdk-invocation-id': b'1146ccc5-b634-409b-828c-5a218a28ee3a', 'amz-sdk-request': b'ttl=20240712T161448Z; attempt=2; max=5', 'Content-Length': '527938'}>
2024-07-12 16:13:47,553 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:47,554 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:13:47,819 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:47,971 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:13:48,615 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-001.dcm HTTP/11" 200 0
2024-07-12 16:13:48,616 DEBUG Response headers: {'x-amz-id-2': 'W94P5Hp47Y0GaQ2kZx3wf2eZ46a2JpJU2d5IjUO6TFk/56rcgdxIg+P8LVvPySY6hAYXZd2z6DBaG4/YmkYbqD3PXZ9WFkSt', 'x-amz-request-id': 'ZJ8RHR4GT3NDTSM0', 'Date': 'Fri, 12 Jul 2024 16:13:50 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"22acd5dbe61a0cd12696583871686d97"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:13:48,616 DEBUG Response body:
b''
2024-07-12 16:13:48,617 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977f336dd0>
2024-07-12 16:13:48,618 DEBUG No retry needed.
2024-07-12 16:13:48,619 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f32f510>>
2024-07-12 16:13:48,619 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:13:48,621 DEBUG Releasing acquire 0/None
2024-07-12 16:13:48,622 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\r\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:13:48,627 DEBUG Received frame <Basic.Deliver object at 0x7f9792e72ed0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:48,632 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f977feb3f90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:48,634 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f977f4e56d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:48,635 DEBUG Received frame <Basic.Deliver object at 0x7f9792e71910> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:48,635 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f977f336a10> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:48,636 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f977f336bd0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:48,656 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:48,657 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,658 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,660 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0012853499993070727}
2024-07-12 16:13:48,661 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-002.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"6691563ca7ee35ee91810d8e\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 756898537, "operationId": 756898537, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,666 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 4.804, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 756898537, "operationId": 756898537, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,667 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:13:48,683 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:48,684 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,685 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:48,685 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,686 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,688 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.002324942000086594}
2024-07-12 16:13:48,688 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,689 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-003.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"6691563ca7ee35ee91810d8f\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1734575198, "operationId": 1734575198, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,690 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.0018447920001563034}
2024-07-12 16:13:48,692 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"6691563ca7ee35ee91810d8e\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NUyFZOZWRPOnwvphWKefEQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1973594324, "operationId": 1973594324, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,693 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.624, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1734575198, "operationId": 1734575198, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,694 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:13:48,695 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:48,696 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,697 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 4.883, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"6691563ca7ee35ee91810d8e\"}, \"FileName\": \"1-002.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1973594324, "operationId": 1973594324, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,698 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,699 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 16:13:48,699 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0012048670005242457}
2024-07-12 16:13:48,703 INFO Created new item on mongodb 
2024-07-12 16:13:48,704 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"6691563ca7ee35ee91810d8f\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NUyFZOZWRPOnwvphWKefEQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 149798315, "operationId": 149798315, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,704 INFO {'_id': ObjectId('6691563ca7ee35ee91810d8e'), 'FileName': '1-002.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '6691563ca7ee35ee91810d8e'}
2024-07-12 16:13:48,710 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 5.965, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"6691563ca7ee35ee91810d8f\"}, \"FileName\": \"1-003.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 149798315, "operationId": 149798315, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:48,710 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:13:48,739 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:13:48,743 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:13:48,745 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:13:48,749 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:13:48,750 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:13:48,753 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:13:48,756 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:13:48,762 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:13:48,762 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:13:48,763 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:13:48,764 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:13:48,789 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:13:48,792 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:13:48,826 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:13:48,827 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:13:48,854 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:13:48,898 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:13:49,221 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:13:49,223 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:13:49,224 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a97459e0>
2024-07-12 16:13:49,224 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:13:49,225 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:13:49,226 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:13:49,227 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:13:49,227 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:13:49,228 DEBUG No configured endpoint found.
2024-07-12 16:13:49,230 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:13:49,233 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:13:49,235 DEBUG Registering retry handlers for service: s3
2024-07-12 16:13:49,235 DEBUG Registering S3 region redirector handler
2024-07-12 16:13:49,237 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:13:49,238 DEBUG Loading s3:s3
2024-07-12 16:13:49,244 DEBUG Loading s3:Bucket
2024-07-12 16:13:49,247 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:49,249 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97b0b38b80>
2024-07-12 16:13:49,250 DEBUG Loading s3:Bucket
2024-07-12 16:13:49,251 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:49,253 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97b0b38b80>
2024-07-12 16:13:49,254 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:13:49,254 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:13:49,256 DEBUG Acquiring 0
2024-07-12 16:13:49,257 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f4ab410>}) about to wait for the following futures []
2024-07-12 16:13:49,257 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f4ab410>}) done waiting for dependent futures
2024-07-12 16:13:49,258 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f4ab410>}) with kwargs {'client': <botocore.client.S3 object at 0x7f977f43f490>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f977f4aa7d0>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f977f4aa650>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f977f4aab10>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f4ab410>}
2024-07-12 16:13:49,260 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f977f4aab10> for transfer request: 0.
2024-07-12 16:13:49,261 DEBUG Acquiring 0
2024-07-12 16:13:49,261 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:13:49,262 DEBUG Releasing acquire 0/None
2024-07-12 16:13:49,262 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:13:49,263 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f977f43f490>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f977f4abed0>, 'bucket': 'dicommetadata', 'key': '1-002.dcm', 'extra_args': {}}
2024-07-12 16:13:49,264 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:13:49,265 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:13:49,265 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:13:49,266 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:13:49,266 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:13:49,267 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f47a390>>
2024-07-12 16:13:49,267 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f977ee45ad0>>
2024-07-12 16:13:49,268 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:13:49,270 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:49,272 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f47a390>>
2024-07-12 16:13:49,274 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-002.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:49,276 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:13:49,277 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:49,277 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:49,278 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:13:49,287 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:13:49,287 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:13:49,287 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f46df90>>
2024-07-12 16:13:49,288 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:13:49,288 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:13:49,289 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-002.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'pD40LLf3LTnVW4YNdi0ejA==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f977f4abed0>, 'auth_path': '/dicommetadata/1-002.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-002.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f977f461050>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-002.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f977f4abed0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-002.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:13:49,290 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:49,291 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f460ed0>>
2024-07-12 16:13:49,292 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977ee45ad0>>
2024-07-12 16:13:49,292 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:49,293 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:49,293 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f46df90>>
2024-07-12 16:13:49,296 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:49,296 DEBUG CanonicalRequest:
PUT
/1-002.dcm

content-md5:pD40LLf3LTnVW4YNdi0ejA==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161349Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:49,300 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161349Z
20240712/us-east-1/s3/aws4_request
c3bc093a5d9081d9ccb43b1336754516aa7452dd40a43eef1f8ba0839a9ad59f
2024-07-12 16:13:49,302 DEBUG Signature:
f6e115c17c361e4493b05b2038b1072b82c559b5ea718db7b648e6f2bafbd721
2024-07-12 16:13:49,303 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:49,304 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:49,306 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-002.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'pD40LLf3LTnVW4YNdi0ejA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161349Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=f6e115c17c361e4493b05b2038b1072b82c559b5ea718db7b648e6f2bafbd721', 'amz-sdk-invocation-id': b'6f3c07a1-ab7f-4e15-a28e-05e1eebe7b10', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:13:49,308 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:49,309 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:13:49,524 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:49,656 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:13:49,657 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:13:49,665 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-002.dcm HTTP/11" 400 None
2024-07-12 16:13:49,666 DEBUG Response headers: {'x-amz-request-id': '4KC7MSFG8D7BDZNY', 'x-amz-id-2': '4Mw+WEDdgj6Hg1ZZpkqWgw82qOagqJfVyogW+He98h2wEUf0XWw/gmYLGuIq8ZRrjQTLojYHMXo=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:13:50 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:13:49,667 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>4KC7MSFG8D7BDZNY</RequestId><HostId>4Mw+WEDdgj6Hg1ZZpkqWgw82qOagqJfVyogW+He98h2wEUf0XWw/gmYLGuIq8ZRrjQTLojYHMXo=</HostId></Error>'
2024-07-12 16:13:49,671 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977f46e150>
2024-07-12 16:13:49,672 DEBUG No retry needed.
2024-07-12 16:13:49,672 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f47a390>>
2024-07-12 16:13:49,672 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:13:49,673 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:49,674 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f47a390>>
2024-07-12 16:13:49,674 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-002.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:49,675 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:13:49,676 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-002.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-002.dcm
2024-07-12 16:13:49,676 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:49,677 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:49,677 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:13:49,678 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f977f4abed0>
2024-07-12 16:13:49,679 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:49,680 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f460ed0>>
2024-07-12 16:13:49,680 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977ee45ad0>>
2024-07-12 16:13:49,681 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:49,681 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:49,682 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f46df90>>
2024-07-12 16:13:49,683 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:49,683 DEBUG CanonicalRequest:
PUT
/1-002.dcm

content-md5:pD40LLf3LTnVW4YNdi0ejA==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161349Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:49,684 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161349Z
20240712/eu-north-1/s3/aws4_request
fa57cee893aacc0aab1ccdc04b1905a98162b9c59847157954d8e2eddc17267e
2024-07-12 16:13:49,684 DEBUG Signature:
89213f5c35ba4706efde521a937c1e427de8b8011e87f0ddacd9ee67fedccddc
2024-07-12 16:13:49,685 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:49,686 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:49,686 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-002.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'pD40LLf3LTnVW4YNdi0ejA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161349Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=89213f5c35ba4706efde521a937c1e427de8b8011e87f0ddacd9ee67fedccddc', 'amz-sdk-invocation-id': b'6f3c07a1-ab7f-4e15-a28e-05e1eebe7b10', 'amz-sdk-request': b'ttl=20240712T161450Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:13:49,687 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:49,688 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:13:49,895 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:50,026 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:13:50,626 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-002.dcm HTTP/11" 200 0
2024-07-12 16:13:50,628 DEBUG Response headers: {'x-amz-id-2': 'jbwq7JnM6WrpFXi41/pFNsSqUMs60HuIJHVWm7C9DLFVuM/jjZPsUegYd/b+aGsMHmBRlmsD51cI5o3KGDBdY4fSAUMG3JPS', 'x-amz-request-id': 'NDFNA7WJPC5K00R3', 'Date': 'Fri, 12 Jul 2024 16:13:52 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"a43e342cb7f72d39d55b860d762d1e8c"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:13:50,629 DEBUG Response body:
b''
2024-07-12 16:13:50,630 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977f46e150>
2024-07-12 16:13:50,631 DEBUG No retry needed.
2024-07-12 16:13:50,632 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f47a390>>
2024-07-12 16:13:50,632 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:13:50,635 DEBUG Releasing acquire 0/None
2024-07-12 16:13:50,637 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0e\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:13:50,638 INFO Created new item on mongodb 
2024-07-12 16:13:50,639 INFO {'_id': ObjectId('6691563ca7ee35ee91810d8f'), 'FileName': '1-003.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '6691563ca7ee35ee91810d8f'}
2024-07-12 16:13:50,666 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:13:50,671 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:13:50,674 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:13:50,677 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:13:50,678 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:13:50,679 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:13:50,682 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:13:50,696 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:13:50,700 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:13:50,702 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:13:50,706 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:13:50,746 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:13:50,758 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:13:50,789 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:13:50,789 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:13:50,814 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:13:50,845 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:13:50,853 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:13:50,856 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:13:50,858 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f9790dd6e80>
2024-07-12 16:13:50,860 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:13:50,861 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:13:50,862 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:13:50,863 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:13:50,864 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:13:50,866 DEBUG No configured endpoint found.
2024-07-12 16:13:50,869 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:13:50,876 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:13:50,877 DEBUG Registering retry handlers for service: s3
2024-07-12 16:13:50,878 DEBUG Registering S3 region redirector handler
2024-07-12 16:13:50,879 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:13:50,880 DEBUG Loading s3:s3
2024-07-12 16:13:50,882 DEBUG Loading s3:Bucket
2024-07-12 16:13:50,882 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:50,886 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f9790dd7600>
2024-07-12 16:13:50,887 DEBUG Loading s3:Bucket
2024-07-12 16:13:50,888 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:50,890 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f9790dd7600>
2024-07-12 16:13:50,890 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:13:50,891 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:13:50,892 DEBUG Acquiring 0
2024-07-12 16:13:50,892 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9e4f610>}) about to wait for the following futures []
2024-07-12 16:13:50,893 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9e4f610>}) done waiting for dependent futures
2024-07-12 16:13:50,893 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9e4f610>}) with kwargs {'client': <botocore.client.S3 object at 0x7f97a9dfea10>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f97b0b67c50>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97b0b67990>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97a9e4f0d0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9e4f610>}
2024-07-12 16:13:50,896 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97a9e4f0d0> for transfer request: 0.
2024-07-12 16:13:50,896 DEBUG Acquiring 0
2024-07-12 16:13:50,897 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:13:50,897 DEBUG Releasing acquire 0/None
2024-07-12 16:13:50,898 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:13:50,898 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f97a9dfea10>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f97a9e4c390>, 'bucket': 'dicommetadata', 'key': '1-003.dcm', 'extra_args': {}}
2024-07-12 16:13:50,900 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:13:50,900 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:13:50,901 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:13:50,901 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:13:50,902 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:13:50,902 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f634f50>>
2024-07-12 16:13:50,903 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f9790deecd0>>
2024-07-12 16:13:50,903 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:13:50,904 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:50,904 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f634f50>>
2024-07-12 16:13:50,905 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-003.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:50,906 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:13:50,907 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:50,907 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:50,908 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:13:50,917 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:13:50,917 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:13:50,917 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977fb5ae10>>
2024-07-12 16:13:50,918 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:13:50,918 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:13:50,919 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-003.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'ZWFXr0tVO+rM+w/g1LTipA==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f97a9e4c390>, 'auth_path': '/dicommetadata/1-003.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-003.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f97a9e29210>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-003.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f97a9e4c390>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-003.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:13:50,920 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:50,920 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a9e28f50>>
2024-07-12 16:13:50,921 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9790deecd0>>
2024-07-12 16:13:50,922 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:50,922 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:50,923 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977fb5ae10>>
2024-07-12 16:13:50,923 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:50,924 DEBUG CanonicalRequest:
PUT
/1-003.dcm

content-md5:ZWFXr0tVO+rM+w/g1LTipA==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161350Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:50,924 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161350Z
20240712/us-east-1/s3/aws4_request
e25a54b0d1a921f81e18e5563b49da24e2df7ca36464899d18af255885c8d05f
2024-07-12 16:13:50,925 DEBUG Signature:
d794eae5939bff878c9c714b5bae290ce2a03dc6516c909755460b2119fe56d7
2024-07-12 16:13:50,926 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:50,926 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:50,927 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-003.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'ZWFXr0tVO+rM+w/g1LTipA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161350Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=d794eae5939bff878c9c714b5bae290ce2a03dc6516c909755460b2119fe56d7', 'amz-sdk-invocation-id': b'798707a4-4900-4f68-995a-f04e7f2d3d55', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:13:50,928 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:50,929 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:13:51,111 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:51,232 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:13:51,232 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:13:51,246 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-003.dcm HTTP/11" 400 None
2024-07-12 16:13:51,247 DEBUG Response headers: {'x-amz-request-id': 'EKJ6CZ20A2QAGEWC', 'x-amz-id-2': 'zwR0Ku6c0fiUwpRh/gxfBN/29I5csxqmATUTGq2mW8MZZNRKX0+j9/gqRoJ3+zgPL/ZvyWOclYg=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:13:52 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:13:51,248 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>EKJ6CZ20A2QAGEWC</RequestId><HostId>zwR0Ku6c0fiUwpRh/gxfBN/29I5csxqmATUTGq2mW8MZZNRKX0+j9/gqRoJ3+zgPL/ZvyWOclYg=</HostId></Error>'
2024-07-12 16:13:51,253 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a9b741d0>
2024-07-12 16:13:51,253 DEBUG No retry needed.
2024-07-12 16:13:51,254 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f634f50>>
2024-07-12 16:13:51,255 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:13:51,256 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:51,256 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f634f50>>
2024-07-12 16:13:51,257 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-003.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:51,258 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:13:51,259 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-003.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-003.dcm
2024-07-12 16:13:51,260 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:51,265 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:51,268 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:13:51,272 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f97a9e4c390>
2024-07-12 16:13:51,273 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:51,274 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a9e28f50>>
2024-07-12 16:13:51,275 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9790deecd0>>
2024-07-12 16:13:51,276 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:51,277 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:51,277 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977fb5ae10>>
2024-07-12 16:13:51,279 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:51,279 DEBUG CanonicalRequest:
PUT
/1-003.dcm

content-md5:ZWFXr0tVO+rM+w/g1LTipA==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161351Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:51,280 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161351Z
20240712/eu-north-1/s3/aws4_request
311d6048850e3e8a65ea099f842211b0047ef6ba2073b6c9124e91dbbeabd497
2024-07-12 16:13:51,281 DEBUG Signature:
550f5233c77fe9d8207e47bedb3137eaa4a54fd142c0d854b0a4f327b4bd2d35
2024-07-12 16:13:51,282 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:51,282 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:51,283 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-003.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'ZWFXr0tVO+rM+w/g1LTipA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161351Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=550f5233c77fe9d8207e47bedb3137eaa4a54fd142c0d854b0a4f327b4bd2d35', 'amz-sdk-invocation-id': b'798707a4-4900-4f68-995a-f04e7f2d3d55', 'amz-sdk-request': b'ttl=20240712T161452Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:13:51,284 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:51,286 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:13:51,469 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:51,615 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:13:52,172 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-003.dcm HTTP/11" 200 0
2024-07-12 16:13:52,173 DEBUG Response headers: {'x-amz-id-2': 'FAumzrrtEGqhqlkJoaVcqbhfWE0XVTLm8b06AjilpMIGUQgdbGfmheR8c0LSHKgxnJ/tW6SXjomzoF4p8ZiYH0SL4seCRAiq', 'x-amz-request-id': 'QNDQTVH6QX9PBW4C', 'Date': 'Fri, 12 Jul 2024 16:13:54 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"656157af4b553beaccfb0fe0d4b4e2a4"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:13:52,174 DEBUG Response body:
b''
2024-07-12 16:13:52,175 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97a9b741d0>
2024-07-12 16:13:52,175 DEBUG No retry needed.
2024-07-12 16:13:52,176 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f634f50>>
2024-07-12 16:13:52,176 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:13:52,178 DEBUG Releasing acquire 0/None
2024-07-12 16:13:52,181 DEBUG Received frame <Basic.Deliver object at 0x7f9792e72510> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,183 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f977f457d90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,184 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f977f457950> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,185 DEBUG Received frame <Basic.Deliver object at 0x7f9790d82f90> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,186 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f977f457b90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,187 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f977f457990> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,188 DEBUG Received frame <Basic.Deliver object at 0x7f9790d82270> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,189 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f977f457710> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,190 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f977f457890> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,190 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x0f\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:13:52,195 DEBUG Received frame <Basic.Deliver object at 0x7f979275b110> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,195 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a9e3ae90> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,196 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97a9e3be50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,197 DEBUG Received frame <Basic.Deliver object at 0x7f977fa0be90> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,198 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a9e3bc50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,199 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97a9e3ba50> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:52,213 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:52,213 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,214 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,215 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0007473589994333452}
2024-07-12 16:13:52,216 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NUyFZOZWRPOnwvphWKefEQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-004.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"66915640a7ee35ee91810d90\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 2038664370, "operationId": 2038664370, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,220 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.323, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 2038664370, "operationId": 2038664370, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,222 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:13:52,232 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:52,233 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,234 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,235 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0007096839999576332}
2024-07-12 16:13:52,236 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NUyFZOZWRPOnwvphWKefEQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-005.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"66915640a7ee35ee91810d91\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1129566413, "operationId": 1129566413, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,239 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 2.584, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1129566413, "operationId": 1129566413, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,240 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:13:52,250 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:13:52,251 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:52,253 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,253 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:52,254 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,255 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,255 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:52,255 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.001021167000544665}
2024-07-12 16:13:52,258 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,259 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,260 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NUyFZOZWRPOnwvphWKefEQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-006.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"66915640a7ee35ee91810d92\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 184803526, "operationId": 184803526, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,262 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.003604334000556264}
2024-07-12 16:13:52,262 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,265 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 5.53, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 184803526, "operationId": 184803526, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,267 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"66915640a7ee35ee91810d90\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 412776091, "operationId": 412776091, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,270 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.007313443000384723}
2024-07-12 16:13:52,272 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:13:52,274 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"66915640a7ee35ee91810d91\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1424268980, "operationId": 1424268980, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,274 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 6.888, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"66915640a7ee35ee91810d90\"}, \"FileName\": \"1-004.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 412776091, "operationId": 412776091, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,278 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 16:13:52,279 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 5.095, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"66915640a7ee35ee91810d91\"}, \"FileName\": \"1-005.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1424268980, "operationId": 1424268980, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,280 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:13:52,285 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:52,286 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,287 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,287 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008168409995050752}
2024-07-12 16:13:52,290 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-007.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"66915640a7ee35ee91810d93\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1911759956, "operationId": 1911759956, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,294 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.87, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1911759956, "operationId": 1911759956, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,296 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:13:52,304 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:52,305 INFO Created new item on mongodb 
2024-07-12 16:13:52,305 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,305 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:52,306 INFO {'_id': ObjectId('66915640a7ee35ee91810d90'), 'FileName': '1-004.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '66915640a7ee35ee91810d90'}
2024-07-12 16:13:52,307 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,308 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,311 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.003667124999992666}
2024-07-12 16:13:52,312 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,313 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-008.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"66915640a7ee35ee91810d94\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 749241873, "operationId": 749241873, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,315 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.002626434000376321}
2024-07-12 16:13:52,316 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.099, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 749241873, "operationId": 749241873, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,317 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"66915640a7ee35ee91810d92\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 137806862, "operationId": 137806862, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,319 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:13:52,327 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 9.804, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"66915640a7ee35ee91810d92\"}, \"FileName\": \"1-006.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 137806862, "operationId": 137806862, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:52,328 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 16:13:52,340 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:13:52,344 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:13:52,345 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:13:52,348 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:13:52,349 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:13:52,351 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:13:52,353 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:13:52,360 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:13:52,361 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:13:52,362 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:13:52,363 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:13:52,379 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:13:52,382 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:13:52,407 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:13:52,408 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:13:52,430 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:13:52,464 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:13:52,471 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:13:52,475 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:13:52,475 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ba5e40>
2024-07-12 16:13:52,476 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:13:52,477 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:13:52,478 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:13:52,478 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:13:52,479 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:13:52,480 DEBUG No configured endpoint found.
2024-07-12 16:13:52,482 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:13:52,486 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:13:52,487 DEBUG Registering retry handlers for service: s3
2024-07-12 16:13:52,488 DEBUG Registering S3 region redirector handler
2024-07-12 16:13:52,489 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:13:52,493 DEBUG Loading s3:s3
2024-07-12 16:13:52,496 DEBUG Loading s3:Bucket
2024-07-12 16:13:52,497 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:52,503 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97926c1a80>
2024-07-12 16:13:52,504 DEBUG Loading s3:Bucket
2024-07-12 16:13:52,505 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:52,506 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97926c1a80>
2024-07-12 16:13:52,507 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:13:52,508 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:13:52,509 DEBUG Acquiring 0
2024-07-12 16:13:52,510 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f5c3650>}) about to wait for the following futures []
2024-07-12 16:13:52,510 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f5c3650>}) done waiting for dependent futures
2024-07-12 16:13:52,511 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f5c3650>}) with kwargs {'client': <botocore.client.S3 object at 0x7f977f547350>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f977f503790>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f977f5c2a10>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f977f5c2c50>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f5c3650>}
2024-07-12 16:13:52,515 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f977f5c2c50> for transfer request: 0.
2024-07-12 16:13:52,515 DEBUG Acquiring 0
2024-07-12 16:13:52,516 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:13:52,516 DEBUG Releasing acquire 0/None
2024-07-12 16:13:52,516 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:13:52,517 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f977f547350>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f977f5c3e10>, 'bucket': 'dicommetadata', 'key': '1-004.dcm', 'extra_args': {}}
2024-07-12 16:13:52,519 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:13:52,519 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:13:52,520 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:13:52,520 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:13:52,520 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:13:52,521 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f555d10>>
2024-07-12 16:13:52,521 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f979276ec90>>
2024-07-12 16:13:52,522 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:13:52,523 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:52,523 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f555d10>>
2024-07-12 16:13:52,524 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-004.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:52,525 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:13:52,526 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:52,528 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:52,531 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:13:52,540 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:13:52,541 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:13:52,541 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f5c9e50>>
2024-07-12 16:13:52,541 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:13:52,542 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:13:52,542 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-004.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'VCTh+mCH3lLA+6NT1kndeg==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f977f5c3e10>, 'auth_path': '/dicommetadata/1-004.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-004.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f977f510d50>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-004.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f977f5c3e10>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-004.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:13:52,544 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:52,544 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f510a10>>
2024-07-12 16:13:52,545 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f979276ec90>>
2024-07-12 16:13:52,546 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:52,546 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:52,547 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f5c9e50>>
2024-07-12 16:13:52,547 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:52,548 DEBUG CanonicalRequest:
PUT
/1-004.dcm

content-md5:VCTh+mCH3lLA+6NT1kndeg==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161352Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:52,549 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161352Z
20240712/us-east-1/s3/aws4_request
ff85e8006451f1e5b5ae8c1e13ccacbd79a6f4809a45537c2cfc0c2d578910f0
2024-07-12 16:13:52,550 DEBUG Signature:
e99d989e738cbf4b9778eed6e40736428010525ccebd67f6aa5172dd5eb315b0
2024-07-12 16:13:52,550 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:52,551 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:52,552 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-004.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'VCTh+mCH3lLA+6NT1kndeg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161352Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=e99d989e738cbf4b9778eed6e40736428010525ccebd67f6aa5172dd5eb315b0', 'amz-sdk-invocation-id': b'9a365726-616f-4fa8-bc40-66c5c04f8e9e', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:13:52,553 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:52,553 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:13:52,858 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:52,975 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:13:52,976 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:13:52,985 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-004.dcm HTTP/11" 400 None
2024-07-12 16:13:52,986 DEBUG Response headers: {'x-amz-request-id': 'P4VGT0PXF9H741TJ', 'x-amz-id-2': 'GnKXgvYF8J5elnrGYu8Wsf2hpWgL7WN8/uTTsSBjKhxXcNwHcwN/Q2pojBAMK8tvKYAVO9xYs1IBtNtg8nWF5A==', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:13:53 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:13:52,987 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>P4VGT0PXF9H741TJ</RequestId><HostId>GnKXgvYF8J5elnrGYu8Wsf2hpWgL7WN8/uTTsSBjKhxXcNwHcwN/Q2pojBAMK8tvKYAVO9xYs1IBtNtg8nWF5A==</HostId></Error>'
2024-07-12 16:13:52,991 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977f5c9bd0>
2024-07-12 16:13:52,992 DEBUG No retry needed.
2024-07-12 16:13:52,992 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f555d10>>
2024-07-12 16:13:52,995 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:13:52,996 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:52,996 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f555d10>>
2024-07-12 16:13:52,998 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-004.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:52,999 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:13:53,000 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-004.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-004.dcm
2024-07-12 16:13:53,001 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:53,001 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:53,002 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:13:53,004 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f977f5c3e10>
2024-07-12 16:13:53,005 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:53,006 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f510a10>>
2024-07-12 16:13:53,007 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f979276ec90>>
2024-07-12 16:13:53,008 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:53,009 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:53,009 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f5c9e50>>
2024-07-12 16:13:53,010 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:53,011 DEBUG CanonicalRequest:
PUT
/1-004.dcm

content-md5:VCTh+mCH3lLA+6NT1kndeg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161353Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:53,011 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161353Z
20240712/eu-north-1/s3/aws4_request
3e2a2766ab63c50e58f32beecffa781a651aefec8ff3a752ed976fa4ce509ecb
2024-07-12 16:13:53,012 DEBUG Signature:
f894f512d3d064dd01e0588e4ac7220afd0943681ba41035f81b50a3858e3a4d
2024-07-12 16:13:53,015 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:53,016 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:53,017 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-004.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'VCTh+mCH3lLA+6NT1kndeg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161353Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=f894f512d3d064dd01e0588e4ac7220afd0943681ba41035f81b50a3858e3a4d', 'amz-sdk-invocation-id': b'9a365726-616f-4fa8-bc40-66c5c04f8e9e', 'amz-sdk-request': b'ttl=20240712T161453Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:13:53,019 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:53,020 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:13:53,324 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:53,446 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:13:54,040 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-004.dcm HTTP/11" 200 0
2024-07-12 16:13:54,041 DEBUG Response headers: {'x-amz-id-2': 'Uv3KHPbY+tmEf6Z0S/iib2bW+gccyXxq6tTa+tmSaBWjn9RAEuEaWHCzDsBdf9aot+Z/DlP85CQ=', 'x-amz-request-id': 'FY9766MP5YBBASHA', 'Date': 'Fri, 12 Jul 2024 16:13:56 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"5424e1fa6087de52c0fba353d649dd7a"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:13:54,042 DEBUG Response body:
b''
2024-07-12 16:13:54,042 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977f5c9bd0>
2024-07-12 16:13:54,043 DEBUG No retry needed.
2024-07-12 16:13:54,044 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f555d10>>
2024-07-12 16:13:54,044 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:13:54,046 DEBUG Releasing acquire 0/None
2024-07-12 16:13:54,047 INFO Created new item on mongodb 
2024-07-12 16:13:54,047 INFO {'_id': ObjectId('66915640a7ee35ee91810d91'), 'FileName': '1-005.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '66915640a7ee35ee91810d91'}
2024-07-12 16:13:54,070 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:13:54,073 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:13:54,075 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:13:54,078 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:13:54,080 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:13:54,084 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:13:54,086 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:13:54,092 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:13:54,093 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:13:54,094 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:13:54,095 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:13:54,112 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:13:54,114 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:13:54,139 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:13:54,139 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:13:54,158 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:13:54,198 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:13:54,400 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:13:54,402 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:13:54,402 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97b0b07240>
2024-07-12 16:13:54,402 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:13:54,403 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:13:54,404 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:13:54,404 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:13:54,405 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:13:54,405 DEBUG No configured endpoint found.
2024-07-12 16:13:54,408 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:13:54,411 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:13:54,413 DEBUG Registering retry handlers for service: s3
2024-07-12 16:13:54,414 DEBUG Registering S3 region redirector handler
2024-07-12 16:13:54,415 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:13:54,416 DEBUG Loading s3:s3
2024-07-12 16:13:54,418 DEBUG Loading s3:Bucket
2024-07-12 16:13:54,419 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:54,421 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9745d00>
2024-07-12 16:13:54,422 DEBUG Loading s3:Bucket
2024-07-12 16:13:54,422 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:54,424 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9745d00>
2024-07-12 16:13:54,424 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:13:54,425 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:13:54,426 DEBUG Acquiring 0
2024-07-12 16:13:54,427 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97922bf950>}) about to wait for the following futures []
2024-07-12 16:13:54,427 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97922bf950>}) done waiting for dependent futures
2024-07-12 16:13:54,427 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97922bf950>}) with kwargs {'client': <botocore.client.S3 object at 0x7f979268d310>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f977f457b10>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97922bf290>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97922bf150>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97922bf950>}
2024-07-12 16:13:54,430 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97922bf150> for transfer request: 0.
2024-07-12 16:13:54,430 DEBUG Acquiring 0
2024-07-12 16:13:54,430 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:13:54,431 DEBUG Releasing acquire 0/None
2024-07-12 16:13:54,431 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:13:54,432 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f979268d310>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f97922be350>, 'bucket': 'dicommetadata', 'key': '1-005.dcm', 'extra_args': {}}
2024-07-12 16:13:54,434 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:13:54,434 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:13:54,435 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:13:54,435 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:13:54,436 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:13:54,436 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9790d04150>>
2024-07-12 16:13:54,437 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f977fa6f4d0>>
2024-07-12 16:13:54,437 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:13:54,438 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:54,440 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9790d04150>>
2024-07-12 16:13:54,441 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-005.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:54,443 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:13:54,444 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:54,445 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:54,446 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:13:54,453 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:13:54,453 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:13:54,454 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97922ec390>>
2024-07-12 16:13:54,454 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:13:54,454 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:13:54,455 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-005.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': '5jpjx9qvtiA46nO6cJvFiQ==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f97922be350>, 'auth_path': '/dicommetadata/1-005.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-005.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f979227aa90>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-005.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f97922be350>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-005.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:13:54,456 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:54,457 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9792279950>>
2024-07-12 16:13:54,457 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977fa6f4d0>>
2024-07-12 16:13:54,458 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:54,459 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:54,459 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97922ec390>>
2024-07-12 16:13:54,460 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:54,460 DEBUG CanonicalRequest:
PUT
/1-005.dcm

content-md5:5jpjx9qvtiA46nO6cJvFiQ==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161354Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:54,461 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161354Z
20240712/us-east-1/s3/aws4_request
ca51b3b2ad885c4c921310423811d002410f3728a9f74645c598a7c24b0faaa5
2024-07-12 16:13:54,462 DEBUG Signature:
75dfdf260ee873cb1acc6a83e3838b9852bd3f9aa258ca34fb0184dd44f0c5a3
2024-07-12 16:13:54,462 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:54,463 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:54,464 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-005.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'5jpjx9qvtiA46nO6cJvFiQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161354Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=75dfdf260ee873cb1acc6a83e3838b9852bd3f9aa258ca34fb0184dd44f0c5a3', 'amz-sdk-invocation-id': b'ed574faf-ea18-41f2-9688-926dcc1fd56d', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:13:54,465 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:54,466 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:13:54,667 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:54,780 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:13:54,781 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:13:54,791 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-005.dcm HTTP/11" 400 None
2024-07-12 16:13:54,791 DEBUG Response headers: {'x-amz-request-id': 'FQC229VXRR8FHHWE', 'x-amz-id-2': '4l8TA6TeO7oYjhoZSY0GZ93/52C6i/c94b+t1Qz3ucPOvZgRLPsJ8F6OGs2r+dGmDuY0wHAA1+mbp3JA8i4Tnw==', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:13:56 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:13:54,792 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>FQC229VXRR8FHHWE</RequestId><HostId>4l8TA6TeO7oYjhoZSY0GZ93/52C6i/c94b+t1Qz3ucPOvZgRLPsJ8F6OGs2r+dGmDuY0wHAA1+mbp3JA8i4Tnw==</HostId></Error>'
2024-07-12 16:13:54,796 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97922ed550>
2024-07-12 16:13:54,796 DEBUG No retry needed.
2024-07-12 16:13:54,797 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9790d04150>>
2024-07-12 16:13:54,797 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:13:54,798 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:54,798 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9790d04150>>
2024-07-12 16:13:54,799 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-005.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:54,801 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:13:54,802 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-005.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-005.dcm
2024-07-12 16:13:54,802 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:54,803 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:54,803 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:13:54,804 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f97922be350>
2024-07-12 16:13:54,805 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:54,806 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9792279950>>
2024-07-12 16:13:54,806 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977fa6f4d0>>
2024-07-12 16:13:54,807 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:54,808 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:54,809 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97922ec390>>
2024-07-12 16:13:54,810 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:54,810 DEBUG CanonicalRequest:
PUT
/1-005.dcm

content-md5:5jpjx9qvtiA46nO6cJvFiQ==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161354Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:54,811 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161354Z
20240712/eu-north-1/s3/aws4_request
d5a5f7be325e899e3556fac0a9e9a32ab8c4ef9aa0c39456ac0414d0a83640c1
2024-07-12 16:13:54,811 DEBUG Signature:
fb53e9b0c3cabbb3c578819c2ed345fac2fe59649e04c60bb77cc217199d75c3
2024-07-12 16:13:54,812 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:54,813 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:54,813 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-005.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'5jpjx9qvtiA46nO6cJvFiQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161354Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=fb53e9b0c3cabbb3c578819c2ed345fac2fe59649e04c60bb77cc217199d75c3', 'amz-sdk-invocation-id': b'ed574faf-ea18-41f2-9688-926dcc1fd56d', 'amz-sdk-request': b'ttl=20240712T161456Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:13:54,815 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:54,816 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:13:55,003 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:55,194 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:13:55,843 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-005.dcm HTTP/11" 200 0
2024-07-12 16:13:55,844 DEBUG Response headers: {'x-amz-id-2': 'hLleslXm77opy38hqId0koB4k1aJmfO/cALG/YreK6x+vOEMTRuk4fL+xZ+fzksi7bczQqouqSU=', 'x-amz-request-id': 'FQC4AM7W6SWM1E9W', 'Date': 'Fri, 12 Jul 2024 16:13:57 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"e63a63c7daafb62038ea73ba709bc589"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:13:55,844 DEBUG Response body:
b''
2024-07-12 16:13:55,845 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97922ed550>
2024-07-12 16:13:55,845 DEBUG No retry needed.
2024-07-12 16:13:55,846 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9790d04150>>
2024-07-12 16:13:55,846 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:13:55,848 DEBUG Releasing acquire 0/None
2024-07-12 16:13:55,849 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x10\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:13:55,849 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:55,850 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x11\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:13:55,851 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:55,853 INFO Created new item on mongodb 
2024-07-12 16:13:55,853 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:13:55,853 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:55,855 INFO {'_id': ObjectId('66915640a7ee35ee91810d92'), 'FileName': '1-006.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '66915640a7ee35ee91810d92'}
2024-07-12 16:13:55,856 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:55,856 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.0029451589998643612}
2024-07-12 16:13:55,859 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:55,859 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"66915640a7ee35ee91810d93\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 982906996, "operationId": 982906996, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:55,861 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0017258090001632809}
2024-07-12 16:13:55,862 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"66915640a7ee35ee91810d94\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 135497281, "operationId": 135497281, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:55,863 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.505, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"66915640a7ee35ee91810d93\"}, \"FileName\": \"1-007.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 982906996, "operationId": 982906996, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:55,866 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 16:13:55,867 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 4.803, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"66915640a7ee35ee91810d94\"}, \"FileName\": \"1-008.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 135497281, "operationId": 135497281, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:13:55,873 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:13:55,887 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:13:55,890 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:13:55,893 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:13:55,897 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:13:55,898 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:13:55,901 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:13:55,902 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:13:55,907 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:13:55,908 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:13:55,908 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:13:55,909 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:13:55,927 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:13:55,930 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:13:55,958 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:13:55,959 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:13:55,981 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:13:56,008 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:13:56,013 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:13:56,018 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:13:56,018 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f977fbb1c60>
2024-07-12 16:13:56,019 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:13:56,020 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:13:56,020 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:13:56,022 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:13:56,023 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:13:56,024 DEBUG No configured endpoint found.
2024-07-12 16:13:56,027 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:13:56,030 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:13:56,031 DEBUG Registering retry handlers for service: s3
2024-07-12 16:13:56,032 DEBUG Registering S3 region redirector handler
2024-07-12 16:13:56,033 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:13:56,034 DEBUG Loading s3:s3
2024-07-12 16:13:56,035 DEBUG Loading s3:Bucket
2024-07-12 16:13:56,036 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:56,038 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f977fbb2660>
2024-07-12 16:13:56,039 DEBUG Loading s3:Bucket
2024-07-12 16:13:56,040 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:56,042 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f977fbb2660>
2024-07-12 16:13:56,043 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:13:56,043 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:13:56,045 DEBUG Acquiring 0
2024-07-12 16:13:56,046 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f3f8990>}) about to wait for the following futures []
2024-07-12 16:13:56,047 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f3f8990>}) done waiting for dependent futures
2024-07-12 16:13:56,048 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f3f8990>}) with kwargs {'client': <botocore.client.S3 object at 0x7f977fbd6dd0>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f977fc88990>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f977f3e48d0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f977f3f9210>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f3f8990>}
2024-07-12 16:13:56,052 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f977f3f9210> for transfer request: 0.
2024-07-12 16:13:56,053 DEBUG Acquiring 0
2024-07-12 16:13:56,054 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:13:56,055 DEBUG Releasing acquire 0/None
2024-07-12 16:13:56,055 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:13:56,057 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f977fbd6dd0>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f977f3f8290>, 'bucket': 'dicommetadata', 'key': '1-006.dcm', 'extra_args': {}}
2024-07-12 16:13:56,058 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:13:56,059 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:13:56,059 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:13:56,060 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:13:56,060 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:13:56,061 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9763610>>
2024-07-12 16:13:56,061 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f97a9d2c7d0>>
2024-07-12 16:13:56,062 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:13:56,062 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:56,063 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9763610>>
2024-07-12 16:13:56,064 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-006.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:56,065 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:13:56,066 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:56,067 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:56,069 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:13:56,075 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:13:56,076 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:13:56,076 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f382e10>>
2024-07-12 16:13:56,077 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:13:56,078 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:13:56,078 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-006.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'VZfquW7hTjH7xREU/CDLgQ==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f977f3f8290>, 'auth_path': '/dicommetadata/1-006.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-006.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f977f33f550>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-006.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f977f3f8290>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-006.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:13:56,080 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:56,081 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f33f510>>
2024-07-12 16:13:56,082 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a9d2c7d0>>
2024-07-12 16:13:56,084 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:56,085 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:56,085 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f382e10>>
2024-07-12 16:13:56,086 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:56,087 DEBUG CanonicalRequest:
PUT
/1-006.dcm

content-md5:VZfquW7hTjH7xREU/CDLgQ==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161356Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:56,087 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161356Z
20240712/us-east-1/s3/aws4_request
91c710c7d90b5768584f7d406f3e4c7b84114d995e12660d7e1f2adc6ae48887
2024-07-12 16:13:56,088 DEBUG Signature:
61a151a66344f01eb881cd4dc5706e7a6f5d727e7972061b446f9a309195731d
2024-07-12 16:13:56,089 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:56,089 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:56,090 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-006.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'VZfquW7hTjH7xREU/CDLgQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161356Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=61a151a66344f01eb881cd4dc5706e7a6f5d727e7972061b446f9a309195731d', 'amz-sdk-invocation-id': b'937bf3c5-8fea-4ab4-be8e-835350bca4b8', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:13:56,091 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:56,092 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:13:56,291 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:56,399 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:13:56,400 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:13:56,409 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-006.dcm HTTP/11" 400 None
2024-07-12 16:13:56,409 DEBUG Response headers: {'x-amz-request-id': 'QQMAVBY85NK26D1Z', 'x-amz-id-2': 'o4BXZ8+d4Tvbh5DcYYdyvWSL0z58WrT+O5Dz2UT977FgzvUMfPT7jFXRTY92gta5yUtlFJqI58Sb9IC4qtopBA==', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:13:58 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:13:56,410 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>QQMAVBY85NK26D1Z</RequestId><HostId>o4BXZ8+d4Tvbh5DcYYdyvWSL0z58WrT+O5Dz2UT977FgzvUMfPT7jFXRTY92gta5yUtlFJqI58Sb9IC4qtopBA==</HostId></Error>'
2024-07-12 16:13:56,414 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977f382fd0>
2024-07-12 16:13:56,414 DEBUG No retry needed.
2024-07-12 16:13:56,415 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9763610>>
2024-07-12 16:13:56,415 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:13:56,416 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:56,417 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9763610>>
2024-07-12 16:13:56,418 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-006.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:56,419 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:13:56,420 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-006.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-006.dcm
2024-07-12 16:13:56,420 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:56,421 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:56,421 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:13:56,422 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f977f3f8290>
2024-07-12 16:13:56,423 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:56,424 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f33f510>>
2024-07-12 16:13:56,424 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a9d2c7d0>>
2024-07-12 16:13:56,425 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:56,426 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:56,426 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f382e10>>
2024-07-12 16:13:56,427 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:56,427 DEBUG CanonicalRequest:
PUT
/1-006.dcm

content-md5:VZfquW7hTjH7xREU/CDLgQ==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161356Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:56,428 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161356Z
20240712/eu-north-1/s3/aws4_request
01d790185965be4c9270f32c6f344b21bffd2e0fa64aca3ebf5f14da7b11f39d
2024-07-12 16:13:56,428 DEBUG Signature:
7e68363a4d182fa17ca03879cb843e13c2e9aebc9a662923e507c86fe39c8a7e
2024-07-12 16:13:56,429 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:56,430 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:56,430 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-006.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'VZfquW7hTjH7xREU/CDLgQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161356Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=7e68363a4d182fa17ca03879cb843e13c2e9aebc9a662923e507c86fe39c8a7e', 'amz-sdk-invocation-id': b'937bf3c5-8fea-4ab4-be8e-835350bca4b8', 'amz-sdk-request': b'ttl=20240712T161458Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:13:56,431 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:56,432 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:13:56,622 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:56,750 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:13:57,419 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-006.dcm HTTP/11" 200 0
2024-07-12 16:13:57,420 DEBUG Response headers: {'x-amz-id-2': 'WPsBO636G6RoIhGLrz+Ev2hLcFJL355JatMDIP1bmUY1KgrIgqKYqjWtS6yz6Nk0+qeipjNjMXk=', 'x-amz-request-id': 'QQMA6AP8P63BK9DZ', 'Date': 'Fri, 12 Jul 2024 16:13:59 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"5597eab96ee14e31fbc51114fc20cb81"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:13:57,420 DEBUG Response body:
b''
2024-07-12 16:13:57,421 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977f382fd0>
2024-07-12 16:13:57,422 DEBUG No retry needed.
2024-07-12 16:13:57,423 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9763610>>
2024-07-12 16:13:57,423 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:13:57,425 DEBUG Releasing acquire 0/None
2024-07-12 16:13:57,430 DEBUG Received frame <Basic.Deliver object at 0x7f9790d82db0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,430 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a9714750> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,431 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97a9715190> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,432 DEBUG Received frame <Basic.Deliver object at 0x7f9790d82b10> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,433 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a9715f50> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,433 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97a97176d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,434 DEBUG Received frame <Basic.Deliver object at 0x7f977f5a9910> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,435 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a9715050> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,436 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f97a97156d0> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,437 DEBUG Received frame <Basic.Deliver object at 0x7f977f5a97f0> in channel #1 weight=72 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,438 DEBUG Received frame <pamqp.header.ContentHeader object at 0x7f97a9715390> in channel #1 weight=61 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:13:57,439 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x12\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:13:57,441 INFO Created new item on mongodb 
2024-07-12 16:13:57,441 INFO {'_id': ObjectId('66915640a7ee35ee91810d93'), 'FileName': '1-007.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '66915640a7ee35ee91810d93'}
2024-07-12 16:13:57,462 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:13:57,466 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:13:57,468 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:13:57,472 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:13:57,473 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:13:57,475 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:13:57,478 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:13:57,482 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:13:57,483 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:13:57,483 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:13:57,484 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:13:57,504 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:13:57,506 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:13:57,530 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:13:57,531 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:13:57,555 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:13:57,587 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:13:57,592 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:13:57,594 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:13:57,595 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ba6700>
2024-07-12 16:13:57,596 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:13:57,598 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:13:57,599 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:13:57,599 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:13:57,600 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:13:57,601 DEBUG No configured endpoint found.
2024-07-12 16:13:57,604 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:13:57,607 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:13:57,608 DEBUG Registering retry handlers for service: s3
2024-07-12 16:13:57,608 DEBUG Registering S3 region redirector handler
2024-07-12 16:13:57,610 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:13:57,611 DEBUG Loading s3:s3
2024-07-12 16:13:57,613 DEBUG Loading s3:Bucket
2024-07-12 16:13:57,613 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:57,617 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ba6a20>
2024-07-12 16:13:57,618 DEBUG Loading s3:Bucket
2024-07-12 16:13:57,619 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:57,621 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ba6a20>
2024-07-12 16:13:57,621 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:13:57,622 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:13:57,623 DEBUG Acquiring 0
2024-07-12 16:13:57,623 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f6be750>}) about to wait for the following futures []
2024-07-12 16:13:57,628 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f6be750>}) done waiting for dependent futures
2024-07-12 16:13:57,628 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f6be750>}) with kwargs {'client': <botocore.client.S3 object at 0x7f977f6b8790>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f977f6bd890>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f977f6bdad0>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f977f6bdd10>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977f6be750>}
2024-07-12 16:13:57,630 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f977f6bdd10> for transfer request: 0.
2024-07-12 16:13:57,631 DEBUG Acquiring 0
2024-07-12 16:13:57,631 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:13:57,632 DEBUG Releasing acquire 0/None
2024-07-12 16:13:57,632 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:13:57,633 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f977f6b8790>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f977f6bef50>, 'bucket': 'dicommetadata', 'key': '1-007.dcm', 'extra_args': {}}
2024-07-12 16:13:57,634 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:13:57,635 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:13:57,635 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:13:57,636 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:13:57,636 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:13:57,637 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f64ad90>>
2024-07-12 16:13:57,637 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f9793f2c210>>
2024-07-12 16:13:57,637 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:13:57,638 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:57,639 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f64ad90>>
2024-07-12 16:13:57,639 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-007.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:57,641 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:13:57,641 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:57,642 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:57,643 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:13:57,651 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:13:57,651 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:13:57,652 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f6fced0>>
2024-07-12 16:13:57,652 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:13:57,653 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:13:57,653 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-007.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': '9ppGFFKm79NpK5awQxPI1g==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f977f6bef50>, 'auth_path': '/dicommetadata/1-007.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-007.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f977f6ce0d0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-007.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f977f6bef50>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-007.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:13:57,655 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:57,656 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f6ce090>>
2024-07-12 16:13:57,657 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9793f2c210>>
2024-07-12 16:13:57,657 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:57,658 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:57,659 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f6fced0>>
2024-07-12 16:13:57,659 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:57,660 DEBUG CanonicalRequest:
PUT
/1-007.dcm

content-md5:9ppGFFKm79NpK5awQxPI1g==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161357Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:57,660 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161357Z
20240712/us-east-1/s3/aws4_request
e388e9b1c6028ada5e7827efc6285bc9023a14ce504f540d82c3193b02414faf
2024-07-12 16:13:57,661 DEBUG Signature:
f9d4f3cfa53abbb114de7711196e92989f05f406c3d108061f9ac121c697afd1
2024-07-12 16:13:57,662 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:57,662 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:57,663 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-007.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'9ppGFFKm79NpK5awQxPI1g==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161357Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=f9d4f3cfa53abbb114de7711196e92989f05f406c3d108061f9ac121c697afd1', 'amz-sdk-invocation-id': b'6e17fb1d-f4c7-4d58-b61c-deb7fe8019dc', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:13:57,664 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:57,665 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:13:58,012 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:58,122 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:13:58,124 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:13:58,152 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-007.dcm HTTP/11" 400 None
2024-07-12 16:13:58,153 DEBUG Response headers: {'x-amz-request-id': 'MQZMYHM2G3FTM5KD', 'x-amz-id-2': '+VqTeCCGKznI82v9PtGQAvOlcc5/zCh3pWreXxx17u8eUmGKW5ohj9lDYdqxqC+5C2pknRnQpIM=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:13:59 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:13:58,155 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>MQZMYHM2G3FTM5KD</RequestId><HostId>+VqTeCCGKznI82v9PtGQAvOlcc5/zCh3pWreXxx17u8eUmGKW5ohj9lDYdqxqC+5C2pknRnQpIM=</HostId></Error>'
2024-07-12 16:13:58,166 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977f6fcc50>
2024-07-12 16:13:58,167 DEBUG No retry needed.
2024-07-12 16:13:58,167 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f64ad90>>
2024-07-12 16:13:58,168 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:13:58,169 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:58,170 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f64ad90>>
2024-07-12 16:13:58,170 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-007.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:58,172 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:13:58,172 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-007.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-007.dcm
2024-07-12 16:13:58,173 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:58,174 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:58,174 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:13:58,175 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f977f6bef50>
2024-07-12 16:13:58,176 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:58,177 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f6ce090>>
2024-07-12 16:13:58,177 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f9793f2c210>>
2024-07-12 16:13:58,178 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:58,178 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:58,179 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977f6fced0>>
2024-07-12 16:13:58,180 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:58,180 DEBUG CanonicalRequest:
PUT
/1-007.dcm

content-md5:9ppGFFKm79NpK5awQxPI1g==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161358Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:58,181 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161358Z
20240712/eu-north-1/s3/aws4_request
b7cfd229828fcb3d566cfb8c2a737b43758dce1c50c66ddc868bc7d3b44490bd
2024-07-12 16:13:58,181 DEBUG Signature:
e5e9d22b7c5492a342073ef44d3cd5dd8c381f12b1abeab395516c29a002448d
2024-07-12 16:13:58,182 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:58,182 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:58,183 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-007.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'9ppGFFKm79NpK5awQxPI1g==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161358Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=e5e9d22b7c5492a342073ef44d3cd5dd8c381f12b1abeab395516c29a002448d', 'amz-sdk-invocation-id': b'6e17fb1d-f4c7-4d58-b61c-deb7fe8019dc', 'amz-sdk-request': b'ttl=20240712T161459Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:13:58,184 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:58,185 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:13:58,536 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:58,664 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:13:59,208 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-007.dcm HTTP/11" 200 0
2024-07-12 16:13:59,209 DEBUG Response headers: {'x-amz-id-2': 'xcJe4uQuWiKSetc/xadwY1l+xT7RjfIkQkuE/a8D3ErMNiddRAIzHXaF99KguJXYAieFaBLFscM95ae4YXyTQWyhVbpoQzWX', 'x-amz-request-id': 'MQZPQV9H5AA3SN1A', 'Date': 'Fri, 12 Jul 2024 16:14:01 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"f69a461452a6efd3692b96b04313c8d6"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:13:59,210 DEBUG Response body:
b''
2024-07-12 16:13:59,211 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977f6fcc50>
2024-07-12 16:13:59,212 DEBUG No retry needed.
2024-07-12 16:13:59,212 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977f64ad90>>
2024-07-12 16:13:59,213 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:13:59,215 DEBUG Releasing acquire 0/None
2024-07-12 16:13:59,216 INFO Created new item on mongodb 
2024-07-12 16:13:59,216 INFO {'_id': ObjectId('66915640a7ee35ee91810d94'), 'FileName': '1-008.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '66915640a7ee35ee91810d94'}
2024-07-12 16:13:59,239 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:13:59,242 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:13:59,244 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:13:59,248 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:13:59,249 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:13:59,251 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:13:59,254 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:13:59,259 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:13:59,259 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:13:59,260 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:13:59,261 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:13:59,280 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:13:59,283 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:13:59,309 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:13:59,310 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:13:59,331 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:13:59,358 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:13:59,470 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:13:59,472 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:13:59,473 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f977fbb22a0>
2024-07-12 16:13:59,473 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:13:59,474 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:13:59,475 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:13:59,475 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:13:59,476 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:13:59,476 DEBUG No configured endpoint found.
2024-07-12 16:13:59,478 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:13:59,481 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:13:59,482 DEBUG Registering retry handlers for service: s3
2024-07-12 16:13:59,483 DEBUG Registering S3 region redirector handler
2024-07-12 16:13:59,484 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:13:59,486 DEBUG Loading s3:s3
2024-07-12 16:13:59,487 DEBUG Loading s3:Bucket
2024-07-12 16:13:59,487 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:59,489 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f977f6e6f20>
2024-07-12 16:13:59,490 DEBUG Loading s3:Bucket
2024-07-12 16:13:59,490 DEBUG Renaming Bucket attribute name
2024-07-12 16:13:59,493 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f977f6e6f20>
2024-07-12 16:13:59,494 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:13:59,494 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:13:59,496 DEBUG Acquiring 0
2024-07-12 16:13:59,497 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97901d0ed0>}) about to wait for the following futures []
2024-07-12 16:13:59,497 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97901d0ed0>}) done waiting for dependent futures
2024-07-12 16:13:59,498 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97901d0ed0>}) with kwargs {'client': <botocore.client.S3 object at 0x7f9792927710>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f97901d0d10>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97901d0f50>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97901d10d0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97901d0ed0>}
2024-07-12 16:13:59,501 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97901d10d0> for transfer request: 0.
2024-07-12 16:13:59,501 DEBUG Acquiring 0
2024-07-12 16:13:59,502 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:13:59,502 DEBUG Releasing acquire 0/None
2024-07-12 16:13:59,503 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:13:59,504 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f9792927710>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f977f5c3bd0>, 'bucket': 'dicommetadata', 'key': '1-008.dcm', 'extra_args': {}}
2024-07-12 16:13:59,505 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:13:59,506 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:13:59,506 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:13:59,507 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:13:59,507 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:13:59,508 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9792749c10>>
2024-07-12 16:13:59,508 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f979214bb10>>
2024-07-12 16:13:59,509 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:13:59,510 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:59,510 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9792749c10>>
2024-07-12 16:13:59,511 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-008.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:59,513 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:13:59,513 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:59,513 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:59,514 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:13:59,522 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:13:59,523 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:13:59,524 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9790126d90>>
2024-07-12 16:13:59,524 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:13:59,526 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:13:59,526 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-008.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'pnfUewQHmnCVJ2cUyNy6vQ==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f977f5c3bd0>, 'auth_path': '/dicommetadata/1-008.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-008.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f977f58a9d0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-008.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f977f5c3bd0>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-008.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:13:59,527 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:59,528 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f58acd0>>
2024-07-12 16:13:59,529 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f979214bb10>>
2024-07-12 16:13:59,529 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:59,531 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:59,531 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9790126d90>>
2024-07-12 16:13:59,532 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:59,533 DEBUG CanonicalRequest:
PUT
/1-008.dcm

content-md5:pnfUewQHmnCVJ2cUyNy6vQ==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161359Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:59,534 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161359Z
20240712/us-east-1/s3/aws4_request
f260c2c824cec06a31ace2f430bec0b887209a7533c3dc1da24f5f5740760e77
2024-07-12 16:13:59,535 DEBUG Signature:
e47568cae5601eb495f13edb815e8c5ab79e9aca625fe3e7928c2b9d000a41c5
2024-07-12 16:13:59,535 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:59,536 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:59,536 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-008.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'pnfUewQHmnCVJ2cUyNy6vQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161359Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=e47568cae5601eb495f13edb815e8c5ab79e9aca625fe3e7928c2b9d000a41c5', 'amz-sdk-invocation-id': b'bde1ecdd-dbc0-4ce9-9f1c-7ec7c21bbd37', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:13:59,537 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:59,538 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:13:59,731 DEBUG Waiting for 100 Continue response.
2024-07-12 16:13:59,840 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:13:59,841 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:13:59,849 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-008.dcm HTTP/11" 400 None
2024-07-12 16:13:59,850 DEBUG Response headers: {'x-amz-request-id': 'RZCP4DBR63SAAQ4X', 'x-amz-id-2': 'Of4vMrP5pyByN8wdDUlRAuiHDz+uLwIER8GXp4oDjohPu6VfKl07ZIUmh0ieuK5Ja6Vns3GaqpQ=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:14:01 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:13:59,851 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>RZCP4DBR63SAAQ4X</RequestId><HostId>Of4vMrP5pyByN8wdDUlRAuiHDz+uLwIER8GXp4oDjohPu6VfKl07ZIUmh0ieuK5Ja6Vns3GaqpQ=</HostId></Error>'
2024-07-12 16:13:59,856 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f9790127910>
2024-07-12 16:13:59,857 DEBUG No retry needed.
2024-07-12 16:13:59,858 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9792749c10>>
2024-07-12 16:13:59,859 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:13:59,860 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:13:59,861 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9792749c10>>
2024-07-12 16:13:59,862 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-008.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:13:59,864 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:13:59,865 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-008.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-008.dcm
2024-07-12 16:13:59,866 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:13:59,867 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:13:59,867 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:13:59,868 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f977f5c3bd0>
2024-07-12 16:13:59,869 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:13:59,870 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977f58acd0>>
2024-07-12 16:13:59,870 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f979214bb10>>
2024-07-12 16:13:59,871 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:13:59,871 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:13:59,872 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9790126d90>>
2024-07-12 16:13:59,874 DEBUG Calculating signature using v4 auth.
2024-07-12 16:13:59,876 DEBUG CanonicalRequest:
PUT
/1-008.dcm

content-md5:pnfUewQHmnCVJ2cUyNy6vQ==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161359Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:13:59,878 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161359Z
20240712/eu-north-1/s3/aws4_request
6dd174683850dc6a8641cc2c1304bcaa4e5b0e2b01c314c91859bc6d75a1e6ea
2024-07-12 16:13:59,878 DEBUG Signature:
e8c6dbb0ada6f376646a27ef23ccb2789c1e5d47266c6e6f64c19b43266f9117
2024-07-12 16:13:59,879 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:13:59,881 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:13:59,881 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-008.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'pnfUewQHmnCVJ2cUyNy6vQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161359Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=e8c6dbb0ada6f376646a27ef23ccb2789c1e5d47266c6e6f64c19b43266f9117', 'amz-sdk-invocation-id': b'bde1ecdd-dbc0-4ce9-9f1c-7ec7c21bbd37', 'amz-sdk-request': b'ttl=20240712T161501Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:13:59,883 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:13:59,884 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:14:00,086 DEBUG Waiting for 100 Continue response.
2024-07-12 16:14:00,219 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:14:00,869 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-008.dcm HTTP/11" 200 0
2024-07-12 16:14:00,870 DEBUG Response headers: {'x-amz-id-2': '6mMkP48L69tMULQJ1d0dGgi2hP7BFg/ySe/nGMl6Wtrmu01bYTXC9fs4liNgyf3kLL1Gx2JqVXQf8K/fKZ0DfxggFlXxw4FH', 'x-amz-request-id': 'RZCRXZF5DYHKRAXN', 'Date': 'Fri, 12 Jul 2024 16:14:03 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"a677d47b04079a7095276714c8dcbabd"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:14:00,870 DEBUG Response body:
b''
2024-07-12 16:14:00,871 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f9790127910>
2024-07-12 16:14:00,872 DEBUG No retry needed.
2024-07-12 16:14:00,872 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9792749c10>>
2024-07-12 16:14:00,873 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:14:00,875 DEBUG Releasing acquire 0/None
2024-07-12 16:14:00,877 DEBUG Received frame <pamqp.body.ContentBody object at 0x7f979042c810> in channel #1 weight=60 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:14:00,879 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x13\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:14:00,879 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x14\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:14:00,894 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:14:00,895 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,896 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,898 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.001710316999378847}
2024-07-12 16:14:00,900 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-009.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"66915648a7ee35ee91810d95\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 511702305, "operationId": 511702305, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,902 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 2.633, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 511702305, "operationId": 511702305, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,903 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:14:00,913 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:14:00,914 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,915 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,916 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008764250005697249}
2024-07-12 16:14:00,918 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-010.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"66915648a7ee35ee91810d96\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 2084420925, "operationId": 2084420925, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,920 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 2.092, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 2084420925, "operationId": 2084420925, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,924 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:14:00,934 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:14:00,938 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,939 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,940 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0004617260001396062}
2024-07-12 16:14:00,940 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-011.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"66915648a7ee35ee91810d97\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1937477084, "operationId": 1937477084, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,943 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.032, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1937477084, "operationId": 1937477084, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,945 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:14:00,955 DEBUG {"message": "Server selection started", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:14:00,956 DEBUG {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x7f97b23991c0>", "operation": "insert", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,957 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:14:00,958 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,959 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,959 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:14:00,960 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.002108425000187708}
2024-07-12 16:14:00,960 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,961 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,961 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:14:00,962 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"insert\": \"items\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\", \"documents\": [{\"FileName\": \"1-012.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\", \"_id\": {\"$oid\": \"66915648a7ee35ee91810d98\"}}]}", "commandName": "insert", "databaseName": "db_local", "requestId": 1827336327, "operationId": 1827336327, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,963 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.002054342000519682}
2024-07-12 16:14:00,963 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,964 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,966 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"66915648a7ee35ee91810d95\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"M+H7ZsrnRbSNH74RwDvlPw==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 572660336, "operationId": 572660336, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,966 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 4.674, "reply": "{\"n\": 1, \"ok\": 1.0}", "commandName": "insert", "databaseName": "db_local", "requestId": 1827336327, "operationId": 1827336327, "driverConnectionId": 1, "serverConnectionId": 8, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,967 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "durationMS": 0.0034051419997922494}
2024-07-12 16:14:00,968 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,970 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1}
2024-07-12 16:14:00,971 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 4.369, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"66915648a7ee35ee91810d95\"}, \"FileName\": \"1-009.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 572660336, "operationId": 572660336, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,972 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"66915648a7ee35ee91810d96\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"NUyFZOZWRPOnwvphWKefEQ==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1159126505, "operationId": 1159126505, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,972 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "durationMS": 0.003883459000462608}
2024-07-12 16:14:00,974 DEBUG {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}}
2024-07-12 16:14:00,975 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 16:14:00,976 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"66915648a7ee35ee91810d97\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 805750846, "operationId": 805750846, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,977 DEBUG {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 6691555ea7ee35ee91810d80, topology_type: Single, servers: [<ServerDescription ('mongodb', 27017) server_type: Standalone, rtt: 0.0010220911327414334>]>", "clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,977 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 5.838, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"66915648a7ee35ee91810d96\"}, \"FileName\": \"1-010.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1159126505, "operationId": 1159126505, "driverConnectionId": 5, "serverConnectionId": 12, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,978 INFO Created new item on mongodb 
2024-07-12 16:14:00,980 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 3.927, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"66915648a7ee35ee91810d97\"}, \"FileName\": \"1-011.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 805750846, "operationId": 805750846, "driverConnectionId": 2, "serverConnectionId": 9, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,980 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checkout started", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,981 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5}
2024-07-12 16:14:00,982 INFO {'_id': ObjectId('66915648a7ee35ee91810d95'), 'FileName': '1-009.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '66915648a7ee35ee91810d95'}
2024-07-12 16:14:00,982 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2}
2024-07-12 16:14:00,983 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked out", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "durationMS": 0.002629916999467241}
2024-07-12 16:14:00,986 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command started", "command": "{\"find\": \"items\", \"filter\": {\"_id\": {\"$oid\": \"66915648a7ee35ee91810d98\"}}, \"limit\": 1, \"singleBatch\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ZlLg+JTYTI6wtkfo9C3rDg==\", \"subType\": \"04\"}}}, \"$db\": \"db_local\"}", "commandName": "find", "databaseName": "db_local", "requestId": 1632621729, "operationId": 1632621729, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,988 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Command succeeded", "durationMS": 1.739, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"66915648a7ee35ee91810d98\"}, \"FileName\": \"1-012.dcm\", \"PatientName\": \"TCGA-CS-5396\", \"PatientID\": \"TCGA-CS-5396\", \"StudyDate\": \"20010302\", \"StudyDescription\": \"MRI BRAIN CONTRAST MRA BRAIN\", \"StudySeriesUID\": \"1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049\"}], \"ns\": \"db_local.items\"}, \"ok\": 1.0}", "commandName": "find", "databaseName": "db_local", "requestId": 1632621729, "operationId": 1632621729, "driverConnectionId": 4, "serverConnectionId": 11, "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:14:00,989 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection checked in", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4}
2024-07-12 16:14:01,011 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:14:01,015 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:14:01,018 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:14:01,022 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:14:01,022 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:14:01,024 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:14:01,027 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:14:01,031 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:14:01,031 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:14:01,032 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:14:01,033 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:14:01,050 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:14:01,053 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:14:01,078 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:14:01,078 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:14:01,098 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:14:01,127 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:14:01,133 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:14:01,138 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:14:01,139 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97a9747c40>
2024-07-12 16:14:01,139 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:14:01,140 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:14:01,141 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:14:01,141 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:14:01,142 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:14:01,143 DEBUG No configured endpoint found.
2024-07-12 16:14:01,145 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:14:01,148 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:14:01,149 DEBUG Registering retry handlers for service: s3
2024-07-12 16:14:01,150 DEBUG Registering S3 region redirector handler
2024-07-12 16:14:01,151 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:14:01,153 DEBUG Loading s3:s3
2024-07-12 16:14:01,154 DEBUG Loading s3:Bucket
2024-07-12 16:14:01,155 DEBUG Renaming Bucket attribute name
2024-07-12 16:14:01,156 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f977fbb0180>
2024-07-12 16:14:01,158 DEBUG Loading s3:Bucket
2024-07-12 16:14:01,158 DEBUG Renaming Bucket attribute name
2024-07-12 16:14:01,160 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f977fbb0180>
2024-07-12 16:14:01,160 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:14:01,161 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:14:01,162 DEBUG Acquiring 0
2024-07-12 16:14:01,163 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9ba3e10>}) about to wait for the following futures []
2024-07-12 16:14:01,163 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9ba3e10>}) done waiting for dependent futures
2024-07-12 16:14:01,164 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9ba3e10>}) with kwargs {'client': <botocore.client.S3 object at 0x7f977f5cb050>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f9792b66f10>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f9792b67250>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97a9ba1810>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9ba3e10>}
2024-07-12 16:14:01,167 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97a9ba1810> for transfer request: 0.
2024-07-12 16:14:01,167 DEBUG Acquiring 0
2024-07-12 16:14:01,168 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:14:01,168 DEBUG Releasing acquire 0/None
2024-07-12 16:14:01,169 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:14:01,171 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f977f5cb050>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f97a9ba0f50>, 'bucket': 'dicommetadata', 'key': '1-009.dcm', 'extra_args': {}}
2024-07-12 16:14:01,173 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:14:01,174 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:14:01,175 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:14:01,175 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:14:01,176 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:14:01,177 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9792b5b990>>
2024-07-12 16:14:01,177 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f979264bb50>>
2024-07-12 16:14:01,179 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:14:01,180 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:14:01,180 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9792b5b990>>
2024-07-12 16:14:01,181 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-009.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:14:01,183 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:14:01,184 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:14:01,184 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:14:01,185 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:14:01,191 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:14:01,192 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:14:01,192 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9792986650>>
2024-07-12 16:14:01,193 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:14:01,193 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:14:01,194 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-009.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'ozkmaOpQnsAyqkAwbBZxAg==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f97a9ba0f50>, 'auth_path': '/dicommetadata/1-009.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-009.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f97a8505050>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-009.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f97a9ba0f50>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-009.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:14:01,195 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:14:01,196 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a8504f90>>
2024-07-12 16:14:01,197 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f979264bb50>>
2024-07-12 16:14:01,198 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:14:01,199 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:14:01,200 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9792986650>>
2024-07-12 16:14:01,201 DEBUG Calculating signature using v4 auth.
2024-07-12 16:14:01,202 DEBUG CanonicalRequest:
PUT
/1-009.dcm

content-md5:ozkmaOpQnsAyqkAwbBZxAg==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161401Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:14:01,203 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161401Z
20240712/us-east-1/s3/aws4_request
4169b89479dc0bd14f34e28c6e30ff342b6fc617863ec0e93e9a31ad24a1c7c9
2024-07-12 16:14:01,204 DEBUG Signature:
f9aa518d615cfc5300fb0b69bc4fa4022f4b58d7faad1a90d493d5ac5856ac46
2024-07-12 16:14:01,205 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:14:01,206 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:14:01,207 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-009.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'ozkmaOpQnsAyqkAwbBZxAg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161401Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=f9aa518d615cfc5300fb0b69bc4fa4022f4b58d7faad1a90d493d5ac5856ac46', 'amz-sdk-invocation-id': b'c3d8e605-9299-4121-9636-a0454528040d', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:14:01,208 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:14:01,208 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:14:01,414 DEBUG Waiting for 100 Continue response.
2024-07-12 16:14:01,533 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:14:01,535 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:14:01,567 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-009.dcm HTTP/11" 400 None
2024-07-12 16:14:01,569 DEBUG Response headers: {'x-amz-request-id': 'QP50700VWKA8E8WD', 'x-amz-id-2': 'c88XvUDdh1eFjrkESeW3Pi5TrrUOfYrIB1ucbPnuJ5C+1pN7BcBwHm/7QsuPT+Wdv/37sDpECOs=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:14:02 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:14:01,571 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>QP50700VWKA8E8WD</RequestId><HostId>c88XvUDdh1eFjrkESeW3Pi5TrrUOfYrIB1ucbPnuJ5C+1pN7BcBwHm/7QsuPT+Wdv/37sDpECOs=</HostId></Error>'
2024-07-12 16:14:01,581 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97929872d0>
2024-07-12 16:14:01,582 DEBUG No retry needed.
2024-07-12 16:14:01,583 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9792b5b990>>
2024-07-12 16:14:01,584 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:14:01,585 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:14:01,587 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9792b5b990>>
2024-07-12 16:14:01,589 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-009.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:14:01,591 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:14:01,593 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-009.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-009.dcm
2024-07-12 16:14:01,595 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:14:01,596 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:14:01,600 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:14:01,602 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f97a9ba0f50>
2024-07-12 16:14:01,602 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:14:01,603 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97a8504f90>>
2024-07-12 16:14:01,604 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f979264bb50>>
2024-07-12 16:14:01,604 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:14:01,605 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:14:01,606 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f9792986650>>
2024-07-12 16:14:01,607 DEBUG Calculating signature using v4 auth.
2024-07-12 16:14:01,607 DEBUG CanonicalRequest:
PUT
/1-009.dcm

content-md5:ozkmaOpQnsAyqkAwbBZxAg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161401Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:14:01,608 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161401Z
20240712/eu-north-1/s3/aws4_request
3c37478a3b0ed09e83085e03e8cf4e4311ee6a77c7b412992d13a1d03ae00a85
2024-07-12 16:14:01,609 DEBUG Signature:
b625a3db559da3f8c91d854fb4e80ef930e336da47866fd41f6489e0659bbb62
2024-07-12 16:14:01,609 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:14:01,610 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:14:01,611 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-009.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'ozkmaOpQnsAyqkAwbBZxAg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161401Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=b625a3db559da3f8c91d854fb4e80ef930e336da47866fd41f6489e0659bbb62', 'amz-sdk-invocation-id': b'c3d8e605-9299-4121-9636-a0454528040d', 'amz-sdk-request': b'ttl=20240712T161502Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:14:01,612 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:14:01,613 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:14:01,806 DEBUG Waiting for 100 Continue response.
2024-07-12 16:14:01,924 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:14:02,564 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-009.dcm HTTP/11" 200 0
2024-07-12 16:14:02,565 DEBUG Response headers: {'x-amz-id-2': 'ji7usjEql2KyAdRM0HM7kHl3RV9/zjpBfS4+ett1NYLSe8IATkLCefw3a0XEtrD02LwMtxy4nCuSpeRA1YGTkmwM0212TTGB', 'x-amz-request-id': 'K33TKS4VV40K4K7R', 'Date': 'Fri, 12 Jul 2024 16:14:05 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"a3392668ea509ec032aa40306c167102"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:14:02,566 DEBUG Response body:
b''
2024-07-12 16:14:02,567 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97929872d0>
2024-07-12 16:14:02,568 DEBUG No retry needed.
2024-07-12 16:14:02,568 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f9792b5b990>>
2024-07-12 16:14:02,569 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:14:02,571 DEBUG Releasing acquire 0/None
2024-07-12 16:14:02,572 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x15\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:14:02,573 INFO Created new item on mongodb 
2024-07-12 16:14:02,573 INFO {'_id': ObjectId('66915648a7ee35ee91810d96'), 'FileName': '1-010.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '66915648a7ee35ee91810d96'}
2024-07-12 16:14:02,634 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:14:02,646 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:14:02,657 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:14:02,661 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:14:02,667 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:14:02,670 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:14:02,671 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:14:02,684 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:14:02,685 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:14:02,686 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:14:02,687 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:14:02,722 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:14:02,726 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:14:02,759 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:14:02,760 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:14:02,781 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:14:02,808 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:14:02,814 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:14:02,816 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:14:02,817 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f979295d760>
2024-07-12 16:14:02,818 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:14:02,819 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:14:02,820 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:14:02,820 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:14:02,821 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:14:02,821 DEBUG No configured endpoint found.
2024-07-12 16:14:02,823 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:14:02,827 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:14:02,828 DEBUG Registering retry handlers for service: s3
2024-07-12 16:14:02,828 DEBUG Registering S3 region redirector handler
2024-07-12 16:14:02,830 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:14:02,831 DEBUG Loading s3:s3
2024-07-12 16:14:02,834 DEBUG Loading s3:Bucket
2024-07-12 16:14:02,835 DEBUG Renaming Bucket attribute name
2024-07-12 16:14:02,837 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ba4b80>
2024-07-12 16:14:02,837 DEBUG Loading s3:Bucket
2024-07-12 16:14:02,838 DEBUG Renaming Bucket attribute name
2024-07-12 16:14:02,843 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97a9ba4b80>
2024-07-12 16:14:02,844 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:14:02,844 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:14:02,845 DEBUG Acquiring 0
2024-07-12 16:14:02,846 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977ff11450>}) about to wait for the following futures []
2024-07-12 16:14:02,846 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977ff11450>}) done waiting for dependent futures
2024-07-12 16:14:02,847 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977ff11450>}) with kwargs {'client': <botocore.client.S3 object at 0x7f979226a750>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f977ff31610>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97b02a7e50>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f977ff10a10>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f977ff11450>}
2024-07-12 16:14:02,849 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f977ff10a10> for transfer request: 0.
2024-07-12 16:14:02,850 DEBUG Acquiring 0
2024-07-12 16:14:02,850 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:14:02,851 DEBUG Releasing acquire 0/None
2024-07-12 16:14:02,851 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:14:02,853 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f979226a750>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f977ff11c50>, 'bucket': 'dicommetadata', 'key': '1-010.dcm', 'extra_args': {}}
2024-07-12 16:14:02,855 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:14:02,856 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:14:02,856 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:14:02,857 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:14:02,858 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:14:02,858 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977ff60e50>>
2024-07-12 16:14:02,859 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f977fc7b8d0>>
2024-07-12 16:14:02,860 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:14:02,861 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:14:02,862 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977ff60e50>>
2024-07-12 16:14:02,863 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-010.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:14:02,865 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:14:02,865 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:14:02,866 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:14:02,867 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:14:02,873 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:14:02,874 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:14:02,875 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977ff5bc50>>
2024-07-12 16:14:02,875 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:14:02,876 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:14:02,877 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-010.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': '2X/pgH0QhtLFtH3wDjIuVA==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f977ff11c50>, 'auth_path': '/dicommetadata/1-010.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-010.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f977ff60dd0>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-010.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f977ff11c50>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-010.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:14:02,879 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:14:02,879 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977ff60d90>>
2024-07-12 16:14:02,880 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977fc7b8d0>>
2024-07-12 16:14:02,881 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:14:02,882 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:14:02,883 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977ff5bc50>>
2024-07-12 16:14:02,884 DEBUG Calculating signature using v4 auth.
2024-07-12 16:14:02,885 DEBUG CanonicalRequest:
PUT
/1-010.dcm

content-md5:2X/pgH0QhtLFtH3wDjIuVA==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161402Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:14:02,886 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161402Z
20240712/us-east-1/s3/aws4_request
2e8c519906bff4d6025095083b5fdc6951b07e7bcfeb0b2f9ec5d6bee9033de2
2024-07-12 16:14:02,886 DEBUG Signature:
080b3838267525569655fca4abd61ccf147a497a8b02e8915c60ed81070e2819
2024-07-12 16:14:02,887 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:14:02,888 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:14:02,888 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-010.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'2X/pgH0QhtLFtH3wDjIuVA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161402Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=080b3838267525569655fca4abd61ccf147a497a8b02e8915c60ed81070e2819', 'amz-sdk-invocation-id': b'1086f793-4f84-445c-919f-6a57e0aa13ff', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:14:02,890 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:14:02,890 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:14:03,226 DEBUG Waiting for 100 Continue response.
2024-07-12 16:14:03,339 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:14:03,340 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:14:03,350 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-010.dcm HTTP/11" 400 None
2024-07-12 16:14:03,350 DEBUG Response headers: {'x-amz-request-id': 'RSMMSDQK1X6CJ029', 'x-amz-id-2': 'y6Z9RfvNkwU8CmcFNhhnLsl6BnoggnZDNFUT9+WWxu/xxUTWSDamAx3KoILx0+aXsrSayxJ0gVW7qgeJYK+n1Q==', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:14:05 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:14:03,351 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>RSMMSDQK1X6CJ029</RequestId><HostId>y6Z9RfvNkwU8CmcFNhhnLsl6BnoggnZDNFUT9+WWxu/xxUTWSDamAx3KoILx0+aXsrSayxJ0gVW7qgeJYK+n1Q==</HostId></Error>'
2024-07-12 16:14:03,355 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977ff5b9d0>
2024-07-12 16:14:03,355 DEBUG No retry needed.
2024-07-12 16:14:03,356 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977ff60e50>>
2024-07-12 16:14:03,357 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:14:03,357 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:14:03,358 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977ff60e50>>
2024-07-12 16:14:03,359 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-010.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:14:03,360 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:14:03,361 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-010.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-010.dcm
2024-07-12 16:14:03,361 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:14:03,362 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:14:03,363 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:14:03,364 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f977ff11c50>
2024-07-12 16:14:03,364 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:14:03,365 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f977ff60d90>>
2024-07-12 16:14:03,365 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977fc7b8d0>>
2024-07-12 16:14:03,366 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:14:03,366 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:14:03,367 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f977ff5bc50>>
2024-07-12 16:14:03,367 DEBUG Calculating signature using v4 auth.
2024-07-12 16:14:03,368 DEBUG CanonicalRequest:
PUT
/1-010.dcm

content-md5:2X/pgH0QhtLFtH3wDjIuVA==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161403Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:14:03,368 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161403Z
20240712/eu-north-1/s3/aws4_request
fbd39baa06c31e5094d2a845759df1b797589a8a7cf1e151bcc679599ee29d56
2024-07-12 16:14:03,369 DEBUG Signature:
872609d042250e87ebf4718d6bdd3cbe5257f22ead04991d95292375964ac93e
2024-07-12 16:14:03,371 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:14:03,372 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:14:03,373 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-010.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'2X/pgH0QhtLFtH3wDjIuVA==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161403Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=872609d042250e87ebf4718d6bdd3cbe5257f22ead04991d95292375964ac93e', 'amz-sdk-invocation-id': b'1086f793-4f84-445c-919f-6a57e0aa13ff', 'amz-sdk-request': b'ttl=20240712T161505Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:14:03,374 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:14:03,375 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:14:03,632 DEBUG Waiting for 100 Continue response.
2024-07-12 16:14:03,774 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:14:04,393 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-010.dcm HTTP/11" 200 0
2024-07-12 16:14:04,394 DEBUG Response headers: {'x-amz-id-2': 'Ff4ivf25Y/WuFGKKAGlSjXqj4aDfIOd9p1GWZRDPT4JLcFUdmtlZADjl3Ogv7kbfGIIQSBfxZL8=', 'x-amz-request-id': 'WDDPHMRSJGFPQPP3', 'Date': 'Fri, 12 Jul 2024 16:14:07 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"d97fe9807d1086d2c5b47df00e322e54"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:14:04,395 DEBUG Response body:
b''
2024-07-12 16:14:04,396 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f977ff5b9d0>
2024-07-12 16:14:04,396 DEBUG No retry needed.
2024-07-12 16:14:04,397 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f977ff60e50>>
2024-07-12 16:14:04,398 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:14:04,400 DEBUG Releasing acquire 0/None
2024-07-12 16:14:04,401 INFO Created new item on mongodb 
2024-07-12 16:14:04,401 INFO {'_id': ObjectId('66915648a7ee35ee91810d97'), 'FileName': '1-011.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '66915648a7ee35ee91810d97'}
2024-07-12 16:14:04,428 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:14:04,433 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:14:04,436 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:14:04,439 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:14:04,440 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:14:04,442 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:14:04,444 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:14:04,450 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:14:04,451 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:14:04,452 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:14:04,453 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:14:04,469 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:14:04,471 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:14:04,495 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:14:04,495 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:14:04,514 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:14:04,540 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:14:04,688 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:14:04,690 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:14:04,691 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f979295dee0>
2024-07-12 16:14:04,691 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:14:04,692 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:14:04,692 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:14:04,693 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:14:04,693 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:14:04,694 DEBUG No configured endpoint found.
2024-07-12 16:14:04,696 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:14:04,699 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:14:04,700 DEBUG Registering retry handlers for service: s3
2024-07-12 16:14:04,702 DEBUG Registering S3 region redirector handler
2024-07-12 16:14:04,703 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:14:04,704 DEBUG Loading s3:s3
2024-07-12 16:14:04,706 DEBUG Loading s3:Bucket
2024-07-12 16:14:04,706 DEBUG Renaming Bucket attribute name
2024-07-12 16:14:04,708 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f977ff2ad40>
2024-07-12 16:14:04,709 DEBUG Loading s3:Bucket
2024-07-12 16:14:04,709 DEBUG Renaming Bucket attribute name
2024-07-12 16:14:04,711 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f977ff2ad40>
2024-07-12 16:14:04,712 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:14:04,713 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:14:04,714 DEBUG Acquiring 0
2024-07-12 16:14:04,716 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792423e90>}) about to wait for the following futures []
2024-07-12 16:14:04,716 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792423e90>}) done waiting for dependent futures
2024-07-12 16:14:04,717 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792423e90>}) with kwargs {'client': <botocore.client.S3 object at 0x7f979281cc10>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f9792861210>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f9792861310>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f9792860f90>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f9792423e90>}
2024-07-12 16:14:04,721 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f9792860f90> for transfer request: 0.
2024-07-12 16:14:04,721 DEBUG Acquiring 0
2024-07-12 16:14:04,722 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:14:04,723 DEBUG Releasing acquire 0/None
2024-07-12 16:14:04,723 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:14:04,724 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f979281cc10>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f9792423490>, 'bucket': 'dicommetadata', 'key': '1-011.dcm', 'extra_args': {}}
2024-07-12 16:14:04,726 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:14:04,726 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:14:04,727 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:14:04,727 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:14:04,727 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:14:04,728 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979284de10>>
2024-07-12 16:14:04,728 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f977f9361d0>>
2024-07-12 16:14:04,729 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:14:04,730 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:14:04,731 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979284de10>>
2024-07-12 16:14:04,732 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-011.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:14:04,733 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:14:04,734 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:14:04,734 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:14:04,735 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:14:04,742 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:14:04,742 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:14:04,742 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97928a0290>>
2024-07-12 16:14:04,743 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:14:04,744 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:14:04,745 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-011.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'rSPcs5o0Fh6lGaQa6nZ7fg==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f9792423490>, 'auth_path': '/dicommetadata/1-011.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-011.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f9792434610>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-011.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f9792423490>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-011.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:14:04,747 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:14:04,747 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9792434550>>
2024-07-12 16:14:04,748 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977f9361d0>>
2024-07-12 16:14:04,749 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:14:04,750 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:14:04,750 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97928a0290>>
2024-07-12 16:14:04,751 DEBUG Calculating signature using v4 auth.
2024-07-12 16:14:04,752 DEBUG CanonicalRequest:
PUT
/1-011.dcm

content-md5:rSPcs5o0Fh6lGaQa6nZ7fg==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161404Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:14:04,752 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161404Z
20240712/us-east-1/s3/aws4_request
275c4fd2de7b0dce1c9b2e75cf00b583cb517a3ddb82b2181d490b4d3328d733
2024-07-12 16:14:04,753 DEBUG Signature:
53064f4f4e358617f46a49a9461e3fb5ca17397b001e44a7c411d1a0325dfca9
2024-07-12 16:14:04,753 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:14:04,754 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:14:04,755 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-011.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'rSPcs5o0Fh6lGaQa6nZ7fg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161404Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=53064f4f4e358617f46a49a9461e3fb5ca17397b001e44a7c411d1a0325dfca9', 'amz-sdk-invocation-id': b'01aedf62-e866-43e4-8205-3b7fff4924f8', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:14:04,756 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:14:04,756 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:14:04,949 DEBUG Waiting for 100 Continue response.
2024-07-12 16:14:05,067 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:14:05,068 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:14:05,077 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-011.dcm HTTP/11" 400 None
2024-07-12 16:14:05,078 DEBUG Response headers: {'x-amz-request-id': 'N32H3RMEXENDAXNH', 'x-amz-id-2': 'DkTXXHaBmQvBNUnfEfhM3kgCjEfnkXTsOZfvhAHN8JShs5kHz1u9m5VXX6lYtYYDscmNScHiKKVgqCLd/ci/gw==', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:14:07 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:14:05,079 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>N32H3RMEXENDAXNH</RequestId><HostId>DkTXXHaBmQvBNUnfEfhM3kgCjEfnkXTsOZfvhAHN8JShs5kHz1u9m5VXX6lYtYYDscmNScHiKKVgqCLd/ci/gw==</HostId></Error>'
2024-07-12 16:12:56,608 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97928a2610>
2024-07-12 16:12:56,609 DEBUG No retry needed.
2024-07-12 16:12:56,609 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979284de10>>
2024-07-12 16:12:56,610 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:12:56,611 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:12:56,612 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979284de10>>
2024-07-12 16:12:56,612 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-011.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:12:56,614 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:12:56,615 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-011.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-011.dcm
2024-07-12 16:12:56,615 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:12:56,616 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:12:56,617 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:12:56,618 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f9792423490>
2024-07-12 16:12:56,618 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:12:56,625 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f9792434550>>
2024-07-12 16:12:56,627 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f977f9361d0>>
2024-07-12 16:12:56,629 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:12:56,630 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:12:56,631 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97928a0290>>
2024-07-12 16:12:56,633 DEBUG Calculating signature using v4 auth.
2024-07-12 16:12:56,633 DEBUG CanonicalRequest:
PUT
/1-011.dcm

content-md5:rSPcs5o0Fh6lGaQa6nZ7fg==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161256Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:12:56,634 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161256Z
20240712/eu-north-1/s3/aws4_request
0a92e00473c55fede1e4b47963da47f3efea7766ff360b4e29efbd7b1120aa42
2024-07-12 16:12:56,635 DEBUG Signature:
60097236af20e19442b63e88fec238ed4c62f8f9c6c53421ffce0e3bd9bc9885
2024-07-12 16:12:56,636 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:12:56,637 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:12:56,637 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-011.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'rSPcs5o0Fh6lGaQa6nZ7fg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161256Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=60097236af20e19442b63e88fec238ed4c62f8f9c6c53421ffce0e3bd9bc9885', 'amz-sdk-invocation-id': b'01aedf62-e866-43e4-8205-3b7fff4924f8', 'amz-sdk-request': b'ttl=20240712T161507Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:12:56,639 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:12:56,639 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:14:08,037 DEBUG Waiting for 100 Continue response.
2024-07-12 16:14:08,186 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:14:08,883 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-011.dcm HTTP/11" 200 0
2024-07-12 16:14:08,884 DEBUG Response headers: {'x-amz-id-2': 'qYuCA545PUL+NxBcel/Y/FQVhmRqExBQYuo0TEiQ1OTU409Em8Z5Q5mDuBvooZ6RnBL8GSqIVFQ=', 'x-amz-request-id': 'ET31R9FNV5PQ9ABE', 'Date': 'Fri, 12 Jul 2024 16:14:09 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"ad23dcb39a34161ea519a41aea767b7e"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:14:08,885 DEBUG Response body:
b''
2024-07-12 16:14:08,886 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97928a2610>
2024-07-12 16:14:08,886 DEBUG No retry needed.
2024-07-12 16:14:08,887 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f979284de10>>
2024-07-12 16:14:08,888 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:14:08,890 DEBUG Releasing acquire 0/None
2024-07-12 16:14:08,890 INFO Created new item on mongodb 
2024-07-12 16:14:08,891 INFO {'_id': ObjectId('66915648a7ee35ee91810d98'), 'FileName': '1-012.dcm', 'PatientName': 'TCGA-CS-5396', 'PatientID': 'TCGA-CS-5396', 'StudyDate': '20010302', 'StudyDescription': 'MRI BRAIN CONTRAST MRA BRAIN', 'StudySeriesUID': '1.3.6.1.4.1.14519.5.2.1.1188.4001.913510847891003552926172580049', 'StudyID': '', 'PatientBirthDate': '', 'id': '66915648a7ee35ee91810d98'}
2024-07-12 16:14:08,918 DEBUG Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2024-07-12 16:14:08,923 DEBUG Changing event name from before-call.apigateway to before-call.api-gateway
2024-07-12 16:14:08,926 DEBUG Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2024-07-12 16:14:08,930 DEBUG Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2024-07-12 16:14:08,930 DEBUG Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2024-07-12 16:14:08,933 DEBUG Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2024-07-12 16:14:08,935 DEBUG Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2024-07-12 16:14:08,946 DEBUG Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2024-07-12 16:14:08,947 DEBUG Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2024-07-12 16:14:08,948 DEBUG Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2024-07-12 16:14:08,949 DEBUG Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2024-07-12 16:14:08,972 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/boto3/data/s3/2006-03-01/resources-1.json
2024-07-12 16:14:08,975 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/endpoints.json
2024-07-12 16:14:09,008 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/sdk-default-configuration.json
2024-07-12 16:14:09,008 DEBUG Event choose-service-name: calling handler <function handle_service_name_alias at 0x7f97b123b920>
2024-07-12 16:14:09,035 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/service-2.json.gz
2024-07-12 16:14:09,073 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2024-07-12 16:14:09,082 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/partitions.json
2024-07-12 16:14:09,086 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x7f97b11c1440>
2024-07-12 16:14:09,087 DEBUG Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x7f97926e1300>
2024-07-12 16:14:09,088 DEBUG Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x7f97b11c11c0>
2024-07-12 16:14:09,091 DEBUG Looking for endpoint for s3 via: environment_service
2024-07-12 16:14:09,092 DEBUG Looking for endpoint for s3 via: environment_global
2024-07-12 16:14:09,092 DEBUG Looking for endpoint for s3 via: config_service
2024-07-12 16:14:09,094 DEBUG Looking for endpoint for s3 via: config_global
2024-07-12 16:14:09,095 DEBUG No configured endpoint found.
2024-07-12 16:14:09,103 DEBUG Setting s3 timeout as (60, 60)
2024-07-12 16:14:09,108 DEBUG Loading JSON file: /usr/local/lib/python3.11/site-packages/botocore/data/_retry.json
2024-07-12 16:14:09,110 DEBUG Registering retry handlers for service: s3
2024-07-12 16:14:09,111 DEBUG Registering S3 region redirector handler
2024-07-12 16:14:09,113 DEBUG Registering S3Express Identity Resolver
2024-07-12 16:14:09,117 DEBUG Loading s3:s3
2024-07-12 16:14:09,120 DEBUG Loading s3:Bucket
2024-07-12 16:14:09,121 DEBUG Renaming Bucket attribute name
2024-07-12 16:14:09,124 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97926e14e0>
2024-07-12 16:14:09,125 DEBUG Loading s3:Bucket
2024-07-12 16:14:09,126 DEBUG Renaming Bucket attribute name
2024-07-12 16:14:09,129 DEBUG Event creating-resource-class.s3.Bucket: calling handler <function lazy_call.<locals>._handler at 0x7f97926e14e0>
2024-07-12 16:14:09,130 DEBUG Opting out of CRT Transfer Manager. Preferred client: auto, CRT available: False, Instance Optimized: False.
2024-07-12 16:14:09,131 DEBUG Using default client. pid: 1, thread: 140289535117120
2024-07-12 16:14:09,133 DEBUG Acquiring 0
2024-07-12 16:14:09,134 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9f0a910>}) about to wait for the following futures []
2024-07-12 16:14:09,134 DEBUG UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9f0a910>}) done waiting for dependent futures
2024-07-12 16:14:09,135 DEBUG Executing task UploadSubmissionTask(transfer_id=0, {'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9f0a910>}) with kwargs {'client': <botocore.client.S3 object at 0x7f977fec6910>, 'config': <boto3.s3.transfer.TransferConfig object at 0x7f97b0b0dc90>, 'osutil': <s3transfer.utils.OSUtils object at 0x7f97a9f09490>, 'request_executor': <s3transfer.futures.BoundedExecutor object at 0x7f97a9f095d0>, 'transfer_future': <s3transfer.futures.TransferFuture object at 0x7f97a9f0a910>}
2024-07-12 16:14:09,140 DEBUG Submitting task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) to executor <s3transfer.futures.BoundedExecutor object at 0x7f97a9f095d0> for transfer request: 0.
2024-07-12 16:14:09,140 DEBUG Acquiring 0
2024-07-12 16:14:09,141 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) about to wait for the following futures []
2024-07-12 16:14:09,142 DEBUG Releasing acquire 0/None
2024-07-12 16:14:09,142 DEBUG PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) done waiting for dependent futures
2024-07-12 16:14:09,143 DEBUG Executing task PutObjectTask(transfer_id=0, {'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}) with kwargs {'client': <botocore.client.S3 object at 0x7f977fec6910>, 'fileobj': <s3transfer.utils.ReadFileChunk object at 0x7f97a9f09650>, 'bucket': 'dicommetadata', 'key': '1-012.dcm', 'extra_args': {}}
2024-07-12 16:14:09,145 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x7f97b1223100>
2024-07-12 16:14:09,146 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x7f97b12223e0>
2024-07-12 16:14:09,147 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x7f97b1223b00>
2024-07-12 16:14:09,148 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x7f97b1222340>
2024-07-12 16:14:09,148 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x7f97b1094540>
2024-07-12 16:14:09,149 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9f41690>>
2024-07-12 16:14:09,150 DEBUG Event before-parameter-build.s3.PutObject: calling handler <bound method ClientCreator._inject_s3_input_parameters of <botocore.client.ClientCreator object at 0x7f97a9dfed90>>
2024-07-12 16:14:09,150 DEBUG Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x7f97b1222160>
2024-07-12 16:14:09,151 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:14:09,152 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9f41690>>
2024-07-12 16:14:09,153 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-012.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:14:09,155 DEBUG Endpoint provider result: https://dicommetadata.s3.amazonaws.com
2024-07-12 16:14:09,157 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:14:09,159 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:14:09,161 DEBUG Event before-call.s3.PutObject: calling handler <function conditionally_calculate_checksum at 0x7f97b1375a80>
2024-07-12 16:14:09,172 DEBUG Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x7f97b1222700>
2024-07-12 16:14:09,172 DEBUG Adding expect 100 continue header to request.
2024-07-12 16:14:09,173 DEBUG Event before-call.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.apply_signing_cache_key of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97b002bcd0>>
2024-07-12 16:14:09,173 DEBUG Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x7f97b12209a0>
2024-07-12 16:14:09,174 DEBUG Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x7f97b1223c40>
2024-07-12 16:14:09,176 DEBUG Making request for OperationModel(name=PutObject) with params: {'url_path': '/1-012.dcm', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': 'S/JxD+DpIC7Rn6osNbJu5A==', 'Expect': '100-continue'}, 'body': <s3transfer.utils.ReadFileChunk object at 0x7f97a9f09650>, 'auth_path': '/dicommetadata/1-012.dcm', 'url': 'https://dicommetadata.s3.amazonaws.com/1-012.dcm', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x7f97b0017b90>, 'has_streaming_input': True, 'auth_type': 'v4', 's3_redirect': {'redirected': False, 'bucket': 'dicommetadata', 'params': {'Bucket': 'dicommetadata', 'Key': '1-012.dcm', 'Body': <s3transfer.utils.ReadFileChunk object at 0x7f97a9f09650>}}, 'input_params': {'Bucket': 'dicommetadata', 'Key': '1-012.dcm'}, 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 'endpoint_properties': {'authSchemes': [{'disableDoubleEncoding': True, 'name': 'sigv4', 'signingName': 's3', 'signingRegion': 'us-east-1'}]}}}
2024-07-12 16:14:09,177 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:14:09,178 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97b0017bd0>>
2024-07-12 16:14:09,179 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a9dfed90>>
2024-07-12 16:14:09,180 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:14:09,181 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:14:09,182 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97b002bcd0>>
2024-07-12 16:14:09,187 DEBUG Calculating signature using v4 auth.
2024-07-12 16:14:09,187 DEBUG CanonicalRequest:
PUT
/1-012.dcm

content-md5:S/JxD+DpIC7Rn6osNbJu5A==
host:dicommetadata.s3.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161409Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:14:09,188 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161409Z
20240712/us-east-1/s3/aws4_request
fcb4283d63754a4a3055169276722459c8365d5ae01e6246971f919a19318adc
2024-07-12 16:14:09,188 DEBUG Signature:
ba8d85e78ff3304d3ebb14fb368a4fc6b4c498fa3579b857c9d4905361272a9c
2024-07-12 16:14:09,190 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:14:09,190 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:14:09,192 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.amazonaws.com/1-012.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'S/JxD+DpIC7Rn6osNbJu5A==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161409Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=ba8d85e78ff3304d3ebb14fb368a4fc6b4c498fa3579b857c9d4905361272a9c', 'amz-sdk-invocation-id': b'4ad2a23f-dbba-4c73-98c3-ce1ebbd361d2', 'amz-sdk-request': b'attempt=1', 'Content-Length': '527952'}>
2024-07-12 16:14:09,193 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:14:09,197 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.amazonaws.com:443
2024-07-12 16:14:09,415 DEBUG Waiting for 100 Continue response.
2024-07-12 16:14:09,553 DEBUG Received a non 100 Continue response from the server, NOT sending request body.
2024-07-12 16:14:09,554 DEBUG send() called, but response already received. Not sending data.
2024-07-12 16:14:09,564 DEBUG https://dicommetadata.s3.amazonaws.com:443 "PUT /1-012.dcm HTTP/11" 400 None
2024-07-12 16:14:09,564 DEBUG Response headers: {'x-amz-request-id': '9DRMD5W8GVZ77D3P', 'x-amz-id-2': '4vJJysm4VTTz1ey7oZhbRV+vaMdKYuiaw9Z6v8YFd2jKgJqwmRtmjv+pFNPf047PU95vFqgh6v9C7Irkoo+0mw==', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Fri, 12 Jul 2024 16:14:09 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2024-07-12 16:14:09,565 DEBUG Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the region \'us-east-1\' is wrong; expecting \'eu-north-1\'</Message><Region>eu-north-1</Region><RequestId>9DRMD5W8GVZ77D3P</RequestId><HostId>4vJJysm4VTTz1ey7oZhbRV+vaMdKYuiaw9Z6v8YFd2jKgJqwmRtmjv+pFNPf047PU95vFqgh6v9C7Irkoo+0mw==</HostId></Error>'
2024-07-12 16:14:09,570 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97b002bed0>
2024-07-12 16:14:09,571 DEBUG No retry needed.
2024-07-12 16:14:09,572 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9f41690>>
2024-07-12 16:14:09,574 DEBUG S3 client configured for region us-east-1 but the bucket dicommetadata is in region eu-north-1; Please configure the proper region to avoid multiple unnecessary redirects and signing attempts.
2024-07-12 16:14:09,576 DEBUG Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x7f97b1094720>
2024-07-12 16:14:09,576 DEBUG Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9f41690>>
2024-07-12 16:14:09,577 DEBUG Calling endpoint provider with parameters: {'Bucket': 'dicommetadata', 'Region': 'eu-north-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'Key': '1-012.dcm', 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2024-07-12 16:14:09,579 DEBUG Endpoint provider result: https://dicommetadata.s3.eu-north-1.amazonaws.com
2024-07-12 16:14:09,579 DEBUG Updating URI from https://dicommetadata.s3.amazonaws.com/1-012.dcm to https://dicommetadata.s3.eu-north-1.amazonaws.com/1-012.dcm
2024-07-12 16:14:09,580 DEBUG Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2024-07-12 16:14:09,581 DEBUG Selected auth type "v4" as "v4" with signing context params: {'region': 'eu-north-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2024-07-12 16:14:09,582 DEBUG Response received to retry, sleeping for 0 seconds
2024-07-12 16:14:09,583 DEBUG Rewinding stream: <s3transfer.utils.ReadFileChunk object at 0x7f97a9f09650>
2024-07-12 16:14:09,583 DEBUG Event request-created.s3.PutObject: calling handler <function signal_not_transferring at 0x7f97a9acc9a0>
2024-07-12 16:14:09,584 DEBUG Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x7f97b0017bd0>>
2024-07-12 16:14:09,585 DEBUG Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x7f97a9dfed90>>
2024-07-12 16:14:09,585 DEBUG Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x7f97b1222020>
2024-07-12 16:14:09,586 DEBUG Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x7f97b1094680>
2024-07-12 16:14:09,587 DEBUG Event before-sign.s3.PutObject: calling handler <bound method S3ExpressIdentityResolver.resolve_s3express_identity of <botocore.utils.S3ExpressIdentityResolver object at 0x7f97b002bcd0>>
2024-07-12 16:14:09,588 DEBUG Calculating signature using v4 auth.
2024-07-12 16:14:09,590 DEBUG CanonicalRequest:
PUT
/1-012.dcm

content-md5:S/JxD+DpIC7Rn6osNbJu5A==
host:dicommetadata.s3.eu-north-1.amazonaws.com
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20240712T161409Z

content-md5;host;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2024-07-12 16:14:09,591 DEBUG StringToSign:
AWS4-HMAC-SHA256
20240712T161409Z
20240712/eu-north-1/s3/aws4_request
f05618ed6371e83e60dacf916f1b8bff3b0d34675bd85e248c3ab4c9b74271f2
2024-07-12 16:14:09,593 DEBUG Signature:
d1b502b6e31140b537d8b1d9965cd426ff47a82ea92cddba20149abfb84b5d1c
2024-07-12 16:14:09,594 DEBUG Event request-created.s3.PutObject: calling handler <function signal_transferring at 0x7f97a9acca40>
2024-07-12 16:14:09,596 DEBUG Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x7f97b10944a0>
2024-07-12 16:14:09,598 DEBUG Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://dicommetadata.s3.eu-north-1.amazonaws.com/1-012.dcm, headers={'User-Agent': b'Boto3/1.34.143 md/Botocore#1.34.143 ua/2.0 os/linux#5.15.153.1-microsoft-standard-WSL2 md/arch#x86_64 lang/python#3.11.2 md/pyimpl#CPython cfg/retry-mode#legacy Botocore/1.34.143 Resource', 'Content-MD5': b'S/JxD+DpIC7Rn6osNbJu5A==', 'Expect': b'100-continue', 'X-Amz-Date': b'20240712T161409Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIA2UC3C3NL4BGVTXHH/20240712/eu-north-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-content-sha256;x-amz-date, Signature=d1b502b6e31140b537d8b1d9965cd426ff47a82ea92cddba20149abfb84b5d1c', 'amz-sdk-invocation-id': b'4ad2a23f-dbba-4c73-98c3-ce1ebbd361d2', 'amz-sdk-request': b'ttl=20240712T161509Z; attempt=2; max=5', 'Content-Length': '527952'}>
2024-07-12 16:14:09,599 DEBUG Certificate path: /usr/local/lib/python3.11/site-packages/certifi/cacert.pem
2024-07-12 16:14:09,601 DEBUG Starting new HTTPS connection (1): dicommetadata.s3.eu-north-1.amazonaws.com:443
2024-07-12 16:14:09,796 DEBUG Waiting for 100 Continue response.
2024-07-12 16:14:09,929 DEBUG 100 Continue response seen, now sending request body.
2024-07-12 16:14:10,807 DEBUG https://dicommetadata.s3.eu-north-1.amazonaws.com:443 "PUT /1-012.dcm HTTP/11" 200 0
2024-07-12 16:14:10,808 DEBUG Response headers: {'x-amz-id-2': 'CC7GUlWiBz8za9Gs9xHUFkTEMfx3hGRRHMWlj61y0Fd7UeywQUmzTeic/L9G24a6pl4KrO3AQlM=', 'x-amz-request-id': '9DRW0ZYSJ2T4CBKZ', 'Date': 'Fri, 12 Jul 2024 16:14:10 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"4bf2710fe0e9202ed19faa2c35b26ee4"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2024-07-12 16:14:10,808 DEBUG Response body:
b''
2024-07-12 16:14:10,809 DEBUG Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x7f97b002bed0>
2024-07-12 16:14:10,810 DEBUG No retry needed.
2024-07-12 16:14:10,811 DEBUG Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x7f97a9f41690>>
2024-07-12 16:14:10,811 DEBUG S3 request was previously redirected, not redirecting.
2024-07-12 16:14:10,813 DEBUG Releasing acquire 0/None
2024-07-12 16:14:10,817 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x16\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:14:10,818 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x17\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:14:10,819 DEBUG Prepare to send ChannelFrame(payload=b'\x01\x00\x01\x00\x00\x00\r\x00<\x00P\x00\x00\x00\x00\x00\x00\x00\x18\x00\xce', should_close=False, drain_future=<Future pending cb=[FutureStore.__on_task_done.<locals>.remover() at /usr/local/lib/python3.11/site-packages/aiormq/base.py:33, <1 more>, Task.task_wakeup()]>)
2024-07-12 16:14:25,039 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:14:52,539 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f977f6002d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:14:56,089 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:15:23,112 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f977f6ea450> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:15:26,957 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:15:55,556 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f97a9b74550> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:15:59,677 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:16:28,006 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f977f6ea690> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:16:32,421 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:17:00,413 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f97a988c1d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:17:05,124 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:17:31,019 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f977f6002d0> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:17:36,026 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:16:50,331 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f977f6ea450> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:18:06,686 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:18:17,445 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:18:17,448 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 4, "reason": "Connection pool was stale", "error": "stale"}
2024-07-12 16:18:17,451 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 2, "reason": "Connection pool was stale", "error": "stale"}
2024-07-12 16:18:17,456 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 5, "reason": "Connection pool was stale", "error": "stale"}
2024-07-12 16:18:17,460 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 1, "reason": "Connection pool was stale", "error": "stale"}
2024-07-12 16:18:17,465 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection closed", "serverHost": "mongodb", "serverPort": 27017, "driverConnectionId": 3, "reason": "Connection pool was stale", "error": "stale"}
2024-07-12 16:18:17,477 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:18:31,388 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f97a9b74550> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:18:36,694 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:17:52,518 DEBUG Received frame <pamqp.heartbeat.Heartbeat object at 0x7f97927ee250> in channel #0 weight=8 on <Connection: "amqp://user:******@rabbit:5672/" at 0x7f97b0b099f0>
2024-07-12 16:19:09,185 DEBUG Prepare to send ChannelFrame(payload=b'\x08\x00\x00\x00\x00\x00\x00\xce', should_close=False, drain_future=None)
2024-07-12 16:19:19,999 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection pool cleared", "serverHost": "mongodb", "serverPort": 27017}
2024-07-12 16:19:20,002 DEBUG {"clientId": {"$oid": "6691555ea7ee35ee91810d80"}, "message": "Connection pool ready", "serverHost": "mongodb", "serverPort": 27017}
